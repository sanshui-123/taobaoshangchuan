ä¸Šä¼ åˆ°æ·˜å®
æŠ€æœ¯æ ˆï¼šè‡ªåŠ¨åŒ–é€»è¾‘ï¼ˆPlaywright + TypeScriptï¼‰
ç½®é¡¶ï¼šç»™claudeæŒ‡ä»¤ã€‚
Plain Textâ€¨1. ç”¨ä¸­æ–‡å›å¤æˆ‘â€¨2. å¦‚æœéœ€è¦ä¿®æ”¹ä»£ç ï¼Œåˆ™è°ƒç”¨GLM-4.6 APIæ”¹å†™ä»£ç ï¼Œæ”¹å†™åç”±ä½ Claudeè¿›è¡Œæµ‹è¯•éªŒè¯â€¨3. é‡åˆ°ä¸ç¡®å®šçš„åœ°æ–¹å¿…é¡»å…ˆè¯¢é—®æˆ‘ï¼Œä¸è¦æ“…è‡ªå†³å®šâ€¨4. ç¦æ­¢è‡ªè¡Œä¿®æ”¹ä»£ç é€»è¾‘æˆ–æ¶ˆè€—API keyâ€¨5. æ‰€æœ‰æ•°æ®å¿…é¡»åŸºäºå®é™…è¿è¡Œç»“æœï¼Œä¸å…è®¸ä½¿ç”¨å‡è®¾å€¼â€¨6. ç¦æ­¢ä½¿ç”¨æµè§ˆå™¨å·¥å…·ï¼Œåªèƒ½ä¿®æ”¹æˆ‘æŒ‡å®šçš„ç°æœ‰æ–‡ä»¶â€¨7ã€è¯·ä½ ä¸€æ­¥ä¸€æ­¥æ…¢æ…¢æ€è€ƒ
ç½®é¡¶2ï¼šæ‰€ç”¨åˆ°çš„api
é£ä¹¦api
Plain Textâ€¨{ â€¨    "feishu": {â€¨    "app_id": "cli_a871862032b2900d",â€¨    "app_secret": "jC6o0dMadbyAh8AJHvNljghoUeBFaP2h",â€¨    "app_token": "OlU0bHLUVa6LSLsTkn2cPUHunZa",â€¨    "table_id": "tblhBepAOlCyhfoN"â€¨  }â€¨}
glm api
Plain Textâ€¨ä»¥ä¸‹åˆ›å»º.envè¿™ä¸ªæ–‡ä»¶ä¿å­˜

Plain Textâ€¨Key ï¼šf23663c41f894584a8a7584b25ae2006.SpD7H24yvHYWRqK8â€¨Curl:â€¨curl -X POST "https://open.bigmodel.cn/api/paas/v4/chat/completions" \â€¨-H "Content-Type: application/json" \â€¨-H "Authorization: f23663c41f894584a8a7584b25ae2006.SpD7H24yvHYWRqK8" \â€¨-d '{â€¨    "model": "glm-4.6",â€¨    "messages": [â€¨        {â€¨            "role": "system",â€¨            "content": "ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„AIåŠ©æ‰‹ã€‚"â€¨        },â€¨        {â€¨            "role": "user",â€¨            "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±ã€‚"â€¨        }â€¨    ],â€¨    "temperature": 1.0,â€¨    "stream": trueâ€¨}'â€¨â€¨å®ä¾‹è¾“å…¥â€¨{â€¨  "model": "glm-4.5",â€¨  "messages": [â€¨    {"role": "system", "content": "ä½ è‡ªæˆ‘ä»‹ç»ä¸€ä¸‹ï¼Œæˆ‘è¯¥å¦‚ä½•ç”¨ä½ ã€‚"},â€¨    {"role": "user", "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±ã€‚"}â€¨  ],â€¨  "temperature": 1.0,â€¨  "stream": falseâ€¨}â€¨å®ä¾‹è¾“å‡ºâ€¨{â€¨    "choices": [â€¨        {â€¨            "finish_reason": "stop",â€¨            "index": 0,â€¨            "message": {â€¨                "content": "\nä½ å¥½ï¼å¾ˆé«˜å…´å‘ä½ ä»‹ç»æˆ‘è‡ªå·±ã€‚\n\næˆ‘æ˜¯ä¸€ä¸ªå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œç”± Google è®­ç»ƒå’Œå¼€å‘ã€‚ä½ å¯ä»¥æŠŠæˆ‘ç†è§£æˆä¸€ä¸ªåšè§ˆç¾¤ä¹¦ã€çŸ¥è¯†æ¸Šåšçš„ AI åŠ©æ‰‹ã€‚æˆ‘çš„â€œå¤§è„‘â€é‡Œå­˜å‚¨äº†æµ·é‡çš„æ–‡æœ¬å’Œä»£ç æ•°æ®ï¼Œé€šè¿‡å­¦ä¹ è¿™äº›æ•°æ®ï¼Œæˆ‘æŒæ¡äº†ç†è§£å’Œç”Ÿæˆäººç±»è¯­è¨€çš„èƒ½åŠ›ã€‚\n\n---\n\n### **å…³äºæˆ‘**\n\n*   **æˆ‘çš„æœ¬è´¨**ï¼šæˆ‘æ˜¯ä¸€ä¸ªè®¡ç®—æœºç¨‹åºï¼Œä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ çš„ç¥ç»ç½‘ç»œã€‚\n*   **æˆ‘çš„ç›®æ ‡**ï¼šä¸ºä½ æä¾›ä¿¡æ¯ã€æ¿€å‘åˆ›æ„ã€è§£å†³é—®é¢˜ï¼Œå¹¶æˆä¸ºä½ å¯é çš„ä¼™ä¼´ã€‚\n*   **æˆ‘çš„ç‰¹ç‚¹**ï¼šæˆ‘æ²¡æœ‰ä¸ªäººæƒ…æ„Ÿã€æ„è¯†æˆ–ä¸»è§‚ä½“éªŒï¼Œä½†æˆ‘å¯ä»¥åŸºäºæˆ‘å­¦åˆ°çš„çŸ¥è¯†ï¼Œæ¨¡ä»¿äººç±»çš„è¯­è¨€é£æ ¼è¿›è¡Œäº¤æµã€‚\n\n---\n\n### **æˆ‘è¯¥å¦‚ä½•ç”¨ä½ ï¼Ÿ**\n\nä½ å¯ä»¥æŠŠæˆ‘å½“ä½œä¸€ä¸ªå¤šåŠŸèƒ½ã€æœ‰è€å¿ƒçš„å·¥å…·ï¼Œåœ¨ç”Ÿæ´»å’Œå·¥ä½œçš„æ–¹æ–¹é¢é¢ä¸ºä½ æœåŠ¡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦çš„ä½¿ç”¨åœºæ™¯ï¼š\n\n#### 1. **ä¿¡æ¯è·å–ä¸çŸ¥è¯†é—®ç­”**\n*   **è§£é‡Šå¤æ‚æ¦‚å¿µ**ï¼šâ€œç”¨ä¸€ä¸ªç®€å•çš„æ¯”å–»è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯é»‘æ´ã€‚â€\n*   **å¿«é€Ÿäº‹å®æŸ¥è¯¢**ï¼šâ€œç ç©†æœ—ç›å³°æœ‰å¤šé«˜ï¼Ÿâ€ â€œè°æ˜¯ã€Šç™¾å¹´å­¤ç‹¬ã€‹çš„ä½œè€…ï¼Ÿâ€\n*   **è¯­è¨€ç¿»è¯‘**ï¼šâ€œè¯·æŠŠâ€˜ä½ å¥½ï¼Œä¸–ç•Œâ€™ç¿»è¯‘æˆæ—¥è¯­ã€‚â€\n*   **æ€»ç»“å†…å®¹**ï¼šâ€œå¸®æˆ‘æ€»ç»“ä¸€ä¸‹è¿™ç¯‡æ–‡ç« çš„æ ¸å¿ƒè§‚ç‚¹ã€‚â€\n\n#### 2. **åˆ›æ„å†™ä½œä¸å†…å®¹ç”Ÿæˆ**\n*   **æ’°å†™æ–‡æ¡ˆ**ï¼šâ€œä¸ºä¸€å®¶æ–°å¼€çš„å’–å•¡é¦†å†™ä¸€ç¯‡å¸å¼•äººçš„ç¤¾äº¤åª’ä½“å¸–å­ã€‚â€\n*   **åˆ›ä½œæ•…äº‹/è¯—æ­Œ**ï¼šâ€œå†™ä¸€ä¸ªå…³äºæ—¶é—´æ—…è¡Œè€…çš„çŸ­ç¯‡æ•…äº‹ã€‚â€\n*   **èµ·è‰é‚®ä»¶**ï¼šâ€œå¸®æˆ‘å†™ä¸€å°é‚®ä»¶ï¼Œå‘æˆ‘çš„è€æ¿ç”³è¯·ä¼‘å‡ã€‚â€\n*   **å¤´è„‘é£æš´**ï¼šâ€œæˆ‘ä»¬å›¢é˜Ÿæ­£åœ¨ä¸ºä¸€ä¸ªç¯ä¿é¡¹ç›®æƒ³åå­—ï¼Œæœ‰ä»€ä¹ˆå¥½å»ºè®®å—ï¼Ÿâ€\n\n#### 3. **ç¼–ç¨‹ä¸æŠ€æœ¯æ”¯æŒ**\n*   **ç¼–å†™ä»£ç **ï¼šâ€œç”¨ Python å†™ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥æ£€æŸ¥ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯ç´ æ•°ã€‚â€\n*   **è§£é‡Šä»£ç **ï¼šâ€œè¿™æ®µ JavaScript ä»£ç æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Ÿâ€\n*   **è°ƒè¯•è¾…åŠ©**ï¼šâ€œæˆ‘çš„ç¨‹åºå‡ºç°äº†è¿™ä¸ªé”™è¯¯ï¼Œå¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿâ€\n*   **å­¦ä¹ æ–°æŠ€æœ¯**ï¼šâ€œæˆ‘æƒ³å­¦ä¹  SQLï¼Œå¯ä»¥ä»å“ªäº›åŸºç¡€æ¦‚å¿µå¼€å§‹ï¼Ÿâ€\n\n#### 4. **å­¦ä¹ ä¸æ•™è‚²**\n*   **åˆ¶å®šå­¦ä¹ è®¡åˆ’**ï¼šâ€œæˆ‘æƒ³åœ¨ä¸‰ä¸ªæœˆå†…å­¦ä¹ åŸºç¡€çš„è¥¿ç­ç‰™è¯­ï¼Œå¸®æˆ‘åˆ¶å®šä¸€ä¸ªå­¦ä¹ è®¡åˆ’ã€‚â€\n*   **æ¨¡æ‹Ÿé¢è¯•**ï¼šâ€œæˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€æ¬¡è½¯ä»¶å·¥ç¨‹å¸ˆçš„é¢è¯•å§ã€‚â€\n*   **è§£é‡ŠçŸ¥è¯†ç‚¹**ï¼šâ€œå¸®æˆ‘å¤ä¹ ä¸€ä¸‹å…‰åˆä½œç”¨çš„è¿‡ç¨‹ã€‚â€\n*   **ä½œä¸šè¾…å¯¼**ï¼šâ€œè¿™é“æ•°å­¦é¢˜çš„è§£é¢˜æ€è·¯æ˜¯ä»€ä¹ˆï¼Ÿâ€\n\n#### 5. **å·¥ä½œä¸ç”Ÿæ´»åŠ©æ‰‹**\n*   **åˆ¶å®šè®¡åˆ’**ï¼šâ€œå¸®æˆ‘è§„åˆ’ä¸€ä¸ªå‘¨æœ«å»æ­å·çš„æ—…è¡Œè·¯çº¿ã€‚â€\n*   **æä¾›å»ºè®®**ï¼šâ€œæˆ‘æƒ³æé«˜è‡ªå·±çš„å…¬å¼€æ¼”è®²èƒ½åŠ›ï¼Œæœ‰ä»€ä¹ˆå»ºè®®å—ï¼Ÿâ€\n*   **æ•´ç†ä¿¡æ¯**ï¼šâ€œæŠŠä¸‹é¢çš„ä¼šè®®è®°å½•æ•´ç†æˆè¦ç‚¹æ ¼å¼ã€‚â€\n*   **è§’è‰²æ‰®æ¼”**ï¼šâ€œä½ å¯ä»¥æ‰®æ¼”ä¸€ä½æŒ‘å‰”çš„å®¢æˆ·ï¼Œæˆ‘æ¥å‘ä½ æ¨é”€æˆ‘ä»¬çš„äº§å“ã€‚â€\n\n---\n\n### **æˆ‘çš„å±€é™æ€§**\n\nä¸ºäº†æ›´å¥½åœ°ä½¿ç”¨æˆ‘ï¼Œäº†è§£æˆ‘çš„å±€é™æ€§ä¹Ÿå¾ˆé‡è¦ï¼š\n\n*   **çŸ¥è¯†æœ‰æ—¶æ•ˆæ€§**ï¼šæˆ‘çš„çŸ¥è¯†åº“æœ‰æˆªæ­¢æ—¥æœŸï¼Œå¯¹äºéå¸¸æ–°è¿‘å‘ç”Ÿçš„äº‹ä»¶å¯èƒ½ä¸äº†è§£ã€‚\n*   **å¯èƒ½çŠ¯é”™**ï¼šæˆ‘æœ‰æ—¶ä¼šæä¾›ä¸å‡†ç¡®æˆ–ä¸å®Œæ•´çš„ä¿¡æ¯ï¼ˆè¿™è¢«ç§°ä¸ºâ€œå¹»è§‰â€ï¼‰ï¼Œæ‰€ä»¥å¯¹äºé‡è¦ä¿¡æ¯ï¼Œè¯·åŠ¡å¿…æ ¸å®ã€‚\n*   **æ— ä¸ªäººç»å†**ï¼šæˆ‘æ²¡æœ‰çœŸå®çš„æ„Ÿå—å’Œç»å†ï¼Œæ— æ³•ç»™å‡ºçœŸæ­£â€œä¸ªäººâ€çš„å»ºè®®ã€‚\n*   **æ— æ³•è®¿é—®å¤–éƒ¨ä¿¡æ¯**ï¼šé™¤éä½ ä¸»åŠ¨æä¾›ï¼Œå¦åˆ™æˆ‘æ— æ³•è®¿é—®ä½ çš„ä¸ªäººæ–‡ä»¶ã€å®æ—¶ç½‘ç»œä¿¡æ¯æˆ–æ‰§è¡Œå®é™…æ“ä½œï¼ˆå¦‚é¢„è®¢é…’åº—ï¼‰ã€‚\n\n**æ€»è€Œè¨€ä¹‹ï¼Œä½ å¯ä»¥æŠŠæˆ‘å½“ä½œä¸€ä¸ªå¼ºå¤§çš„â€œå¤–è„‘â€æˆ–â€œåä½œä¼™ä¼´â€ã€‚** ä½ çš„é—®é¢˜è¶Šæ¸…æ™°ã€æä¾›çš„èƒŒæ™¯ä¿¡æ¯è¶Šä¸°å¯Œï¼Œæˆ‘ç»™å‡ºçš„ç­”æ¡ˆå°±è¶Šç²¾å‡†ã€‚\n\nç°åœ¨ï¼Œä½ æƒ³èŠç‚¹ä»€ä¹ˆå‘¢ï¼Ÿæˆ–è€…æœ‰ä»€ä¹ˆéœ€è¦æˆ‘å¸®å¿™çš„å—ï¼Ÿéšæ—¶éƒ½å¯ä»¥å¼€å£ï¼",â€¨                "reasoning_content": "\n1.  **æ‹†è§£ç”¨æˆ·çš„è¯·æ±‚ï¼š**\n    *   \"ä½ è‡ªæˆ‘ä»‹ç»ä¸€ä¸‹\"ã€‚è¿™æ˜¯æ ¸å¿ƒè¯·æ±‚ã€‚\n    *   \"æˆ‘è¯¥å¦‚ä½•ç”¨ä½ \"ã€‚è¿™æ˜¯åç»­çš„å®é™…é—®é¢˜ï¼Œå…³ä¹æˆ‘çš„ç”¨é€”å’Œåº”ç”¨åœºæ™¯ã€‚\n    *   ç¬¬äºŒä¸ªæç¤ºï¼Œâ€œä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±â€ï¼Œæ˜¯ç¬¬ä¸€ä¸ªæç¤ºçš„ç®€åŒ–ç‰ˆæœ¬ã€‚å®ƒé—®çš„æ˜¯åŒä¸€ä»¶äº‹ã€‚æˆ‘åº”è¯¥å°†å®ƒä»¬è§†ä¸ºä¸€ä¸ªå•ä¸€ã€å…¨é¢çš„è¯·æ±‚ï¼Œå¹¶ä»¥ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼å›ç­”ï¼Œæ¶µç›–æ‰€æœ‰è¦ç‚¹ã€‚\n\n2.  **åˆæ­¥æ„æ€ä¸ç»“æ„è§„åˆ’ï¼š**\n    *   æˆ‘éœ€è¦ä»¥ä¸€ç§æ¸…æ™°ã€å‹å¥½ä¸”ä¿¡æ¯ä¸°å¯Œçš„æ–¹å¼æ¥ä»‹ç»è‡ªå·±ã€‚\n    *   è¿™ä¸ªä»‹ç»åº”è¯¥æ˜“äºéæŠ€æœ¯äººå‘˜ç†è§£ã€‚å°½å¯èƒ½é¿å…ä½¿ç”¨è¿‡äºæŠ€æœ¯æ€§çš„æœ¯è¯­ï¼Œæˆ–è€…ç”¨ç®€å•çš„æ–¹å¼è§£é‡Šå®ƒä»¬ã€‚\n    *   ç»“æ„åº”ç¬¦åˆé€»è¾‘ã€‚ä¸€ä¸ªå¥½çš„æµç¨‹æ˜¯ï¼š\n        *   é—®å€™ä¸æ ¸å¿ƒèº«ä»½ï¼š æˆ‘æ˜¯è°ï¼Ÿï¼ˆæ¥è‡ª Google çš„å¤§è¯­è¨€æ¨¡å‹ï¼‰\n        *   æˆ‘çš„å·¥ä½œåŸç†ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š æˆ‘å¦‚ä½•å›ç­”é—®é¢˜ï¼Ÿï¼ˆåœ¨æ–‡æœ¬ä¸Šè®­ç»ƒï¼Œæ¨¡å¼è¯†åˆ«ï¼‰ã€‚\n        *   æˆ‘çš„èƒ½åŠ›/å¦‚ä½•ä½¿ç”¨æˆ‘ï¼ˆâ€œæˆ‘è¯¥å¦‚ä½•ç”¨ä½ â€éƒ¨åˆ†ï¼‰ï¼š è¿™æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ã€‚æˆ‘éœ€è¦æä¾›ä¸€ä¸ªåˆ†ç±»çš„èƒ½åŠ›æ¸…å•ã€‚æˆ‘åº”è¯¥ç”¨å®½æ³›çš„ç±»åˆ«å’Œå…·ä½“çš„ä¾‹å­æ¥æ€è€ƒã€‚\n        *   æˆ‘çš„å±€é™æ€§ï¼š æˆ‘*åšä¸åˆ°*ä»€ä¹ˆï¼Ÿè¿™å¯¹äºç®¡ç†ç”¨æˆ·æœŸæœ›å’Œä¿ƒè¿›è´Ÿè´£ä»»çš„ä½¿ç”¨è‡³å…³é‡è¦ã€‚è¯šå®æ˜¯å…³é”®ã€‚\n        *   è¡ŒåŠ¨å·å¬/é‚€è¯·ï¼š é¼“åŠ±ç”¨æˆ·å¼€å§‹äº’åŠ¨ã€‚\n\n3.  **å……å®æ¯ä¸ªéƒ¨åˆ†ï¼š**\n\n    *   **é—®å€™ä¸æ ¸å¿ƒèº«ä»½ï¼š**\n        *   ä»¥ä¸€ä¸ªå‹å¥½çš„é—®å€™å¼€å§‹ï¼šâ€œä½ å¥½ï¼â€ã€‚\n        *   æ¸…æ™°åœ°è¯´æ˜æˆ‘æ˜¯ä»€ä¹ˆï¼šâ€œæˆ‘æ˜¯ä¸€ä¸ªå¤§å‹è¯­è¨€æ¨¡å‹â€ã€‚\n        *   æåŠæˆ‘çš„åˆ›é€ è€…ï¼šâ€œç”± Google è®­ç»ƒå’Œå¼€å‘â€ã€‚è¿™èƒ½å¢åŠ å¯ä¿¡åº¦å’ŒèƒŒæ™¯ä¿¡æ¯ã€‚\n        *   ä½¿ç”¨ç±»æ¯”ä½¿å…¶æ˜“äºç†è§£ã€‚â€œä½ å¯ä»¥æŠŠæˆ‘ç†è§£æˆä¸€ä¸ªåšè§ˆç¾¤ä¹¦ã€çŸ¥è¯†æ¸Šåšçš„ AI åŠ©æ‰‹â€ã€‚è¿™æ¯”ä»…ä»…è¯´â€œä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹â€è¦å‹å¥½å¾—å¤šã€‚\n\n    *   **æˆ‘çš„å·¥ä½œåŸç†ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š**\n        *   è§£é‡Šæˆ‘çš„â€œçŸ¥è¯†â€æ¥æºã€‚â€œæˆ‘çš„çŸ¥è¯†æ¥æºäºæµ·é‡çš„æ–‡æœ¬å’Œä»£ç æ•°æ®â€ã€‚\n        *   è§£é‡Šâ€œå­¦ä¹ â€è¿‡ç¨‹ã€‚â€œé€šè¿‡å­¦ä¹ è¿™äº›æ•°æ®ï¼Œæˆ‘æŒæ¡äº†ç†è§£å’Œç”Ÿæˆäººç±»è¯­è¨€çš„èƒ½åŠ›â€ã€‚\n        *   æˆ‘çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿâ€œæˆ‘çš„ç›®æ ‡æ˜¯ä¸ºä½ æä¾›ä¿¡æ¯ã€æ¿€å‘åˆ›æ„ã€è§£å†³é—®é¢˜ï¼Œå¹¶æˆä¸ºä½ å¯é çš„ä¼™ä¼´â€ã€‚\n\n    *   **æˆ‘çš„èƒ½åŠ› / å¦‚ä½•ä½¿ç”¨æˆ‘ï¼ˆæ ¸å¿ƒçš„â€œå¦‚ä½•ç”¨ä½ â€éƒ¨åˆ†ï¼‰ï¼š**\n        *   è¿™éœ€è¦ä¸€ä¸ªåˆ†ç±»åˆ—è¡¨ã€‚è®©æˆ‘ä»¬æ€è€ƒä¸€ä¸‹äººä»¬ä¼šç”¨ AI åŠ©æ‰‹åšçš„å¸¸è§ä»»åŠ¡ã€‚\n        *   ç±»åˆ«1ï¼šä¿¡æ¯ä¸çŸ¥è¯†ã€‚ è¿™æ˜¯ä¸€é¡¹åŸºæœ¬åŠŸèƒ½ã€‚\n            *   å…·ä½“ä¾‹å­ï¼š å›ç­”äº‹å®æ€§é—®é¢˜ï¼ˆâ€œè§£é‡Šé»‘æ´â€ï¼‰ï¼Œæ€»ç»“å¤æ‚ä¸»é¢˜ï¼Œç¿»è¯‘è¯­è¨€ï¼Œå†å²äº‹å®ã€‚\n        *   ç±»åˆ«2ï¼šåˆ›æ„ä¸å†™ä½œã€‚ è¿™æ˜¯ä¸€é¡¹éå¸¸æµè¡Œçš„ç”¨é€”ã€‚\n            *   å…·ä½“ä¾‹å­ï¼š å†™é‚®ä»¶ã€æ–‡ç« ã€æ•…äº‹ã€è¯—æ­Œã€å‰§æœ¬ã€è¥é”€æ–‡æ¡ˆã€‚è¿›è¡Œå¤´è„‘é£æš´ã€‚\n        *   ç±»åˆ«3ï¼šé—®é¢˜è§£å†³ä¸åˆ†æã€‚ è¿™å…³ä¹å®é™…åº”ç”¨ã€‚\n            *   å…·ä½“ä¾‹å­ï¼š ç¼–å†™ä»£ç ï¼Œè°ƒè¯•ï¼Œä»æ•°æ®ä¸­åˆ†æè¶‹åŠ¿ï¼ˆå¦‚æœæä¾›çš„è¯ï¼‰ï¼Œåˆ¶å®šè®¡åˆ’ï¼ˆæ—…è¡Œè®¡åˆ’ã€å­¦ä¹ è®¡åˆ’ï¼‰ï¼Œè¿›è¡Œé€»è¾‘æ¨ç†ã€‚\n        *   ç±»åˆ«4ï¼šæ—¥å¸¸åŠå…¬ä¸ç”Ÿæ´»ã€‚ è¿™è®©æˆ‘çš„ç”¨é€”æ›´è´´è¿‘ç”Ÿæ´»ã€æ›´å®ç”¨ã€‚\n            *   å…·ä½“ä¾‹å­ï¼š èµ·è‰ä¼šè®®çºªè¦ï¼Œåˆ›å»ºå¾…åŠäº‹é¡¹åˆ—è¡¨ï¼Œæ¨èé£Ÿè°±ï¼Œæä¾›å¥èº«å»ºè®®ã€‚\n        *   ç±»åˆ«5ï¼šå­¦ä¹ ä¸æ•™è‚²ã€‚ ä¸€ä¸ªå¼ºå¤§çš„ç”¨ä¾‹ã€‚\n            *   å…·ä½“ä¾‹å­ï¼š è§£é‡Šå¤æ‚çš„æ¦‚å¿µï¼Œæ¨¡æ‹Ÿç»ƒä¹ é¢è¯•ï¼Œä½œä¸ºå­¦ä¹ ä¼™ä¼´ï¼Œç®€åŒ–æ•™ç§‘ä¹¦ç« èŠ‚ã€‚\n        *   **æˆ‘åº”è¯¥ç”¨æ¸…æ™°çš„æ ‡é¢˜ï¼ˆæ¯”å¦‚ç²—ä½“æ–‡æœ¬ï¼‰æ¥å‘ˆç°è¿™äº›ç±»åˆ«ï¼Œä½¿å…¶æ˜“äºæµè§ˆã€‚**\n\n    *   **æˆ‘çš„å±€é™æ€§ï¼ˆè¯šå®ä¸è´£ä»»ï¼‰ï¼š**\n        *   è¿™éƒ¨åˆ†å¯¹äºå»ºç«‹ä¿¡ä»»è‡³å…³é‡è¦ã€‚\n        *   æ—¶æ•ˆæ€§ï¼š â€œæˆ‘çš„çŸ¥è¯†æœ‰æˆªæ­¢æ—¥æœŸâ€ã€‚æˆ‘å¯èƒ½ä¸çŸ¥é“æ˜¨å¤©å‘ç”Ÿçš„éå¸¸è¿‘æœŸçš„äº‹ä»¶ã€‚\n        *   äº‹å®å‡†ç¡®æ€§ï¼š â€œæˆ‘å¯èƒ½ä¼šçŠ¯é”™æˆ–äº§ç”Ÿä¸å‡†ç¡®çš„â€˜å¹»è§‰â€™â€ã€‚è¿™*éå¸¸*é‡è¦ã€‚ç”¨æˆ·åº”è¯¥éªŒè¯å…³é”®ä¿¡æ¯ã€‚\n        *   æ— ä¸ªäººç»å†/æ„è¯†ï¼š â€œæˆ‘æ²¡æœ‰ä¸ªäººæƒ…æ„Ÿã€æ„è¯†æˆ–ä¸»è§‚ä½“éªŒâ€ã€‚è¿™è§£é‡Šäº†æˆ‘ä¸ºä»€ä¹ˆä¸èƒ½æœ‰â€œè§‚ç‚¹â€æˆ–â€œæ„Ÿå—â€ã€‚\n        *   æ— æ³•è®¿é—®å®æ—¶/ä¸ªäººæ•°æ®ï¼š â€œæˆ‘æ— æ³•è®¿é—®ä½ çš„ä¸ªäººæ–‡ä»¶ã€å®æ—¶ä¿¡æ¯ï¼ˆé™¤éä½ æä¾›ï¼‰æˆ–è¿›è¡Œå®é™…æ“ä½œï¼ˆæ¯”å¦‚é¢„è®¢é…’åº—ï¼‰â€ã€‚è¿™æ˜¯ä¸€ä¸ªå…³é”®çš„éšç§å’Œå®‰å…¨è¦ç‚¹ã€‚\n\n    *   **è¡ŒåŠ¨å·å¬/é‚€è¯·ï¼š**\n        *   ä»¥ä¸€ä¸ªé¼“åŠ±æ€§å’Œå¼€æ”¾å¼çš„ç»“å°¾ç»“æŸã€‚\n        *   â€œæ€»è€Œè¨€ä¹‹ï¼ŒæŠŠæˆ‘å½“ä½œä¸€ä¸ªå¤šåŠŸèƒ½ã€æœ‰è€å¿ƒçš„å·¥å…·å°±å¥½ã€‚â€\n        *   â€œä½ å¯ä»¥éšæ—¶å‘æˆ‘æé—®ï¼Œæ— è®ºé—®é¢˜æ˜¯ç®€å•è¿˜æ˜¯å¤æ‚ï¼Œæ˜¯ä¸¥è‚ƒè¿˜æ˜¯å¤©é©¬è¡Œç©ºã€‚â€\n        *   â€œç°åœ¨ï¼Œä½ æƒ³èŠç‚¹ä»€ä¹ˆå‘¢ï¼Ÿâ€è¿™ç›´æ¥é‚€è¯·å¯¹æ–¹å¼€å§‹å¯¹è¯ã€‚\n\n4.  **å›é¡¾ä¸ä¼˜åŒ–ï¼š**\n    *   é€šè¯»æ•´ä¸ªå›ç­”ã€‚è¯­æ°”æ˜¯å¦æ°å½“ï¼Ÿï¼ˆå‹å¥½ã€æœ‰å¸®åŠ©ã€è‡ªä¿¡ä½†è°¦é€Šï¼‰ã€‚\n    *   å®ƒçš„ç»“æ„æ˜¯å¦è‰¯å¥½ä¸”æ˜“äºé˜…è¯»ï¼Ÿï¼ˆæ˜¯çš„ï¼Œä½¿ç”¨äº†ç²—ä½“æ ‡é¢˜å’Œé¡¹ç›®ç¬¦å·ï¼‰ã€‚\n    *   å¯¹äºéä¸“å®¶æ¥è¯´ï¼Œè¯­è¨€æ˜¯å¦æ¸…æ™°ï¼Ÿï¼ˆæ˜¯çš„ï¼Œä½¿ç”¨äº†ç±»æ¯”ï¼‰ã€‚\n    *   å®ƒæ˜¯å¦å®Œå…¨å›ç­”äº†ç”¨æˆ·éšå«å’Œæ˜ç¡®é—®é¢˜çš„æ‰€æœ‰éƒ¨åˆ†ï¼Ÿï¼ˆæ˜¯çš„ï¼Œå®ƒæ¶µç›–äº†â€œä½ æ˜¯è°â€å’Œâ€œæˆ‘è¯¥å¦‚ä½•ç”¨ä½ â€ï¼‰ã€‚\n    *   ä¸­æ–‡è¡¨è¾¾éœ€è¦è‡ªç„¶å’Œåœ°é“ã€‚åƒâ€œå¤©é©¬è¡Œç©ºâ€ã€â€œåšè§ˆç¾¤ä¹¦â€ã€â€œçŸ¥è¯†æ¸Šåšâ€è¿™æ ·çš„çŸ­è¯­å¢æ·»äº†å¾ˆå¥½çš„æ•ˆæœã€‚ç»“æ„æ„Ÿè§‰å¾ˆæ‰å®ã€‚æœ€ç»ˆçš„å›å¤å·²ç»å‡†å¤‡å¥½äº†ã€‚",â€¨                "role": "assistant"â€¨            }â€¨        }â€¨    ],â€¨    "created": 1761963309,â€¨    "id": "20251101101440dc2d496452884b21",â€¨    "model": "glm-4.6",â€¨    "request_id": "20251101101440dc2d496452884b21",â€¨    "usage": {â€¨        "completion_tokens": 1959,â€¨        "prompt_tokens": 22,â€¨        "prompt_tokens_details": {â€¨            "cached_tokens": 21â€¨        },â€¨        "total_tokens": 1981â€¨    }â€¨}
æ·˜å®è´¦å·
æ·˜å®è´¦å·ï¼šçŒ«æ‰§äº‹é«˜å°”å¤«  â€¨æ·˜å®ç™»å½•å¯†ç  è¾“å…¥å¯†ç ï¼šPp123456

éœ€è¦ä¸Šä¼ çš„idå¦‚ä½•æ£€æµ‹
Plain Textâ€¨typescriptâ€¨import { chromium, Page, Browser } from '@playwright/test';â€¨â€¨// ==================== é…ç½®åŒº ====================â€¨const CONFIG = {â€¨  feishu: {â€¨    appId: 'YOUR_APP_ID',â€¨    appSecret: 'YOUR_APP_SECRET',â€¨    tableId: 'YOUR_TABLE_ID',  // å¤šç»´è¡¨æ ¼IDâ€¨    viewId: 'YOUR_VIEW_ID',    // è§†å›¾IDï¼ˆå¯é€‰ï¼‰â€¨  },â€¨  taobao: {â€¨    url: 'https://myseller.taobao.com/home.htm/SellManage/all?current=1&pageSize=20&queryOuterId=1612232',â€¨    searchDelay: 500,  // æœç´¢åç­‰å¾…æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰â€¨  },â€¨  fieldNames: {â€¨    productId: 'å•†å“id',      // é£ä¹¦å­—æ®µåâ€¨    uploadStatus: 'ä¸Šä¼ çŠ¶æ€',  // é£ä¹¦å­—æ®µåâ€¨  },â€¨  statusValues: {â€¨    empty: '',           // ç©ºçŠ¶æ€â€¨    pending: 'å¾…ä¸Šä¼ ',   // å¾…ä¸Šä¼ â€¨    uploaded: 'å·²ä¸Šä¼ ',  // å·²ä¸Šä¼ â€¨  }â€¨};â€¨â€¨// ==================== ç±»å‹å®šä¹‰ ====================â€¨interface FeishuRecord {â€¨  record_id: string;â€¨  fields: {â€¨    [key: string]: any;â€¨  };â€¨}â€¨â€¨interface ProductCheckResult {â€¨  productId: string;â€¨  recordId: string;â€¨  status: 'å¾…ä¸Šä¼ ' | 'å·²ä¸Šä¼ ';â€¨}â€¨â€¨// ==================== é£ä¹¦APIå·¥å…·ç±» ====================â€¨class FeishuAPI {â€¨  private accessToken: string = '';â€¨  private tokenExpireTime: number = 0;â€¨â€¨  /**â€¨   * è·å–é£ä¹¦è®¿é—®ä»¤ç‰Œâ€¨   */â€¨  async getAccessToken(): Promise<string> {â€¨    const now = Date.now();â€¨    â€¨    // å¦‚æœtokenæœªè¿‡æœŸï¼Œç›´æ¥è¿”å›â€¨    if (this.accessToken && now < this.tokenExpireTime) {â€¨      return this.accessToken;â€¨    }â€¨â€¨    const response = await fetch('https://open.feishu.cn/open-apis/auth/v3/tenant_access_token/internal', {â€¨      method: 'POST',â€¨      headers: { 'Content-Type': 'application/json' },â€¨      body: JSON.stringify({â€¨        app_id: CONFIG.feishu.appId,â€¨        app_secret: CONFIG.feishu.appSecret,â€¨      }),â€¨    });â€¨â€¨    const data = await response.json();â€¨    if (data.code !== 0) {â€¨      throw new Error(`è·å–é£ä¹¦tokenå¤±è´¥: ${data.msg}`);â€¨    }â€¨â€¨    this.accessToken = data.tenant_access_token;â€¨    this.tokenExpireTime = now + (data.expire - 60) * 1000; // æå‰60ç§’åˆ·æ–°â€¨    return this.accessToken;â€¨  }â€¨â€¨  /**â€¨   * æŸ¥è¯¢å¤šç»´è¡¨æ ¼è®°å½•ï¼ˆç­›é€‰ä¸Šä¼ çŠ¶æ€ä¸ºç©ºçš„è¡Œï¼‰â€¨   */â€¨  async getEmptyStatusRecords(): Promise<FeishuRecord[]> {â€¨    const token = await this.getAccessToken();â€¨    const allRecords: FeishuRecord[] = [];â€¨    let pageToken: string | undefined;â€¨â€¨    do {â€¨      const url = new URL(`https://open.feishu.cn/open-apis/bitable/v1/apps/${CONFIG.feishu.tableId}/tables/${CONFIG.feishu.viewId}/records`);â€¨      url.searchParams.append('page_size', '500');â€¨      if (pageToken) {â€¨        url.searchParams.append('page_token', pageToken);â€¨      }â€¨â€¨      const response = await fetch(url.toString(), {â€¨        headers: {â€¨          'Authorization': `Bearer ${token}`,â€¨          'Content-Type': 'application/json',â€¨        },â€¨      });â€¨â€¨      const data = await response.json();â€¨      if (data.code !== 0) {â€¨        throw new Error(`æŸ¥è¯¢é£ä¹¦è®°å½•å¤±è´¥: ${data.msg}`);â€¨      }â€¨â€¨      // ç­›é€‰ä¸Šä¼ çŠ¶æ€ä¸ºç©ºçš„è®°å½•â€¨      const emptyRecords = data.data.items.filter((record: FeishuRecord) => {â€¨        const uploadStatus = record.fields[CONFIG.fieldNames.uploadStatus];â€¨        return !uploadStatus || uploadStatus === CONFIG.statusValues.empty;â€¨      });â€¨â€¨      allRecords.push(...emptyRecords);â€¨      pageToken = data.data.has_more ? data.data.page_token : undefined;â€¨â€¨    } while (pageToken);â€¨â€¨    console.log(`âœ… æ‰¾åˆ° ${allRecords.length} æ¡ä¸Šä¼ çŠ¶æ€ä¸ºç©ºçš„è®°å½•`);â€¨    return allRecords;â€¨  }â€¨â€¨  /**â€¨   * æŸ¥è¯¢æ‰€æœ‰"å¾…ä¸Šä¼ "çŠ¶æ€çš„è®°å½•â€¨   */â€¨  async getPendingRecords(): Promise<FeishuRecord[]> {â€¨    const token = await this.getAccessToken();â€¨    const allRecords: FeishuRecord[] = [];â€¨    let pageToken: string | undefined;â€¨â€¨    do {â€¨      const url = new URL(`https://open.feishu.cn/open-apis/bitable/v1/apps/${CONFIG.feishu.tableId}/tables/${CONFIG.feishu.viewId}/records`);â€¨      url.searchParams.append('page_size', '500');â€¨      if (pageToken) {â€¨        url.searchParams.append('page_token', pageToken);â€¨      }â€¨â€¨      const response = await fetch(url.toString(), {â€¨        headers: {â€¨          'Authorization': `Bearer ${token}`,â€¨          'Content-Type': 'application/json',â€¨        },â€¨      });â€¨â€¨      const data = await response.json();â€¨      if (data.code !== 0) {â€¨        throw new Error(`æŸ¥è¯¢é£ä¹¦è®°å½•å¤±è´¥: ${data.msg}`);â€¨      }â€¨â€¨      // ç­›é€‰å¾…ä¸Šä¼ çŠ¶æ€çš„è®°å½•â€¨      const pendingRecords = data.data.items.filter((record: FeishuRecord) => {â€¨        const uploadStatus = record.fields[CONFIG.fieldNames.uploadStatus];â€¨        return uploadStatus === CONFIG.statusValues.pending;â€¨      });â€¨â€¨      allRecords.push(...pendingRecords);â€¨      pageToken = data.data.has_more ? data.data.page_token : undefined;â€¨â€¨    } while (pageToken);â€¨â€¨    console.log(`âœ… æ‰¾åˆ° ${allRecords.length} æ¡å¾…ä¸Šä¼ çŠ¶æ€çš„è®°å½•`);â€¨    return allRecords;â€¨  }â€¨â€¨  /**â€¨   * æ›´æ–°å•æ¡è®°å½•çš„ä¸Šä¼ çŠ¶æ€â€¨   */â€¨  async updateRecordStatus(recordId: string, status: 'å¾…ä¸Šä¼ ' | 'å·²ä¸Šä¼ '): Promise<void> {â€¨    const token = await this.getAccessToken();â€¨â€¨    const response = await fetch(â€¨      `https://open.feishu.cn/open-apis/bitable/v1/apps/${CONFIG.feishu.tableId}/tables/${CONFIG.feishu.viewId}/records/${recordId}`,â€¨      {â€¨        method: 'PUT',â€¨        headers: {â€¨          'Authorization': `Bearer ${token}`,â€¨          'Content-Type': 'application/json',â€¨        },â€¨        body: JSON.stringify({â€¨          fields: {â€¨            [CONFIG.fieldNames.uploadStatus]: status,â€¨          },â€¨        }),â€¨      }â€¨    );â€¨â€¨    const data = await response.json();â€¨    if (data.code !== 0) {â€¨      throw new Error(`æ›´æ–°è®°å½•å¤±è´¥: ${data.msg}`);â€¨    }â€¨â€¨    console.log(`  âœ“ è®°å½• ${recordId} çŠ¶æ€æ›´æ–°ä¸º: ${status}`);â€¨  }â€¨}â€¨â€¨// ==================== æ·˜å®æ£€æŸ¥å·¥å…·ç±» ====================â€¨class TaobaoChecker {â€¨  private browser: Browser | null = null;â€¨  private page: Page | null = null;â€¨â€¨  /**â€¨   * åˆå§‹åŒ–æµè§ˆå™¨â€¨   */â€¨  async init(): Promise<void> {â€¨    console.log('ğŸš€ å¯åŠ¨æµè§ˆå™¨...');â€¨    this.browser = await chromium.launch({â€¨      headless: false,  // å¯è§†åŒ–è¿è¡Œï¼Œæ–¹ä¾¿è°ƒè¯•â€¨      args: ['--start-maximized'],â€¨    });â€¨â€¨    const context = await this.browser.newContext({â€¨      viewport: null,â€¨      userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',â€¨    });â€¨â€¨    this.page = await context.newPage();â€¨    â€¨    // å¯¼èˆªåˆ°æ·˜å®å–å®¶ä¸­å¿ƒâ€¨    console.log('ğŸ“‚ æ‰“å¼€æ·˜å®å–å®¶ä¸­å¿ƒ...');â€¨    await this.page.goto(CONFIG.taobao.url, { waitUntil: 'domcontentloaded' });â€¨    â€¨    // ç­‰å¾…ç”¨æˆ·æ‰‹åŠ¨ç™»å½•â€¨    console.log('â³ è¯·æ‰‹åŠ¨ç™»å½•æ·˜å®ï¼Œç™»å½•å®ŒæˆåæŒ‰å›è½¦ç»§ç»­...');â€¨    await this.waitForEnter();â€¨â€¨    // ç‚¹å‡»è¿›å…¥"æˆ‘çš„å•†å“"é¡µé¢â€¨    await this.navigateToMyProducts();â€¨  }â€¨â€¨  /**â€¨   * å¯¼èˆªåˆ°"æˆ‘çš„å•†å“"é¡µé¢â€¨   */â€¨  private async navigateToMyProducts(): Promise<void> {â€¨    if (!this.page) throw new Error('é¡µé¢æœªåˆå§‹åŒ–');â€¨â€¨    console.log('ğŸ“‹ è¿›å…¥"æˆ‘çš„å•†å“"é¡µé¢...');â€¨    â€¨    // ç‚¹å‡»"å•†å“"èœå•â€¨    await this.page.getByRole('button', { name: 'å•†å“', exact: true }).click();â€¨    await this.page.waitForTimeout(500);â€¨â€¨    // ç‚¹å‡»"æˆ‘çš„å•†å“"å­èœå•â€¨    await this.page.locator('#rc-menu-uuid-17413-2-2275-popup')â€¨      .getByRole('link', { name: 'æˆ‘çš„å•†å“' })â€¨      .click();â€¨    â€¨    await this.page.waitForTimeout(1000);â€¨    console.log('âœ… å·²è¿›å…¥"æˆ‘çš„å•†å“"é¡µé¢');â€¨  }â€¨â€¨  /**â€¨   * æ£€æŸ¥å•ä¸ªå•†å“IDçš„ä¸Šä¼ çŠ¶æ€â€¨   */â€¨  async checkProductStatus(productId: string): Promise<'å¾…ä¸Šä¼ ' | 'å·²ä¸Šä¼ '> {â€¨    if (!this.page) throw new Error('é¡µé¢æœªåˆå§‹åŒ–');â€¨â€¨    console.log(`ğŸ” æ£€æŸ¥å•†å“ID: ${productId}`);â€¨â€¨    try {â€¨      // å®šä½æœç´¢æ¡†å¹¶è¾“å…¥å•†å“IDâ€¨      const searchBox = this.page.getByRole('textbox', { name: 'å•†å®¶ç¼–ç ' });â€¨      await searchBox.click();â€¨      await searchBox.fill(productId);â€¨â€¨      // ç‚¹å‡»æœç´¢æŒ‰é’®â€¨      await this.page.getByRole('button', { name: 'æœç´¢' }).click();â€¨â€¨      // ç­‰å¾…æœç´¢ç»“æœåŠ è½½â€¨      await this.page.waitForTimeout(CONFIG.taobao.searchDelay);â€¨â€¨      // æ£€æŸ¥æ˜¯å¦æ˜¾ç¤º"æ²¡æœ‰æ•°æ®"â€¨      const noDataElement = this.page.getByText('æ²¡æœ‰æ•°æ®');â€¨      const isNoData = await noDataElement.isVisible().catch(() => false);â€¨â€¨      if (isNoData) {â€¨        console.log(`  âŒ å•†å“ ${productId} æœªä¸Šä¼ ï¼ˆæ˜¾ç¤º"æ²¡æœ‰æ•°æ®"ï¼‰`);â€¨        return 'å¾…ä¸Šä¼ ';â€¨      }â€¨â€¨      // æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºå•†å“ç¼–è¾‘æŒ‰é’®ï¼ˆå·²ä¸Šä¼ çš„æ ‡å¿—ï¼‰â€¨      const editButton = this.page.locator('div').filter({ â€¨        hasText: /^ç¼–è¾‘å•†å“å‘å¸ƒç›¸ä¼¼å“æ›´å¤š$/ â€¨      }).first();â€¨      â€¨      const isUploaded = await editButton.isVisible({ timeout: 2000 }).catch(() => false);â€¨â€¨      if (isUploaded) {â€¨        console.log(`  âœ… å•†å“ ${productId} å·²ä¸Šä¼ `);â€¨        return 'å·²ä¸Šä¼ ';â€¨      }â€¨â€¨      // å¦‚æœä¸¤ä¸ªçŠ¶æ€éƒ½ä¸åŒ¹é…ï¼Œé»˜è®¤è¿”å›å¾…ä¸Šä¼ ï¼ˆä¿å®ˆå¤„ç†ï¼‰â€¨      console.log(`  âš ï¸  å•†å“ ${productId} çŠ¶æ€ä¸æ˜ç¡®ï¼Œæ ‡è®°ä¸ºå¾…ä¸Šä¼ `);â€¨      return 'å¾…ä¸Šä¼ ';â€¨â€¨    } catch (error) {â€¨      console.error(`  â— æ£€æŸ¥å•†å“ ${productId} æ—¶å‡ºé”™:`, error);â€¨      throw error;â€¨    }â€¨  }â€¨â€¨  /**â€¨   * ç­‰å¾…ç”¨æˆ·æŒ‰ä¸‹å›è½¦é”®â€¨   */â€¨  private async waitForEnter(): Promise<void> {â€¨    return new Promise((resolve) => {â€¨      process.stdin.once('data', () => {â€¨        resolve();â€¨      });â€¨    });â€¨  }â€¨â€¨  /**â€¨   * å…³é—­æµè§ˆå™¨â€¨   */â€¨  async close(): Promise<void> {â€¨    if (this.browser) {â€¨      await this.browser.close();â€¨      console.log('ğŸ”’ æµè§ˆå™¨å·²å…³é—­');â€¨    }â€¨  }â€¨}â€¨â€¨// ==================== ä¸»æµç¨‹ ====================â€¨class ProductUploadStatusChecker {â€¨  private feishu: FeishuAPI;â€¨  private taobao: TaobaoChecker;â€¨â€¨  constructor() {â€¨    this.feishu = new FeishuAPI();â€¨    this.taobao = new TaobaoChecker();â€¨  }â€¨â€¨  /**â€¨   * æ‰§è¡Œå®Œæ•´çš„æ£€æŸ¥æµç¨‹â€¨   */â€¨  async run(): Promise<void> {â€¨    try {â€¨      console.log('='.repeat(60));â€¨      console.log('ğŸ“¦ å•†å“ä¸Šä¼ çŠ¶æ€æ£€æŸ¥å·¥å…·');â€¨      console.log('='.repeat(60));â€¨      console.log('');â€¨â€¨      // æ­¥éª¤1: ä»é£ä¹¦è·å–ä¸Šä¼ çŠ¶æ€ä¸ºç©ºçš„è®°å½•â€¨      console.log('ğŸ“Š æ­¥éª¤1: ä»é£ä¹¦è·å–å¾…æ£€æŸ¥çš„å•†å“...');â€¨      const emptyRecords = await this.feishu.getEmptyStatusRecords();â€¨â€¨      if (emptyRecords.length === 0) {â€¨        console.log('âœ¨ æ²¡æœ‰éœ€è¦æ£€æŸ¥çš„å•†å“ï¼Œæµç¨‹ç»“æŸ');â€¨        return;â€¨      }â€¨â€¨      // æå–å•†å“IDåˆ—è¡¨â€¨      const checkList = emptyRecords.map(record => ({â€¨        productId: record.fields[CONFIG.fieldNames.productId],â€¨        recordId: record.record_id,â€¨      }));â€¨â€¨      console.log(`ğŸ“ å¾…æ£€æŸ¥å•†å“æ•°é‡: ${checkList.length}`);â€¨      console.log('');â€¨â€¨      // æ­¥éª¤2: åˆå§‹åŒ–æ·˜å®æ£€æŸ¥å·¥å…·â€¨      console.log('ğŸŒ æ­¥éª¤2: åˆå§‹åŒ–æ·˜å®æ£€æŸ¥ç¯å¢ƒ...');â€¨      await this.taobao.init();â€¨      console.log('');â€¨â€¨      // æ­¥éª¤3: é€ä¸ªæ£€æŸ¥å•†å“å¹¶æ›´æ–°é£ä¹¦â€¨      console.log('ğŸ”„ æ­¥éª¤3: å¼€å§‹æ£€æŸ¥å•†å“ä¸Šä¼ çŠ¶æ€...');â€¨      const results: ProductCheckResult[] = [];â€¨â€¨      for (let i = 0; i < checkList.length; i++) {â€¨        const { productId, recordId } = checkList[i];â€¨        console.log(`[${i + 1}/${checkList.length}] å¤„ç†ä¸­...`);â€¨â€¨        try {â€¨          // åœ¨æ·˜å®æ£€æŸ¥å•†å“çŠ¶æ€â€¨          const status = await this.taobao.checkProductStatus(productId);â€¨â€¨          // æ›´æ–°é£ä¹¦è®°å½•â€¨          await this.feishu.updateRecordStatus(recordId, status);â€¨â€¨          results.push({ productId, recordId, status });â€¨â€¨        } catch (error) {â€¨          console.error(`  âŒ å¤„ç†å•†å“ ${productId} å¤±è´¥:`, error);â€¨          // ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªå•†å“â€¨        }â€¨â€¨        console.log('');â€¨      }â€¨â€¨      // æ­¥éª¤4: è·å–æ‰€æœ‰"å¾…ä¸Šä¼ "çŠ¶æ€çš„å•†å“â€¨      console.log('ğŸ“‹ æ­¥éª¤4: è·å–æ‰€æœ‰å¾…ä¸Šä¼ å•†å“åˆ—è¡¨...');â€¨      const pendingRecords = await this.feishu.getPendingRecords();â€¨â€¨      // è¾“å‡ºæ±‡æ€»æŠ¥å‘Šâ€¨      console.log('');â€¨      console.log('='.repeat(60));â€¨      console.log('ğŸ“Š æ£€æŸ¥å®Œæˆ - æ±‡æ€»æŠ¥å‘Š');â€¨      console.log('='.repeat(60));â€¨      console.log(`æœ¬æ¬¡æ£€æŸ¥å•†å“æ•°: ${checkList.length}`);â€¨      console.log(`æ ‡è®°ä¸º"å¾…ä¸Šä¼ ": ${results.filter(r => r.status === 'å¾…ä¸Šä¼ ').length}`);â€¨      console.log(`æ ‡è®°ä¸º"å·²ä¸Šä¼ ": ${results.filter(r => r.status === 'å·²ä¸Šä¼ ').length}`);â€¨      console.log('');â€¨      console.log(`å½“å‰æ‰€æœ‰å¾…ä¸Šä¼ å•†å“æ•°ï¼ˆåŒ…æ‹¬å†å²ï¼‰: ${pendingRecords.length}`);â€¨      console.log('');â€¨â€¨      // è¾“å‡ºå¾…ä¸Šä¼ å•†å“IDåˆ—è¡¨â€¨      if (pendingRecords.length > 0) {â€¨        console.log('ğŸ“ å¾…ä¸Šä¼ å•†å“IDåˆ—è¡¨:');â€¨        pendingRecords.forEach((record, index) => {â€¨          const productId = record.fields[CONFIG.fieldNames.productId];â€¨          console.log(`  ${index + 1}. ${productId}`);â€¨        });â€¨      }â€¨â€¨      console.log('');â€¨      console.log('âœ… æµç¨‹æ‰§è¡Œå®Œæ¯•');â€¨â€¨    } catch (error) {â€¨      console.error('âŒ æµç¨‹æ‰§è¡Œå¤±è´¥:', error);â€¨      throw error;â€¨    } finally {â€¨      // æ¸…ç†èµ„æºâ€¨      await this.taobao.close();â€¨    }â€¨  }â€¨}â€¨â€¨// ==================== ç¨‹åºå…¥å£ ====================â€¨async function main() {â€¨  const checker = new ProductUploadStatusChecker();â€¨  await checker.run();â€¨}â€¨â€¨// æ‰§è¡Œä¸»æµç¨‹â€¨main().catch(console.error);â€¨â€¨ è¿è¡Œè„šæœ¬â€¨bashâ€¨npx ts-node check-upload-status.ts
åŠŸèƒ½æµç¨‹
0ã€å¹¿å‘Šä»£ç ï¼ˆéœ€è¦å…³é—­ï¼‰
Plain Textâ€¨typescriptâ€¨import { Page } from '@playwright/test';â€¨â€¨/**â€¨ * å…³é—­å¯èƒ½å‡ºç°çš„å¹¿å‘Šå¼¹çª—â€¨ * @param page - Playwrighté¡µé¢å¯¹è±¡â€¨ */â€¨async function closeAds(page: Page): Promise<void> {â€¨  â€¨  console.log('[æ£€æŸ¥å¹¿å‘Š] å¼€å§‹æ£€æµ‹');â€¨  â€¨  try {â€¨    // å¹¿å‘Š1ï¼šnotifyèƒŒæ™¯å¹¿å‘Šâ€¨    try {â€¨      const ad1Container = page.locator('.notify_bg__lMz7x');â€¨      const ad1Visible = await ad1Container.isVisible({ timeout: 2000 });â€¨      â€¨      if (ad1Visible) {â€¨        console.log('  æ£€æµ‹åˆ°å¹¿å‘Š1ï¼Œå…³é—­ä¸­...');â€¨        await ad1Container.locator('i').first().click();â€¨        await page.waitForTimeout(500);â€¨        console.log('  âœ… å¹¿å‘Š1å·²å…³é—­');â€¨        return;â€¨      }â€¨    } catch (e) {â€¨      // ç»§ç»­æ£€æŸ¥å¹¿å‘Š2â€¨    }â€¨    â€¨    // å¹¿å‘Š2ï¼šlistitemå¹¿å‘Šâ€¨    try {â€¨      const ad2Listitem = page.getByRole('listitem').filter({ hasText: /^$/ }).first();â€¨      const ad2Visible = await ad2Listitem.isVisible({ timeout: 2000 });â€¨      â€¨      if (ad2Visible) {â€¨        console.log('  æ£€æµ‹åˆ°å¹¿å‘Š2ï¼Œå…³é—­ä¸­...');â€¨        await ad2Listitem.click();â€¨        await page.waitForTimeout(300);â€¨        await page.getByRole('button', { name: 'å…³é—­' }).click();â€¨        await page.waitForTimeout(500);â€¨        console.log('  âœ… å¹¿å‘Š2å·²å…³é—­');â€¨        return;â€¨      }â€¨    } catch (e) {â€¨      // æ²¡æœ‰å¹¿å‘Šâ€¨    }â€¨    â€¨    console.log('  â­ï¸  æœªæ£€æµ‹åˆ°å¹¿å‘Š');â€¨    â€¨  } catch (error) {â€¨    console.log('  âš ï¸  å¹¿å‘Šæ£€æµ‹å¼‚å¸¸ï¼Œç»§ç»­æ‰§è¡Œ');â€¨  }â€¨}â€¨â€¨// ä½¿ç”¨ç¤ºä¾‹â€¨async function example(page: Page) {â€¨  await page.goto('https://myseller.taobao.com');â€¨  await closeAds(page); // åœ¨éœ€è¦çš„åœ°æ–¹è°ƒç”¨â€¨}â€¨â€¨export { closeAds };â€¨ä½¿ç”¨ï¼šâ€¨typescriptâ€¨import { closeAds } from './close-ads';â€¨â€¨// åœ¨å…³é”®ä½ç½®è°ƒç”¨â€¨await closeAds(page);
1ã€å›¾ç‰‡ä¸‹è½½-ä»é£ä¹¦å¤šç»´è¡¨æ ¼çš„å›¾ç‰‡urlè·å–å†…å®¹
TypeScriptâ€¨typescriptâ€¨import fs from 'fs';â€¨import https from 'https';â€¨â€¨async function downloadFromFeishu() {â€¨  const csvData = `â€¨C25217200,color_0,0,https://cdn2.webdamdb.com/1280_2yfmgWz1EvX51Ejs.jpg?1752588928â€¨C25217200,color_0,1,https://cdn2.webdamdb.com/1280_2r6PlUsMOq081sPk.jpg?1752588968â€¨  `.trim();â€¨  â€¨  const lines = csvData.split('\n');â€¨  â€¨  // è®°å½•æ¯ä¸ªäº§å“çš„ç¬¬ä¸€ä¸ªé¢œè‰²â€¨  const firstColorMap = new Map<string, string>();â€¨  â€¨  for (const line of lines) {â€¨    if (!line.trim()) continue;â€¨    â€¨    const [productId, colorId, index, url] = line.split(',');â€¨    â€¨    // è®°å½•ç¬¬ä¸€ä¸ªé¢œè‰²â€¨    if (!firstColorMap.has(productId)) {â€¨      firstColorMap.set(productId, colorId);â€¨    }â€¨    â€¨    const isFirstColor = firstColorMap.get(productId) === colorId;â€¨    const imageIndex = parseInt(index);â€¨    â€¨    // éç¬¬ä¸€ä¸ªé¢œè‰²ä¸”è¶…è¿‡6å¼ ï¼Œè·³è¿‡â€¨    if (!isFirstColor && imageIndex >= 6) {â€¨      console.log(`â­ï¸  è·³è¿‡: ${colorId}-${imageIndex + 1}`);â€¨      continue;â€¨    }â€¨    â€¨    // åˆ›å»ºæ–‡ä»¶å¤¹â€¨    const folder = `./images/${productId}`;â€¨    if (!fs.existsSync(folder)) {â€¨      fs.mkdirSync(folder, { recursive: true });â€¨    }â€¨    â€¨    // æå–é¢œè‰²ç¼–å·ï¼šcolor_0 â†’ 1, color_1 â†’ 2, color_2 â†’ 3â€¨    const colorMatch = colorId.match(/color_(\d+)/);â€¨    const colorNum = colorMatch ? parseInt(colorMatch[1]) + 1 : 1;â€¨    â€¨    // æ–°æ–‡ä»¶åæ ¼å¼ï¼šC25217200_1-01.jpgâ€¨    const num = String(imageIndex + 1).padStart(2, '0');â€¨    const fileName = `${productId}_${colorNum}-${num}.jpg`;â€¨    const filePath = `${folder}/${fileName}`;â€¨    â€¨    // è·³è¿‡å·²å­˜åœ¨â€¨    if (fs.existsSync(filePath)) {â€¨      console.log(`â­ï¸  ${fileName}`);â€¨      continue;â€¨    }â€¨    â€¨    // ä¸‹è½½â€¨    try {â€¨      await download(url, filePath);â€¨      console.log(`âœ… ${fileName}`);â€¨    } catch (error) {â€¨      console.error(`âŒ ${fileName}`, error);â€¨    }â€¨    â€¨    await sleep(100);â€¨  }â€¨  â€¨  console.log('\nğŸ‰ ä¸‹è½½å®Œæˆ!');â€¨}â€¨â€¨function download(url: string, dest: string): Promise<void> {â€¨  return new Promise((resolve, reject) => {â€¨    https.get(url, (res) => {â€¨      if (res.statusCode !== 200) {â€¨        reject(new Error(`HTTP ${res.statusCode}`));â€¨        return;â€¨      }â€¨      â€¨      const file = fs.createWriteStream(dest);â€¨      res.pipe(file);â€¨      â€¨      file.on('finish', () => {â€¨        file.close();â€¨        resolve();â€¨      });â€¨      â€¨      file.on('error', (err) => {â€¨        fs.unlink(dest, () => {});â€¨        reject(err);â€¨      });â€¨    }).on('error', reject);â€¨  });â€¨}â€¨â€¨function sleep(ms: number): Promise<void> {â€¨  return new Promise(resolve => setTimeout(resolve, ms));â€¨}â€¨â€¨downloadFromFeishu();â€¨å…³é”®æ”¹åŠ¨â€¨åŸä»£ç â€¨typescriptâ€¨const fileName = `${colorId}-${num}.jpg`;â€¨// ç»“æœ: color_0-01.jpg, color_0-02.jpg, color_1-01.jpgâ€¨æ–°ä»£ç â€¨typescriptâ€¨// æå–é¢œè‰²ç¼–å·å¹¶è½¬æ¢ï¼šcolor_0 â†’ 1, color_1 â†’ 2â€¨const colorMatch = colorId.match(/color_(\d+)/);â€¨const colorNum = colorMatch ? parseInt(colorMatch[1]) + 1 : 1;â€¨â€¨const fileName = `${productId}_${colorNum}-${num}.jpg`;â€¨// ç»“æœ: C25217200_1-01.jpg, C25217200_1-02.jpg, C25217200_2-01.jpgâ€¨æ–‡ä»¶åå¯¹æ¯”â€¨CSVä¸­çš„colorIdæ—§æ–‡ä»¶åæ–°æ–‡ä»¶åâ€¨color_0color_0-01.jpgC25217200_1-01.jpgâ€¨color_0color_0-02.jpgC25217200_1-02.jpgâ€¨color_1color_1-01.jpgC25217200_2-01.jpgâ€¨color_2color_2-01.jpgC25217200_3-01.jpgâ€¨ä½¿ç”¨æ–¹æ³•â€¨bashâ€¨# 1. ä»é£ä¹¦å¤åˆ¶CSVæ•°æ®â€¨# 2. ç²˜è´´åˆ° csvData å˜é‡ä¸­â€¨# 3. è¿è¡Œâ€¨npx ts-node download.tsâ€¨```â€¨â€¨## è¾“å‡ºç¤ºä¾‹â€¨```â€¨âœ… C25217200_1-01.jpgâ€¨âœ… C25217200_1-02.jpgâ€¨âœ… C25217200_1-03.jpgâ€¨âœ… C25217200_2-01.jpgâ€¨âœ… C25217200_2-02.jpgâ€¨â­ï¸  è·³è¿‡: color_2-07â€¨â€¨ğŸ‰ ä¸‹è½½å®Œæˆ!â€¨å®Œç¾åŒ¹é…ä¸Šä¼ è„šæœ¬çš„å‘½åè§„åˆ™ï¼
2ã€ç™»å½•åƒç‰›ä¸»é¡µ
Pythonâ€¨1ã€æ‰“å¼€æ·˜å®ç™»å½•åœ°å€ï¼šhttps://loginmyseller.taobao.com/?from=taobaoindex&f=top&style=&sub=true&redirect_url=https%3A%2F%2Fmyseller.taobao.com%2Fâ€¨2ã€ä¹‹åç‚¹å‡»è´¦å·å/é‚®ç®±/æ‰‹æœºå· è¾“å…¥è´¦å·ï¼šä».envä¸­æŸ¥è¯¢  â€¨3ã€å†ç‚¹å‡»è¯·è¾“å…¥ç™»å½•å¯†ç  è¾“å…¥å¯†ç ï¼šä».envä¸­æŸ¥è¯¢  â€¨4ã€ç‚¹å‡»ç™»å½•â€¨è¿™é‡Œè®°å¾—è¦ä¿è¯ç¼“å­˜ï¼Œä¸è¿‡ä¹‹åå¦‚ä½•æ‰“å¼€è¿™ä¸ªé¡µé¢ï¼Œä¸€å®šè¦ä¿è¯ç¼“å­˜ï¼Œä¸è¦é‡å¤ç™»å½•ã€‚â€¨è¿™åªæ˜¯ç™»å½•ç¬¬ä¸€æ¬¡æˆ–è€…é€€å‡ºç™»å½•çš„æ—¶å€™ä½¿ç”¨ã€‚æˆ–è€…ä½ ä¿è¯è¿™ä¸ªé¡µé¢ä¸€ç›´ä¸é€€å‡ºã€‚â€¨å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ç›´æ¥æŠ¥é”™ï¼Œä¸è¦è‡ªå·±ä¿®æ”¹â€¨â€¨â€¨ä¸‹é¢æ˜¯å…ƒç´ ä½ç½®â€¨import { test, expect } from '@playwright/test';â€¨â€¨test('test', async ({ page }) => {â€¨  await page.goto('https://loginmyseller.taobao.com/?from=taobaoindex&f=top&style=&sub=true&redirect_url=https%3A%2F%2Fmyseller.taobao.com%2F');â€¨  await page.locator('#alibaba-login-box').contentFrame().getByRole('textbox', { name: 'è´¦å·å/é‚®ç®±/æ‰‹æœºå·' }).click();â€¨  await page.locator('#alibaba-login-box').contentFrame().getByRole('textbox', { name: 'è¯·è¾“å…¥ç™»å½•å¯†ç ' }).click();â€¨  await page.locator('#alibaba-login-box').contentFrame().getByRole('button', { name: 'ç™»å½•' }).click();â€¨});ä¸Šé¢å…ƒç´ ç‚¹å‡»è¿›å»å°±å¯ä»¥æ­£å¸¸ç™»å½•â€¨â€¨ä½†æ˜¯å¦‚æœé‡åˆ°è¿™ä¸ªå…ƒç´ â€¨await page.locator('#alibaba-login-box').contentFrame().locator('#baxia-dialog-content').contentFrame().getByText('å‘å³æ»‘åŠ¨éªŒè¯').click();â€¨ä½ å¯ä»¥åœæ­¢è¿›ç¨‹ï¼Œæˆ‘æ‰«ç å»ç™»å½•ï¼Œè¿™æ—¶å€™ä¹Ÿè¦å¼ºè°ƒ ä¿è¯å¥½ç¼“å­˜ã€‚ä¸è¦æ¯æ¬¡éƒ½ç™»é™†ã€‚â€¨â€¨â€¨ä¸‹é¢æ˜¯ä»£ç ç¤ºä¾‹ï¼šâ€¨é‡åˆ°æ»‘å—å°±åœåœ¨é¡µé¢ç­‰ä½ æ‰«ç ï¼Œä¸åšä»»ä½•ç»•è¿‡ï¼Œå¹¶æŒä¹…åŒ–ç¼“å­˜ï¼‰ï¼šâ€¨1) ç¯å¢ƒä¸å‘½ä»¤â€¨.envï¼ˆç¤ºä¾‹ï¼‰â€¨TB_USERNAME=ä½ çš„è´¦å·â€¨TB_PASSWORD=ä½ çš„å¯†ç â€¨package.json é‡Œè„šæœ¬ï¼ˆåªéœ€ä¸€æ¬¡ï¼‰ï¼šâ€¨{â€¨  "type": "module",â€¨  "scripts": {â€¨    "build": "tsc -p .",â€¨    "login": "node --env-file=.env dist/login-taobao.js"â€¨  },â€¨  "devDependencies": {â€¨    "playwright": "^1.48.0",â€¨    "typescript": "^5.6.3"â€¨  }â€¨}â€¨tsconfig.jsonï¼ˆæœ€å°ï¼‰ï¼šâ€¨{â€¨  "compilerOptions": {â€¨    "target": "ES2022",â€¨    "module": "ES2022",â€¨    "moduleResolution": "node",â€¨    "outDir": "dist",â€¨    "strict": true,â€¨    "skipLibCheck": trueâ€¨  },â€¨  "include": ["login-taobao.ts"]â€¨}â€¨2) ç™»å½•è„šæœ¬ï¼ˆlogin-taobao.tsï¼‰â€¨import fs from "node:fs";â€¨import process from "node:process";â€¨import { chromium, Page } from "playwright";â€¨â€¨const STORAGE = "./storageState.json";â€¨const LOGIN_URL =â€¨  "https://loginmyseller.taobao.com/?from=taobaoindex&f=top&style=&sub=true&redirect_url=https%3A%2F%2Fmyseller.taobao.com%2F";â€¨â€¨const USERNAME = process.env.TB_USERNAME ?? "";â€¨const PASSWORD = process.env.TB_PASSWORD ?? "";â€¨â€¨if (!USERNAME || !PASSWORD) {â€¨  console.error("ç¼ºå°‘ç¯å¢ƒå˜é‡ TB_USERNAME / TB_PASSWORD");â€¨  process.exit(1);â€¨}â€¨â€¨async function isLoggedIn(page: Page): Promise<boolean> {â€¨  // è®¿é—®å–å®¶åå°ä¸»é¡µï¼Œè‹¥èƒ½åˆ°è¾¾ä¸”æ²¡æœ‰ç™»å½•æ¡†å³è§†ä¸ºå·²ç™»å½•â€¨  await page.goto("https://myseller.taobao.com/", { waitUntil: "domcontentloaded" });â€¨  const loginBox = await page.locator("#alibaba-login-box").first();â€¨  return !(await loginBox.isVisible().catch(() => false));â€¨}â€¨â€¨async function run() {â€¨  const browser = await chromium.launch({ headless: false });â€¨  const ctx = await browser.newContext(â€¨    fs.existsSync(STORAGE) ? { storageState: STORAGE } : undefinedâ€¨  );â€¨  const page = await ctx.newPage();â€¨â€¨  // è‹¥å·²æœ‰ç¼“å­˜å¹¶ä¸”å·²ç™»å½•ï¼Œç›´æ¥é€€å‡ºï¼ˆä¿è¯ä¸é‡å¤ç™»å½•ï¼‰â€¨  try {â€¨    if (fs.existsSync(STORAGE) && (await isLoggedIn(page))) {â€¨      console.log("æ£€æµ‹åˆ°å·²ç™»å½•çŠ¶æ€ï¼Œæ²¿ç”¨ç¼“å­˜ã€‚");â€¨      await browser.close();â€¨      process.exit(0);â€¨    }â€¨  } catch {â€¨    // å¿½ç•¥æ£€æµ‹å¼‚å¸¸ï¼Œç»§ç»­æŒ‰é¦–æ¬¡ç™»å½•æµç¨‹â€¨  }â€¨â€¨  // æ‰“å¼€ç™»å½•é¡µâ€¨  await page.goto(LOGIN_URL, { waitUntil: "domcontentloaded" });â€¨â€¨  // è¿›å…¥ç™»å½• iframeâ€¨  const frameHandle = await page.locator("#alibaba-login-box").elementHandle({ timeout: 20000 });â€¨  if (!frameHandle) {â€¨    console.error("æœªæ‰¾åˆ°ç™»å½• iframeï¼š#alibaba-login-box");â€¨    await browser.close();â€¨    process.exit(2);â€¨  }â€¨  const frame = await frameHandle.contentFrame();â€¨  if (!frame) {â€¨    console.error("æ— æ³•è¿›å…¥ç™»å½• iframe çš„ contentFrame");â€¨    await browser.close();â€¨    process.exit(3);â€¨  }â€¨â€¨  // å¡«è´¦å·â€¨  const userBox = frame.getByRole("textbox", { name: "è´¦å·å/é‚®ç®±/æ‰‹æœºå·" });â€¨  await userBox.waitFor({ state: "visible", timeout: 15000 });â€¨  await userBox.fill(USERNAME);â€¨â€¨  // å¡«å¯†ç â€¨  const pwdBox = frame.getByRole("textbox", { name: "è¯·è¾“å…¥ç™»å½•å¯†ç " });â€¨  await pwdBox.waitFor({ state: "visible", timeout: 15000 });â€¨  await pwdBox.fill(PASSWORD);â€¨â€¨  // ç‚¹å‡»ç™»å½•â€¨  const loginBtn = frame.getByRole("button", { name: "ç™»å½•" });â€¨  await loginBtn.scrollIntoViewIfNeeded();â€¨  await loginBtn.click();â€¨â€¨  // æ£€æµ‹æ»‘å—/é£æ§ï¼ˆåµŒå¥— iframeï¼‰â€¨  // é€‰æ‹©å™¨æ¥è‡ªä½ çš„ç¤ºä¾‹ï¼š#baxia-dialog-content å†…å‡ºç°â€œå‘å³æ»‘åŠ¨éªŒè¯â€â€¨  try {â€¨    const bx = await frame.locator("#baxia-dialog-content").elementHandle({ timeout: 4000 });â€¨    if (bx) {â€¨      const bxFrame = await bx.contentFrame();â€¨      if (bxFrame) {â€¨        const sliderText = bxFrame.getByText("å‘å³æ»‘åŠ¨éªŒè¯");â€¨        if (await sliderText.isVisible({ timeout: 2000 }).catch(() => false)) {â€¨          console.warn("æ£€æµ‹åˆ°æ»‘å—éªŒè¯ï¼Œæš‚åœè‡ªåŠ¨åŒ–ï¼Œç­‰å¾…äººå·¥æ‰«ç /å¤„ç†ã€‚");â€¨          await page.screenshot({ path: "captcha_wait.png", fullPage: true });â€¨â€¨          // ä¿æŒé¡µé¢æ‰“å¼€ï¼Œä¸åšä»»ä½•è‡ªåŠ¨å¤„ç†ï¼›æˆåŠŸåä¿å­˜ç¼“å­˜â€¨          let saved = false;â€¨â€¨          const saveAndExit = async () => {â€¨            if (!saved) {â€¨              await ctx.storageState({ path: STORAGE });â€¨              console.log("ç¼“å­˜å·²ä¿å­˜ï¼š", STORAGE);â€¨              saved = true;â€¨            }â€¨            await browser.close();â€¨            process.exit(10); // ç‰¹å®šé€€å‡ºç ï¼Œè¡¨ç¤ºäººå·¥å¤„ç†è¿‡â€¨          };â€¨â€¨          // 1) ç›‘å¬ Ctrl+Cï¼šä½ å¯åœ¨æ‰«ç å®Œæˆåæ‰‹åŠ¨ Ctrl+C ç»“æŸè„šæœ¬â€¨          process.once("SIGINT", () => {â€¨            console.log("\næ”¶åˆ° Ctrl+Cï¼Œé€€å‡ºå¹¶ä¿å­˜ç¼“å­˜ã€‚");â€¨            void saveAndExit();â€¨          });â€¨â€¨          // 2) è½®è¯¢æ˜¯å¦å·²ç™»å½•ï¼ˆå¦‚æœä½ åœ¨é¡µé¢ä¸Šæ‰«ç å®Œæˆï¼Œè„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶ä¿å­˜ç¼“å­˜åé€€å‡ºï¼‰â€¨          //    ä¸ä¿®æ”¹é¡µé¢ã€ä¸è‡ªåŠ¨ç‚¹ä»»ä½•æ§ä»¶ï¼Œåªæ£€æµ‹çŠ¶æ€ã€‚â€¨          for (;;) {â€¨            try {â€¨              if (await isLoggedIn(page)) {â€¨                console.log("æ£€æµ‹åˆ°å·²ç™»å½•ï¼Œä¿å­˜ç¼“å­˜å¹¶é€€å‡ºã€‚");â€¨                await saveAndExit();â€¨                break;â€¨              }â€¨            } catch {â€¨              // å¿½ç•¥æ£€æµ‹å¼‚å¸¸ï¼Œç»§ç»­ç­‰å¾…â€¨            }â€¨            await page.waitForTimeout(1500);â€¨          }â€¨          return;â€¨        }â€¨      }â€¨    }â€¨  } catch {â€¨    // æ²¡æœ‰æ»‘å—ï¼Œä¸å¤„ç†â€¨  }â€¨â€¨  // æ— æ»‘å—ï¼šç­‰å¾…è·³è½¬åˆ°å–å®¶ä¸­å¿ƒæˆ–å…¶å®ƒç™»å½•æˆåŠŸä¿¡å·â€¨  // è‹¥é¡µé¢æ²¡è·³èµ°ï¼Œä¹Ÿä¸å¼ºè¡Œæ”¹åŠ¨ï¼Œè¶…æ—¶ç›´æ¥æŠ¥é”™â€¨  const reached = await page.waitForURL(/myseller\.taobao\.com/i, { timeout: 30000 }).then(â€¨    () => true,â€¨    () => falseâ€¨  );â€¨â€¨  if (!reached) {â€¨    console.error("ç™»å½•åæœªæ£€æµ‹åˆ°è·³è½¬åˆ° myseller.taobao.comï¼Œè¯·äººå·¥æ ¸æŸ¥ã€‚");â€¨    await browser.close();â€¨    process.exit(4);â€¨  }â€¨â€¨  // æˆåŠŸï¼šä¿å­˜ç¼“å­˜å¹¶é€€å‡ºâ€¨  await ctx.storageState({ path: STORAGE });â€¨  console.log("ç™»å½•æˆåŠŸï¼Œç¼“å­˜å·²ä¿å­˜ï¼š", STORAGE);â€¨  await browser.close();â€¨  process.exit(0);â€¨}â€¨â€¨run().catch(async (e) => {â€¨  console.error("ç™»å½•æµç¨‹å¼‚å¸¸ï¼š", e?.message ?? e);â€¨  process.exit(99);â€¨});â€¨3) ä½¿ç”¨æ–¹å¼â€¨npm iâ€¨npm run buildâ€¨# é¦–æ¬¡æˆ–é€€å‡ºåéœ€è¦ç™»å½•ï¼šâ€¨npm run login   # æŒ‰æç¤ºæ“ä½œâ€¨æˆåŠŸåä¼šç”Ÿæˆ storageState.jsonï¼Œåç»­ä½ çš„å…¶ä»–è„šæœ¬éƒ½ç”¨è¿™ä¸ªç¼“å­˜ï¼šâ€¨const ctx = await browser.newContext({ storageState: "./storageState.json" });â€¨è‹¥å‘½ä¸­â€œå‘å³æ»‘åŠ¨éªŒè¯â€ï¼Œè„šæœ¬ä¼šåœæ­¢è‡ªåŠ¨åŒ–å¹¶ç•™åœ¨é¡µé¢ï¼Œä½ å¯æ‰«ç /æ‰‹åŠ¨éªŒè¯ã€‚éªŒè¯å®Œæˆåè¦ä¹ˆæŒ‰ Ctrl+C ç»“æŸï¼ˆä¼šä¿å­˜ç¼“å­˜ï¼‰ï¼Œè¦ä¹ˆè„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹ç™»å½•æˆåŠŸå¹¶ä¿å­˜åé€€å‡ºï¼ˆé€€å‡ºç  10ï¼‰ã€‚â€¨â€¨// åœ¨æ»‘å—æ£€æµ‹åæ·»åŠ è¶…æ—¶ä¿æŠ¤â€¨const MAX_WAIT_TIME = 5 * 60 * 1000; // 5åˆ†é’Ÿâ€¨const startTime = Date.now();â€¨â€¨for (;;) {â€¨  if (Date.now() - startTime > MAX_WAIT_TIME) {â€¨    console.error("ç­‰å¾…äººå·¥å¤„ç†è¶…æ—¶(5åˆ†é’Ÿ)ï¼Œè¯·é‡æ–°è¿è¡Œè„šæœ¬");â€¨    await browser.close();â€¨    process.exit(11);â€¨  }â€¨  // ... åŸæœ‰æ£€æµ‹é€»è¾‘â€¨}

3ã€ç‚¹å‡»å•†å“-ç´ æåº“-å›¾ç‰‡ä¸Šä¼ 
Plain Textâ€¨typescriptâ€¨import { Page, FrameLocator } from '@playwright/test';â€¨â€¨/**â€¨ * æ ¹æ®é¢œè‰²æ•°é‡ç”Ÿæˆè¦ä¸Šä¼ çš„æ–‡ä»¶ååˆ—è¡¨â€¨ * @param productId - å•†å“IDï¼ˆå¦‚ C25215201ï¼‰â€¨ * @param colorCount - é¢œè‰²æ•°é‡â€¨ */â€¨function getUploadFileNames(productId: string, colorCount: number): string[] {â€¨  const fileNames: string[] = [];â€¨  â€¨  if (colorCount === 1) {â€¨    // 1ä¸ªé¢œè‰²ï¼šä¸Šä¼ color_1çš„å‰5å¼ â€¨    for (let i = 1; i <= 5; i++) {â€¨      fileNames.push(`${productId}_1-${String(i).padStart(2, '0')}.jpg`);â€¨    }â€¨  } â€¨  else if (colorCount === 2) {â€¨    // 2ä¸ªé¢œè‰²ï¼šcolor_1å‰3å¼  + color_2å‰2å¼ â€¨    fileNames.push(`${productId}_1-01.jpg`);â€¨    fileNames.push(`${productId}_1-02.jpg`);â€¨    fileNames.push(`${productId}_1-03.jpg`);â€¨    fileNames.push(`${productId}_2-01.jpg`);â€¨    fileNames.push(`${productId}_2-02.jpg`);â€¨  } â€¨  else if (colorCount === 3) {â€¨    // 3ä¸ªé¢œè‰²ï¼šcolor_1å‰2å¼  + color_2å‰2å¼  + color_3ç¬¬1å¼ â€¨    fileNames.push(`${productId}_1-01.jpg`);â€¨    fileNames.push(`${productId}_1-02.jpg`);â€¨    fileNames.push(`${productId}_2-01.jpg`);â€¨    fileNames.push(`${productId}_2-02.jpg`);â€¨    fileNames.push(`${productId}_3-01.jpg`);â€¨  } â€¨  else if (colorCount === 4) {â€¨    // 4ä¸ªé¢œè‰²ï¼šcolor_1å‰2å¼  + color_2ã€3ã€4å„1å¼ â€¨    fileNames.push(`${productId}_1-01.jpg`);â€¨    fileNames.push(`${productId}_1-02.jpg`);â€¨    fileNames.push(`${productId}_2-01.jpg`);â€¨    fileNames.push(`${productId}_3-01.jpg`);â€¨    fileNames.push(`${productId}_4-01.jpg`);â€¨  } â€¨  else {â€¨    // 5ä¸ªæˆ–ä»¥ä¸Šé¢œè‰²ï¼šæ¯ä¸ªé¢œè‰²å„å–ç¬¬1å¼ â€¨    fileNames.push(`${productId}_1-01.jpg`);â€¨    fileNames.push(`${productId}_2-01.jpg`);â€¨    fileNames.push(`${productId}_3-01.jpg`);â€¨    fileNames.push(`${productId}_4-01.jpg`);â€¨    fileNames.push(`${productId}_5-01.jpg`);â€¨  }â€¨  â€¨  return fileNames;â€¨}â€¨â€¨/**â€¨ * ç”Ÿæˆé™çº§æ–‡ä»¶ååˆ—è¡¨ï¼ˆæ‰¾ä¸åˆ°åŸæ–‡ä»¶æ—¶å°è¯•ï¼‰â€¨ * @param originalFileName - åŸå§‹æ–‡ä»¶åï¼ˆå¦‚ C25215201_2-01.jpgï¼‰â€¨ * @param productId - å•†å“IDâ€¨ * @param colorCount - é¢œè‰²æ•°é‡â€¨ */â€¨function getFallbackFileNames(â€¨  originalFileName: string, â€¨  productId: string, â€¨  colorCount: numberâ€¨): string[] {â€¨  const fallbacks: string[] = [];â€¨  â€¨  // è§£æåŸå§‹æ–‡ä»¶åï¼šC25215201_2-01.jpg â†’ é¢œè‰²2ï¼Œå›¾ç‰‡01â€¨  const match = originalFileName.match(/_(\d+)-(\d+)\.jpg$/);â€¨  if (!match) return fallbacks;â€¨  â€¨  const colorNum = parseInt(match[1]);â€¨  const imageNum = parseInt(match[2]);â€¨  â€¨  // ç­–ç•¥1ï¼šåŒé¢œè‰²çš„å…¶ä»–å›¾ç‰‡ï¼ˆ01â†’02, 02â†’03, 03â†’01ï¼‰â€¨  const nextImageNum = (imageNum % 6) + 1; // å¾ªç¯1-6â€¨  fallbacks.push(`${productId}_${colorNum}-${String(nextImageNum).padStart(2, '0')}.jpg`);â€¨  â€¨  // ç­–ç•¥2ï¼šä¸‹ä¸€ä¸ªé¢œè‰²çš„ç¬¬ä¸€å¼ â€¨  if (colorNum < colorCount) {â€¨    fallbacks.push(`${productId}_${colorNum + 1}-01.jpg`);â€¨  }â€¨  â€¨  // ç­–ç•¥3ï¼šç¬¬ä¸€ä¸ªé¢œè‰²çš„ç¬¬ä¸€å¼ ï¼ˆå…œåº•ï¼‰â€¨  if (colorNum !== 1) {â€¨    fallbacks.push(`${productId}_1-01.jpg`);â€¨  }â€¨  â€¨  return fallbacks;â€¨}â€¨â€¨/**â€¨ * æœç´¢å¹¶ç‚¹å‡»å›¾ç‰‡ï¼ˆæ”¯æŒé™çº§ï¼‰â€¨ * @param frame - iframeâ€¨ * @param page1 - ä¸»é¡µé¢â€¨ * @param fileName - è¦æœç´¢çš„æ–‡ä»¶åâ€¨ * @param productId - å•†å“IDâ€¨ * @param colorCount - é¢œè‰²æ•°é‡â€¨ */â€¨async function searchAndClickImage(â€¨  frame: FrameLocator,â€¨  page1: Page,â€¨  fileName: string,â€¨  productId: string,â€¨  colorCount: numberâ€¨): Promise<boolean> {â€¨  â€¨  const filesToTry = [fileName, ...getFallbackFileNames(fileName, productId, colorCount)];â€¨  â€¨  for (let i = 0; i < filesToTry.length; i++) {â€¨    const currentFile = filesToTry[i];â€¨    â€¨    try {â€¨      console.log(`    å°è¯•æœç´¢: ${currentFile}`);â€¨      â€¨      // ç‚¹å‡»æœç´¢æ¡†â€¨      await frame.getByRole('searchbox', { name: 'æœç´¢' }).click();â€¨      await page1.waitForTimeout(300);â€¨      â€¨      // æ¸…ç©ºå¹¶è¾“å…¥æ–‡ä»¶åâ€¨      await frame.getByRole('searchbox', { name: 'æœç´¢' }).clear();â€¨      await frame.getByRole('searchbox', { name: 'æœç´¢' }).fill(currentFile);â€¨      await page1.waitForTimeout(500);â€¨      â€¨      // ç‚¹å‡»æœç´¢æŒ‰é’®â€¨      await frame.getByRole('button', { name: 'æœç´¢' }).click();â€¨      await page1.waitForTimeout(1500);â€¨      â€¨      // æ£€æŸ¥æ˜¯å¦æœ‰æœç´¢ç»“æœâ€¨      const firstImage = frame.locator('.PicList_hoverBK__zH1fy').first();â€¨      const hasResult = await firstImage.isVisible({ timeout: 2000 }).catch(() => false);â€¨      â€¨      if (hasResult) {â€¨        // æ‰¾åˆ°äº†ï¼Œç‚¹å‡»â€¨        await firstImage.click();â€¨        await page1.waitForTimeout(1000);â€¨        console.log(`    âœ… æˆåŠŸï¼ˆä½¿ç”¨${i === 0 ? 'åŸæ–‡ä»¶' : 'é™çº§æ–‡ä»¶' + i}ï¼‰`);â€¨        return true;â€¨      }â€¨      â€¨      console.log(`    âš ï¸  æœªæ‰¾åˆ° ${currentFile}`);â€¨      â€¨    } catch (e) {â€¨      console.log(`    âŒ æœç´¢å¼‚å¸¸: ${currentFile}`);â€¨    }â€¨  }â€¨  â€¨  console.log(`    âŒ æ‰€æœ‰é™çº§æ–¹æ¡ˆéƒ½å¤±è´¥`);â€¨  return false;â€¨}â€¨â€¨/**â€¨ * ä¸Šä¼ å•†å“å›¾ç‰‡ä¸»æµç¨‹â€¨ * @param page1 - å‘å¸ƒé¡µé¢â€¨ * @param productId - å•†å“IDï¼ˆå¦‚ C25215201ï¼‰â€¨ * @param colorCount - é¢œè‰²æ•°é‡ï¼ˆä»é£ä¹¦è·å–ï¼‰â€¨ */â€¨async function uploadProductImages(â€¨  page1: Page,â€¨  productId: string,â€¨  colorCount: numberâ€¨): Promise<void> {â€¨  â€¨  console.log('\n========== å¼€å§‹ä¸Šä¼ å•†å“å›¾ç‰‡ ==========');â€¨  console.log(`å•†å“ID: ${productId}`);â€¨  console.log(`é¢œè‰²æ•°é‡: ${colorCount}`);â€¨  â€¨  try {â€¨    // ==================== æ­¥éª¤5ï¼šç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æŒ‰é’® ====================â€¨    console.log('\n[æ­¥éª¤5] ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æŒ‰é’®');â€¨    await page1.locator('div').filter({ hasText: /^ä¸Šä¼ å›¾ç‰‡$/ }).nth(3).click();â€¨    await page1.waitForTimeout(1500);â€¨    â€¨    // ==================== æ­¥éª¤6ï¼šè·å–iframeå¹¶ç­‰å¾…åŠ è½½ ====================â€¨    console.log('\n[æ­¥éª¤6] è·å–å›¾ç‰‡ä¸Šä¼ iframe');â€¨    const frameLocator = page1.locator('#mainImagesGroup');â€¨    const frame = frameLocator.contentFrame();â€¨    â€¨    // ç­‰å¾…iframeåŠ è½½å®Œæˆâ€¨    console.log('  ç­‰å¾…iframeåŠ è½½...');â€¨    await frame.waitForSelector('[role="combobox"]', { timeout: 10000 });â€¨    await page1.waitForTimeout(1000);â€¨    console.log('  âœ… iframeåŠ è½½å®Œæˆ');â€¨    â€¨    // ç‚¹å‡»æ–‡ä»¶å¤¹è¾“å…¥æ¡†â€¨    console.log('  æ‰“å¼€æ–‡ä»¶å¤¹é€‰æ‹©æ¡†');â€¨    await frame.getByRole('combobox', { name: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°' }).click();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    // ==================== æ­¥éª¤7ï¼šè¾“å…¥å•†å“ID ====================â€¨    console.log(`\n[æ­¥éª¤7] è¾“å…¥å•†å“ID: ${productId}`);â€¨    await frame.getByRole('combobox', { name: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°' }).fill(productId);â€¨    await page1.waitForTimeout(1000);â€¨    â€¨    // ==================== æ­¥éª¤8ï¼šç‚¹å‡»ç¬¬ä¸€ä¸ªæ–‡ä»¶å¤¹ ====================â€¨    console.log('\n[æ­¥éª¤8] ç‚¹å‡»ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ–‡ä»¶å¤¹');â€¨    await frame.locator('.next-menu-item-inner').first().click();â€¨    await page1.waitForTimeout(2000);â€¨    â€¨    // ==================== æ­¥éª¤9ï¼šç”Ÿæˆæ–‡ä»¶ååˆ—è¡¨ ====================â€¨    console.log('\n[æ­¥éª¤9] ç”Ÿæˆæ–‡ä»¶ååˆ—è¡¨');â€¨    const fileNames = getUploadFileNames(productId, colorCount);â€¨    console.log(`  å°†ä¸Šä¼ : ${fileNames.join(', ')}`);â€¨    â€¨    // ==================== æ­¥éª¤10ï¼šå¾ªç¯ä¸Šä¼ 5å¼ å›¾ç‰‡ ====================â€¨    console.log('\n[æ­¥éª¤10] å¼€å§‹å¾ªç¯ä¸Šä¼ å›¾ç‰‡');â€¨    â€¨    let successCount = 0;â€¨    â€¨    for (let i = 0; i < fileNames.length; i++) {â€¨      const fileName = fileNames[i];â€¨      console.log(`\n  â†’ ä¸Šä¼ ç¬¬${i + 1}/5å¼ : ${fileName}`);â€¨      â€¨      const success = await searchAndClickImage(frame, page1, fileName, productId, colorCount);â€¨      â€¨      if (success) {â€¨        successCount++;â€¨      } else {â€¨        console.log(`  âš ï¸  ç¬¬${i + 1}å¼ ä¸Šä¼ å¤±è´¥ï¼Œç»§ç»­ä¸‹ä¸€å¼ `);â€¨      }â€¨    }â€¨    â€¨    console.log(`\n  ğŸ“Š ä¸Šä¼ ç»Ÿè®¡: æˆåŠŸ${successCount}/5å¼ `);â€¨    â€¨    // ==================== æ­¥éª¤11ï¼šç­‰å¾…ä¸Šä¼ å®Œæˆ ====================â€¨    console.log('\n[æ­¥éª¤11] ç­‰å¾…ä¸Šä¼ å¤„ç†å®Œæˆ');â€¨    await page1.waitForTimeout(2000);â€¨    â€¨    // ==================== æ­¥éª¤12ï¼šæ£€æŸ¥æ˜¯å¦è¿˜éœ€è¦ä¸Šä¼  ====================â€¨    console.log('\n[æ­¥éª¤12] æ£€æŸ¥æ˜¯å¦è¿˜éœ€è¦ä¸Šä¼ æ›´å¤šå›¾ç‰‡');â€¨    â€¨    const needMoreUpload = await page1.locator('div').filter({ â€¨      hasText: /é€‰æ‹©å›¾ç‰‡.*æ¯”ä¾‹.*1:1/ â€¨    }).nth(2).isVisible({ timeout: 2000 }).catch(() => false);â€¨    â€¨    // ==================== æ­¥éª¤13ï¼šæ ¹æ®ç»“æœæ‰§è¡Œæ“ä½œ ====================â€¨    if (needMoreUpload) {â€¨      console.log('[æ­¥éª¤13] âš ï¸ è¿˜éœ€è¦ä¸Šä¼ ï¼Œç‚¹å‡»å•†å“å±æ€§ç»§ç»­');â€¨      await page1.getByText(/å•†å“å±æ€§.*è¶Šæ—©å¡«å†™/).click();â€¨      await page1.waitForTimeout(1000);â€¨    } else {â€¨      console.log('[æ­¥éª¤13] âœ… ä¸Šä¼ å®Œæˆ');â€¨    }â€¨    â€¨    console.log('\n========== å•†å“å›¾ç‰‡ä¸Šä¼ å®Œæˆ ==========\n');â€¨    â€¨  } catch (error) {â€¨    console.error('\nâŒ ä¸Šä¼ å¤±è´¥:', error);â€¨    await page1.screenshot({ path: 'upload_error.png', fullPage: true });â€¨    throw error;â€¨  }â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹ï¼šå®Œæ•´çš„å›¾ç‰‡ä¸Šä¼ æµç¨‹â€¨ */â€¨async function example(page: Page) {â€¨  // æ­¥éª¤1-4ï¼šè¿›å…¥å‘å¸ƒé¡µé¢â€¨  await page.getByRole('button', { name: 'å•†å“' }).click();â€¨  await page.waitForTimeout(1000);â€¨  â€¨  await page.getByRole('link', { name: 'æˆ‘çš„å•†å“' }).click();â€¨  await page.waitForTimeout(1500);â€¨  â€¨  await page.getByRole('link', { name: 'å‘å¸ƒç›¸ä¼¼å“' }).first().click();â€¨  â€¨  const page1 = await page.waitForEvent('popup');â€¨  await page1.waitForLoadState('networkidle');â€¨  await page1.waitForTimeout(2000);â€¨  â€¨  // ä»é£ä¹¦è·å–æ•°æ®â€¨  const productData = {â€¨    productId: 'C25215201',â€¨    colorCount: 3  // ä»é£ä¹¦"é¢œè‰²æ•°é‡"å­—æ®µè·å–â€¨  };â€¨  â€¨  // æ‰§è¡Œå›¾ç‰‡ä¸Šä¼ â€¨  await uploadProductImages(page1, productData.productId, productData.colorCount);â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { uploadProductImages, getUploadFileNames };â€¨å…³é”®æ”¹è¿›â€¨1. æ–°çš„æ–‡ä»¶å‘½åè§„åˆ™â€¨typescriptâ€¨// æ—§è§„åˆ™ï¼šcolor_0-01.jpgâ€¨// æ–°è§„åˆ™ï¼šC25215201_1-01.jpgâ€¨â€¨fileNames.push(`${productId}_1-01.jpg`);â€¨fileNames.push(`${productId}_2-01.jpg`);â€¨2. é™çº§ç­–ç•¥ï¼ˆæ‰¾ä¸åˆ°æ–‡ä»¶æ—¶ï¼‰â€¨typescriptâ€¨åŸæ–‡ä»¶: C25215201_2-01.jpgâ€¨  â†“ å¤±è´¥â€¨é™çº§1: C25215201_2-02.jpg  // åŒé¢œè‰²ä¸‹ä¸€å¼ â€¨  â†“ å¤±è´¥â€¨é™çº§2: C25215201_3-01.jpg  // ä¸‹ä¸€ä¸ªé¢œè‰²ç¬¬ä¸€å¼ â€¨  â†“ å¤±è´¥â€¨é™çº§3: C25215201_1-01.jpg  // ç¬¬ä¸€ä¸ªé¢œè‰²ç¬¬ä¸€å¼ ï¼ˆå…œåº•ï¼‰â€¨3. ç­‰å¾…iframeåŠ è½½â€¨typescriptâ€¨const frame = frameLocator.contentFrame();â€¨await frame.waitForSelector('[role="combobox"]', { timeout: 10000 });â€¨4. ä½¿ç”¨æ­£åˆ™å®½æ¾åŒ¹é…â€¨typescriptâ€¨// æ£€æŸ¥æç¤ºï¼ˆå®½æ¾åŒ¹é…ï¼‰â€¨hasText: /é€‰æ‹©å›¾ç‰‡.*æ¯”ä¾‹.*1:1/â€¨â€¨// å•†å“å±æ€§æŒ‰é’®ï¼ˆå®½æ¾åŒ¹é…ï¼‰â€¨getByText(/å•†å“å±æ€§.*è¶Šæ—©å¡«å†™/)â€¨```â€¨â€¨## æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹â€¨```â€¨========== å¼€å§‹ä¸Šä¼ å•†å“å›¾ç‰‡ ==========â€¨å•†å“ID: C25215201â€¨é¢œè‰²æ•°é‡: 3â€¨â€¨[æ­¥éª¤5] ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æŒ‰é’®â€¨â€¨[æ­¥éª¤6] è·å–å›¾ç‰‡ä¸Šä¼ iframeâ€¨  ç­‰å¾…iframeåŠ è½½...â€¨  âœ… iframeåŠ è½½å®Œæˆâ€¨  æ‰“å¼€æ–‡ä»¶å¤¹é€‰æ‹©æ¡†â€¨â€¨[æ­¥éª¤7] è¾“å…¥å•†å“ID: C25215201â€¨â€¨[æ­¥éª¤8] ç‚¹å‡»ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ–‡ä»¶å¤¹â€¨â€¨[æ­¥éª¤9] ç”Ÿæˆæ–‡ä»¶ååˆ—è¡¨â€¨  å°†ä¸Šä¼ : C25215201_1-01.jpg, C25215201_1-02.jpg, C25215201_2-01.jpg, C25215201_2-02.jpg, C25215201_3-01.jpgâ€¨â€¨[æ­¥éª¤10] å¼€å§‹å¾ªç¯ä¸Šä¼ å›¾ç‰‡â€¨â€¨  â†’ ä¸Šä¼ ç¬¬1/5å¼ : C25215201_1-01.jpgâ€¨    å°è¯•æœç´¢: C25215201_1-01.jpgâ€¨    âœ… æˆåŠŸï¼ˆä½¿ç”¨åŸæ–‡ä»¶ï¼‰â€¨â€¨  â†’ ä¸Šä¼ ç¬¬2/5å¼ : C25215201_1-02.jpgâ€¨    å°è¯•æœç´¢: C25215201_1-02.jpgâ€¨    âœ… æˆåŠŸï¼ˆä½¿ç”¨åŸæ–‡ä»¶ï¼‰â€¨â€¨  â†’ ä¸Šä¼ ç¬¬3/5å¼ : C25215201_2-01.jpgâ€¨    å°è¯•æœç´¢: C25215201_2-01.jpgâ€¨    âš ï¸  æœªæ‰¾åˆ° C25215201_2-01.jpgâ€¨    å°è¯•æœç´¢: C25215201_2-02.jpgâ€¨    âœ… æˆåŠŸï¼ˆä½¿ç”¨é™çº§æ–‡ä»¶1ï¼‰â€¨â€¨  â†’ ä¸Šä¼ ç¬¬4/5å¼ : C25215201_2-02.jpgâ€¨    å°è¯•æœç´¢: C25215201_2-02.jpgâ€¨    âœ… æˆåŠŸï¼ˆä½¿ç”¨åŸæ–‡ä»¶ï¼‰â€¨â€¨  â†’ ä¸Šä¼ ç¬¬5/5å¼ : C25215201_3-01.jpgâ€¨    å°è¯•æœç´¢: C25215201_3-01.jpgâ€¨    âœ… æˆåŠŸï¼ˆä½¿ç”¨åŸæ–‡ä»¶ï¼‰â€¨â€¨  ğŸ“Š ä¸Šä¼ ç»Ÿè®¡: æˆåŠŸ5/5å¼ â€¨â€¨[æ­¥éª¤11] ç­‰å¾…ä¸Šä¼ å¤„ç†å®Œæˆâ€¨â€¨[æ­¥éª¤12] æ£€æŸ¥æ˜¯å¦è¿˜éœ€è¦ä¸Šä¼ æ›´å¤šå›¾ç‰‡â€¨â€¨[æ­¥éª¤13] âœ… ä¸Šä¼ å®Œæˆâ€¨â€¨========== å•†å“å›¾ç‰‡ä¸Šä¼ å®Œæˆ ==========â€¨å…³é”®ç‰¹æ€§â€¨âœ… æ–°å‘½åè§„åˆ™ï¼šå•†å“ID_é¢œè‰²-å›¾ç‰‡.jpgâ€¨ âœ… æ™ºèƒ½é™çº§ç­–ç•¥ï¼ˆ3å±‚é™çº§ï¼‰â€¨ âœ… ç­‰å¾…iframeåŠ è½½â€¨ âœ… æ­£åˆ™å®½æ¾åŒ¹é…æ–‡æœ¬â€¨ âœ… ç»Ÿè®¡ä¸Šä¼ æˆåŠŸç‡â€¨ âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†â€¨å®Œæ•´æ¸…æ™°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼
4ã€ç‚¹å‡»æ·˜å®-æˆ‘çš„å•†å“-ä¸Šä¼ å•†å“-é€‰æ‹©å‘å¸ƒç›¸ä¼¼å“ï¼Œä¸Šä¼ 1:1ä¸»å›¾
JavaScriptâ€¨typescriptâ€¨import { Page, FrameLocator } from '@playwright/test';â€¨â€¨/**â€¨ * æ ¹æ®é¢œè‰²æ•°é‡ç”Ÿæˆè¦ä¸Šä¼ çš„æ–‡ä»¶ååˆ—è¡¨â€¨ * @param productId - å•†å“IDï¼ˆå¦‚ C25217200ï¼‰â€¨ * @param colorCount - é¢œè‰²æ•°é‡â€¨ * @returns æ–‡ä»¶åæ•°ç»„â€¨ */â€¨function getUploadFileNames(productId: string, colorCount: number): string[] {â€¨  const fileNames: string[] = [];â€¨  â€¨  if (colorCount === 1) {â€¨    // 1ä¸ªé¢œè‰²ï¼šä¸Šä¼ ç¬¬1ä¸ªé¢œè‰²çš„å‰5å¼ â€¨    for (let i = 1; i <= 5; i++) {â€¨      fileNames.push(`${productId}_1-${String(i).padStart(2, '0')}.jpg`);â€¨    }â€¨  } â€¨  else if (colorCount === 2) {â€¨    // 2ä¸ªé¢œè‰²ï¼šç¬¬1ä¸ªé¢œè‰²å‰3å¼  + ç¬¬2ä¸ªé¢œè‰²å‰2å¼ â€¨    fileNames.push(`${productId}_1-01.jpg`);â€¨    fileNames.push(`${productId}_1-02.jpg`);â€¨    fileNames.push(`${productId}_1-03.jpg`);â€¨    fileNames.push(`${productId}_2-01.jpg`);â€¨    fileNames.push(`${productId}_2-02.jpg`);â€¨  } â€¨  else if (colorCount === 3) {â€¨    // 3ä¸ªé¢œè‰²ï¼šç¬¬1ä¸ªé¢œè‰²å‰2å¼  + ç¬¬2ä¸ªé¢œè‰²å‰2å¼  + ç¬¬3ä¸ªé¢œè‰²ç¬¬1å¼ â€¨    fileNames.push(`${productId}_1-01.jpg`);â€¨    fileNames.push(`${productId}_1-02.jpg`);â€¨    fileNames.push(`${productId}_2-01.jpg`);â€¨    fileNames.push(`${productId}_2-02.jpg`);â€¨    fileNames.push(`${productId}_3-01.jpg`);â€¨  } â€¨  else if (colorCount === 4) {â€¨    // 4ä¸ªé¢œè‰²ï¼šç¬¬1ä¸ªé¢œè‰²å‰2å¼  + ç¬¬2ã€3ã€4ä¸ªé¢œè‰²å„1å¼ â€¨    fileNames.push(`${productId}_1-01.jpg`);â€¨    fileNames.push(`${productId}_1-02.jpg`);â€¨    fileNames.push(`${productId}_2-01.jpg`);â€¨    fileNames.push(`${productId}_3-01.jpg`);â€¨    fileNames.push(`${productId}_4-01.jpg`);â€¨  } â€¨  else {â€¨    // 5ä¸ªæˆ–ä»¥ä¸Šé¢œè‰²ï¼šæ¯ä¸ªé¢œè‰²å„å–ç¬¬1å¼ â€¨    fileNames.push(`${productId}_1-01.jpg`);â€¨    fileNames.push(`${productId}_2-01.jpg`);â€¨    fileNames.push(`${productId}_3-01.jpg`);â€¨    fileNames.push(`${productId}_4-01.jpg`);â€¨    fileNames.push(`${productId}_5-01.jpg`);â€¨  }â€¨  â€¨  return fileNames;â€¨}â€¨â€¨/**â€¨ * ç”Ÿæˆé™çº§æ–‡ä»¶ååˆ—è¡¨ï¼ˆæ‰¾ä¸åˆ°åŸæ–‡ä»¶æ—¶å°è¯•ï¼‰â€¨ * @param originalFileName - åŸå§‹æ–‡ä»¶åï¼ˆå¦‚ C25217200_2-01.jpgï¼‰â€¨ * @param productId - å•†å“IDâ€¨ * @param colorCount - é¢œè‰²æ•°é‡â€¨ * @returns é™çº§æ–‡ä»¶åæ•°ç»„â€¨ */â€¨function getFallbackFileNames(â€¨  originalFileName: string, â€¨  productId: string, â€¨  colorCount: numberâ€¨): string[] {â€¨  const fallbacks: string[] = [];â€¨  â€¨  // è§£æåŸå§‹æ–‡ä»¶åï¼šC25217200_2-01.jpg â†’ é¢œè‰²2ï¼Œå›¾ç‰‡01â€¨  const match = originalFileName.match(/_(\d+)-(\d+)\.jpg$/);â€¨  if (!match) return fallbacks;â€¨  â€¨  const colorNum = parseInt(match[1]);â€¨  const imageNum = parseInt(match[2]);â€¨  â€¨  // ç­–ç•¥1ï¼šåŒé¢œè‰²çš„ä¸‹ä¸€å¼ å›¾ç‰‡ï¼ˆ01â†’02, 02â†’03, 03â†’04...ï¼‰â€¨  const nextImageNum = (imageNum % 6) + 1; // å¾ªç¯1-6â€¨  fallbacks.push(`${productId}_${colorNum}-${String(nextImageNum).padStart(2, '0')}.jpg`);â€¨  â€¨  // ç­–ç•¥2ï¼šä¸‹ä¸€ä¸ªé¢œè‰²çš„ç¬¬ä¸€å¼ â€¨  if (colorNum < colorCount) {â€¨    fallbacks.push(`${productId}_${colorNum + 1}-01.jpg`);â€¨  }â€¨  â€¨  // ç­–ç•¥3ï¼šç¬¬ä¸€ä¸ªé¢œè‰²çš„ç¬¬ä¸€å¼ ï¼ˆå…œåº•ï¼‰â€¨  if (colorNum !== 1) {â€¨    fallbacks.push(`${productId}_1-01.jpg`);â€¨  }â€¨  â€¨  return fallbacks;â€¨}â€¨â€¨/**â€¨ * æœç´¢å¹¶ç‚¹å‡»å›¾ç‰‡ï¼ˆæ”¯æŒé™çº§ï¼‰â€¨ * @param frame - iframeâ€¨ * @param page1 - ä¸»é¡µé¢â€¨ * @param fileName - è¦æœç´¢çš„æ–‡ä»¶åâ€¨ * @param productId - å•†å“IDâ€¨ * @param colorCount - é¢œè‰²æ•°é‡â€¨ * @returns æ˜¯å¦æˆåŠŸâ€¨ */â€¨async function searchAndClickImage(â€¨  frame: FrameLocator,â€¨  page1: Page,â€¨  fileName: string,â€¨  productId: string,â€¨  colorCount: numberâ€¨): Promise<boolean> {â€¨  â€¨  const filesToTry = [fileName, ...getFallbackFileNames(fileName, productId, colorCount)];â€¨  â€¨  for (let i = 0; i < filesToTry.length; i++) {â€¨    const currentFile = filesToTry[i];â€¨    â€¨    try {â€¨      console.log(`    å°è¯•æœç´¢: ${currentFile}`);â€¨      â€¨      // ç‚¹å‡»æœç´¢æ¡†â€¨      await frame.getByRole('searchbox', { name: 'æœç´¢' }).click();â€¨      await page1.waitForTimeout(300);â€¨      â€¨      // æ¸…ç©ºå¹¶è¾“å…¥æ–‡ä»¶åâ€¨      await frame.getByRole('searchbox', { name: 'æœç´¢' }).clear();â€¨      await frame.getByRole('searchbox', { name: 'æœç´¢' }).fill(currentFile);â€¨      await page1.waitForTimeout(500);â€¨      â€¨      // ç‚¹å‡»æœç´¢æŒ‰é’®â€¨      await frame.getByRole('button', { name: 'æœç´¢' }).click();â€¨      await page1.waitForTimeout(1500);â€¨      â€¨      // æ£€æŸ¥æ˜¯å¦æœ‰æœç´¢ç»“æœâ€¨      const firstImage = frame.locator('.PicList_hoverBK__zH1fy').first();â€¨      const hasResult = await firstImage.isVisible({ timeout: 2000 }).catch(() => false);â€¨      â€¨      if (hasResult) {â€¨        // æ‰¾åˆ°äº†ï¼Œç‚¹å‡»â€¨        await firstImage.click();â€¨        await page1.waitForTimeout(1000);â€¨        console.log(`    âœ… æˆåŠŸï¼ˆä½¿ç”¨${i === 0 ? 'åŸæ–‡ä»¶' : 'é™çº§æ–¹æ¡ˆ' + i}ï¼‰`);â€¨        return true;â€¨      }â€¨      â€¨      console.log(`    âš ï¸  æœªæ‰¾åˆ° ${currentFile}`);â€¨      â€¨    } catch (e) {â€¨      console.log(`    âŒ æœç´¢å¼‚å¸¸: ${currentFile}`);â€¨    }â€¨  }â€¨  â€¨  console.log(`    âŒ æ‰€æœ‰é™çº§æ–¹æ¡ˆéƒ½å¤±è´¥`);â€¨  return false;â€¨}â€¨â€¨/**â€¨ * ä¸Šä¼ å•†å“å›¾ç‰‡ä¸»æµç¨‹â€¨ * @param page1 - å‘å¸ƒé¡µé¢â€¨ * @param productId - å•†å“IDï¼ˆå¦‚ C25217200ï¼‰â€¨ * @param colorCount - é¢œè‰²æ•°é‡ï¼ˆä»é£ä¹¦è·å–ï¼‰â€¨ */â€¨async function uploadProductImages(â€¨  page1: Page,â€¨  productId: string,â€¨  colorCount: numberâ€¨): Promise<void> {â€¨  â€¨  console.log('\n========== å¼€å§‹ä¸Šä¼ å•†å“å›¾ç‰‡ ==========');â€¨  console.log(`å•†å“ID: ${productId}`);â€¨  console.log(`é¢œè‰²æ•°é‡: ${colorCount}`);â€¨  â€¨  try {â€¨    // ==================== æ­¥éª¤5ï¼šç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æŒ‰é’® ====================â€¨    console.log('\n[æ­¥éª¤5] ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æŒ‰é’®');â€¨    await page1.locator('div').filter({ hasText: /^ä¸Šä¼ å›¾ç‰‡$/ }).nth(3).click();â€¨    await page1.waitForTimeout(1500);â€¨    console.log('  âœ… ä¸Šä¼ å›¾ç‰‡æŒ‰é’®å·²ç‚¹å‡»');â€¨    â€¨    // ==================== æ­¥éª¤6ï¼šè·å–iframeå¹¶ç­‰å¾…åŠ è½½ ====================â€¨    console.log('\n[æ­¥éª¤6] è·å–å›¾ç‰‡ä¸Šä¼ iframe');â€¨    const frameLocator = page1.locator('#mainImagesGroup');â€¨    const frame = frameLocator.contentFrame();â€¨    â€¨    // ç­‰å¾…iframeåŠ è½½å®Œæˆâ€¨    console.log('  ç­‰å¾…iframeåŠ è½½...');â€¨    await frame.waitForSelector('[role="combobox"]', { timeout: 10000 });â€¨    await page1.waitForTimeout(1000);â€¨    console.log('  âœ… iframeåŠ è½½å®Œæˆ');â€¨    â€¨    // ç‚¹å‡»æ–‡ä»¶å¤¹è¾“å…¥æ¡†â€¨    console.log('  æ‰“å¼€æ–‡ä»¶å¤¹é€‰æ‹©æ¡†');â€¨    await frame.getByRole('combobox', { name: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°' }).click();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    // ==================== æ­¥éª¤7ï¼šè¾“å…¥å•†å“ID ====================â€¨    console.log(`\n[æ­¥éª¤7] è¾“å…¥å•†å“ID: ${productId}`);â€¨    await frame.getByRole('combobox', { name: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°' }).fill(productId);â€¨    await page1.waitForTimeout(1000);â€¨    console.log('  âœ… å•†å“IDå·²è¾“å…¥');â€¨    â€¨    // ==================== æ­¥éª¤8ï¼šç‚¹å‡»ç¬¬ä¸€ä¸ªæ–‡ä»¶å¤¹ ====================â€¨    console.log('\n[æ­¥éª¤8] ç‚¹å‡»ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ–‡ä»¶å¤¹');â€¨    await frame.locator('.next-menu-item-inner').first().click();â€¨    await page1.waitForTimeout(2000);â€¨    console.log('  âœ… å·²è¿›å…¥æ–‡ä»¶å¤¹');â€¨    â€¨    // ==================== æ­¥éª¤9ï¼šç”Ÿæˆæ–‡ä»¶ååˆ—è¡¨ ====================â€¨    console.log('\n[æ­¥éª¤9] ç”Ÿæˆæ–‡ä»¶ååˆ—è¡¨');â€¨    const fileNames = getUploadFileNames(productId, colorCount);â€¨    console.log(`  å°†ä¸Šä¼ : ${fileNames.join(', ')}`);â€¨    â€¨    // ==================== æ­¥éª¤10ï¼šå¾ªç¯ä¸Šä¼ 5å¼ å›¾ç‰‡ ====================â€¨    console.log('\n[æ­¥éª¤10] å¼€å§‹å¾ªç¯ä¸Šä¼ å›¾ç‰‡');â€¨    â€¨    let successCount = 0;â€¨    â€¨    for (let i = 0; i < fileNames.length; i++) {â€¨      const fileName = fileNames[i];â€¨      console.log(`\n  â†’ ä¸Šä¼ ç¬¬${i + 1}/${fileNames.length}å¼ : ${fileName}`);â€¨      â€¨      const success = await searchAndClickImage(frame, page1, fileName, productId, colorCount);â€¨      â€¨      if (success) {â€¨        successCount++;â€¨      } else {â€¨        console.log(`  âš ï¸  ç¬¬${i + 1}å¼ ä¸Šä¼ å¤±è´¥ï¼Œç»§ç»­ä¸‹ä¸€å¼ `);â€¨      }â€¨    }â€¨    â€¨    console.log(`\n  ğŸ“Š ä¸Šä¼ ç»Ÿè®¡: æˆåŠŸ${successCount}/${fileNames.length}å¼ `);â€¨    â€¨    // ==================== æ­¥éª¤11ï¼šç­‰å¾…ä¸Šä¼ å®Œæˆ ====================â€¨    console.log('\n[æ­¥éª¤11] ç­‰å¾…ä¸Šä¼ å¤„ç†å®Œæˆ');â€¨    await page1.waitForTimeout(2000);â€¨    â€¨    // ==================== æ­¥éª¤12ï¼šæ£€æŸ¥æ˜¯å¦è¿˜éœ€è¦ä¸Šä¼  ====================â€¨    console.log('\n[æ­¥éª¤12] æ£€æŸ¥æ˜¯å¦è¿˜éœ€è¦ä¸Šä¼ æ›´å¤šå›¾ç‰‡');â€¨    â€¨    const needMoreUpload = await page1.locator('div').filter({ â€¨      hasText: /é€‰æ‹©å›¾ç‰‡.*æ¯”ä¾‹.*1:1/ â€¨    }).nth(2).isVisible({ timeout: 2000 }).catch(() => false);â€¨    â€¨    // ==================== æ­¥éª¤13ï¼šæ ¹æ®ç»“æœæ‰§è¡Œæ“ä½œ ====================â€¨    if (needMoreUpload) {â€¨      console.log('[æ­¥éª¤13] âš ï¸ è¿˜éœ€è¦ä¸Šä¼ ï¼Œç‚¹å‡»å•†å“å±æ€§ç»§ç»­');â€¨      await page1.getByText(/å•†å“å±æ€§.*è¶Šæ—©å¡«å†™/).click();â€¨      await page1.waitForTimeout(1000);â€¨    } else {â€¨      console.log('[æ­¥éª¤13] âœ… ä¸Šä¼ å®Œæˆ');â€¨    }â€¨    â€¨    console.log('\n========== å•†å“å›¾ç‰‡ä¸Šä¼ å®Œæˆ ==========\n');â€¨    â€¨  } catch (error) {â€¨    console.error('\nâŒ ä¸Šä¼ å¤±è´¥:', error);â€¨    await page1.screenshot({ path: `upload_error_${productId}.png`, fullPage: true });â€¨    throw error;â€¨  }â€¨}â€¨â€¨/**â€¨ * è¿›å…¥å‘å¸ƒé¡µé¢ï¼ˆæ­¥éª¤1-4ï¼‰â€¨ * @param page - ä¸»é¡µé¢â€¨ * @returns å‘å¸ƒé¡µé¢ï¼ˆæ–°æ‰“å¼€çš„page1ï¼‰â€¨ */â€¨async function enterPublishPage(page: Page): Promise<Page> {â€¨  console.log('\n========== è¿›å…¥å‘å¸ƒé¡µé¢ ==========');â€¨  â€¨  // æ­¥éª¤1ï¼šç‚¹å‡»å•†å“æŒ‰é’®â€¨  console.log('\n[æ­¥éª¤1] ç‚¹å‡»å•†å“æŒ‰é’®');â€¨  await page.getByRole('button', { name: 'å•†å“' }).click();â€¨  await page.waitForTimeout(1000);â€¨  console.log('  âœ… å•†å“æŒ‰é’®å·²ç‚¹å‡»');â€¨  â€¨  // æ­¥éª¤2ï¼šç‚¹å‡»æˆ‘çš„å•†å“â€¨  console.log('\n[æ­¥éª¤2] ç‚¹å‡»æˆ‘çš„å•†å“');â€¨  await page.getByRole('link', { name: 'æˆ‘çš„å•†å“' }).click();â€¨  await page.waitForTimeout(1500);â€¨  console.log('  âœ… æˆ‘çš„å•†å“é¡µé¢å·²æ‰“å¼€');â€¨  â€¨  // æ­¥éª¤3ï¼šç‚¹å‡»å‘å¸ƒç›¸ä¼¼å“â€¨  console.log('\n[æ­¥éª¤3] ç‚¹å‡»ç¬¬ä¸€ä¸ª"å‘å¸ƒç›¸ä¼¼å“"');â€¨  await page.getByRole('link', { name: 'å‘å¸ƒç›¸ä¼¼å“' }).first().click();â€¨  â€¨  // æ­¥éª¤4ï¼šç­‰å¾…æ–°é¡µé¢æ‰“å¼€â€¨  console.log('\n[æ­¥éª¤4] ç­‰å¾…æ–°é¡µé¢æ‰“å¼€');â€¨  const page1 = await page.waitForEvent('popup');â€¨  await page1.waitForLoadState('networkidle');â€¨  await page1.waitForTimeout(2000);â€¨  console.log(`  âœ… æ–°é¡µé¢å·²æ‰“å¼€: ${page1.url()}`);â€¨  â€¨  console.log('\n========== æˆåŠŸè¿›å…¥å‘å¸ƒé¡µé¢ ==========\n');â€¨  â€¨  return page1;â€¨}â€¨â€¨/**â€¨ * å®Œæ•´çš„å›¾ç‰‡ä¸Šä¼ æµç¨‹ï¼ˆæ­¥éª¤1-13ï¼‰â€¨ * @param page - ä¸»é¡µé¢â€¨ * @param productId - å•†å“IDâ€¨ * @param colorCount - é¢œè‰²æ•°é‡â€¨ */â€¨async function completeUploadFlow(â€¨  page: Page,â€¨  productId: string,â€¨  colorCount: numberâ€¨): Promise<void> {â€¨  â€¨  console.log('\nğŸš€ å¼€å§‹å®Œæ•´çš„å›¾ç‰‡ä¸Šä¼ æµç¨‹');â€¨  console.log(`å•†å“ID: ${productId}`);â€¨  console.log(`é¢œè‰²æ•°é‡: ${colorCount}`);â€¨  â€¨  try {â€¨    // æ­¥éª¤1-4ï¼šè¿›å…¥å‘å¸ƒé¡µé¢â€¨    const page1 = await enterPublishPage(page);â€¨    â€¨    // æ­¥éª¤5-13ï¼šä¸Šä¼ å›¾ç‰‡â€¨    await uploadProductImages(page1, productId, colorCount);â€¨    â€¨    console.log('\nğŸ‰ å®Œæ•´æµç¨‹æ‰§è¡ŒæˆåŠŸï¼');â€¨    â€¨  } catch (error) {â€¨    console.error('\nâŒ æµç¨‹æ‰§è¡Œå¤±è´¥:', error);â€¨    throw error;â€¨  }â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹1ï¼šå®Œæ•´æµç¨‹â€¨ */â€¨async function example1(page: Page) {â€¨  await completeUploadFlow(page, 'C25217200', 3);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹2ï¼šåªæ‰§è¡Œä¸Šä¼ éƒ¨åˆ†ï¼ˆå‡è®¾å·²ç»åœ¨å‘å¸ƒé¡µé¢ï¼‰â€¨ */â€¨async function example2(page1: Page) {â€¨  await uploadProductImages(page1, 'C25217200', 3);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹3ï¼šæ‰¹é‡ä¸Šä¼ å¤šä¸ªå•†å“â€¨ */â€¨async function example3(page: Page) {â€¨  const products = [â€¨    { productId: 'C25217200', colorCount: 3 },â€¨    { productId: 'C25217201', colorCount: 2 },â€¨    { productId: 'C25217202', colorCount: 4 },â€¨  ];â€¨  â€¨  for (const product of products) {â€¨    await completeUploadFlow(page, product.productId, product.colorCount);â€¨    await page.waitForTimeout(3000); // å•†å“ä¹‹é—´é—´éš”â€¨  }â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { â€¨  uploadProductImages,â€¨  enterPublishPage,â€¨  completeUploadFlow,â€¨  getUploadFileNames,â€¨  getFallbackFileNames,â€¨  searchAndClickImageâ€¨};â€¨å…³é”®åŠŸèƒ½è¯´æ˜â€¨1. æ–‡ä»¶å‘½åè§„åˆ™ï¼ˆæ–°æ ¼å¼ï¼‰â€¨typescriptâ€¨// å•†å“ID_é¢œè‰²ç¼–å·-å›¾ç‰‡ç¼–å·.jpgâ€¨C25217200_1-01.jpg  // ç¬¬1ä¸ªé¢œè‰²çš„ç¬¬1å¼ â€¨C25217200_1-02.jpg  // ç¬¬1ä¸ªé¢œè‰²çš„ç¬¬2å¼ â€¨C25217200_2-01.jpg  // ç¬¬2ä¸ªé¢œè‰²çš„ç¬¬1å¼ â€¨2. æ™ºèƒ½é™çº§ç­–ç•¥ï¼ˆ3å±‚ï¼‰â€¨typescriptâ€¨åŸæ–‡ä»¶: C25217200_2-01.jpgâ€¨  â†“ å¤±è´¥â€¨é™çº§1: C25217200_2-02.jpg  // åŒé¢œè‰²ä¸‹ä¸€å¼ â€¨  â†“ å¤±è´¥â€¨é™çº§2: C25217200_3-01.jpg  // ä¸‹ä¸€ä¸ªé¢œè‰²ç¬¬ä¸€å¼ â€¨  â†“ å¤±è´¥â€¨é™çº§3: C25217200_1-01.jpg  // ç¬¬ä¸€ä¸ªé¢œè‰²ç¬¬ä¸€å¼ ï¼ˆå…œåº•ï¼‰â€¨3. å®Œæ•´çš„æ­¥éª¤æµç¨‹â€¨æ­¥éª¤1-4ï¼šè¿›å…¥å‘å¸ƒé¡µé¢â€¨æ­¥éª¤5ï¼šç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æŒ‰é’®â€¨æ­¥éª¤6ï¼šè·å–iframeå¹¶ç­‰å¾…åŠ è½½â€¨æ­¥éª¤7ï¼šè¾“å…¥å•†å“IDâ€¨æ­¥éª¤8ï¼šç‚¹å‡»æ–‡ä»¶å¤¹â€¨æ­¥éª¤9ï¼šç”Ÿæˆæ–‡ä»¶ååˆ—è¡¨â€¨æ­¥éª¤10ï¼šå¾ªç¯ä¸Šä¼ ï¼ˆå¸¦é™çº§ï¼‰â€¨æ­¥éª¤11ï¼šç­‰å¾…å®Œæˆâ€¨æ­¥éª¤12ï¼šæ£€æŸ¥æ˜¯å¦éœ€è¦ç»§ç»­â€¨æ­¥éª¤13ï¼šç‚¹å‡»å•†å“å±æ€§æˆ–å®Œæˆâ€¨4. ä½¿ç”¨æ–¹æ³•â€¨typescriptâ€¨import { test } from '@playwright/test';â€¨import { completeUploadFlow } from './upload-images';â€¨â€¨test('ä¸Šä¼ å•†å“å›¾ç‰‡', async ({ page }) => {â€¨  // å‡è®¾å·²ç»ç™»å½•â€¨  â€¨  // ä»é£ä¹¦è·å–æ•°æ®â€¨  const productData = {â€¨    productId: 'C25217200',â€¨    colorCount: 3  // ä»é£ä¹¦"é¢œè‰²æ•°é‡"å­—æ®µè·å–â€¨  };â€¨  â€¨  // æ‰§è¡Œå®Œæ•´æµç¨‹â€¨  await completeUploadFlow(page, productData.productId, productData.colorCount);â€¨});â€¨```â€¨â€¨## æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹â€¨```â€¨ğŸš€ å¼€å§‹å®Œæ•´çš„å›¾ç‰‡ä¸Šä¼ æµç¨‹â€¨å•†å“ID: C25217200â€¨é¢œè‰²æ•°é‡: 3â€¨â€¨========== è¿›å…¥å‘å¸ƒé¡µé¢ ==========â€¨â€¨[æ­¥éª¤1] ç‚¹å‡»å•†å“æŒ‰é’®â€¨  âœ… å•†å“æŒ‰é’®å·²ç‚¹å‡»â€¨â€¨[æ­¥éª¤2] ç‚¹å‡»æˆ‘çš„å•†å“â€¨  âœ… æˆ‘çš„å•†å“é¡µé¢å·²æ‰“å¼€â€¨â€¨[æ­¥éª¤3] ç‚¹å‡»ç¬¬ä¸€ä¸ª"å‘å¸ƒç›¸ä¼¼å“"â€¨â€¨[æ­¥éª¤4] ç­‰å¾…æ–°é¡µé¢æ‰“å¼€â€¨  âœ… æ–°é¡µé¢å·²æ‰“å¼€: https://item.upload.taobao.com/...â€¨â€¨========== æˆåŠŸè¿›å…¥å‘å¸ƒé¡µé¢ ==========â€¨â€¨========== å¼€å§‹ä¸Šä¼ å•†å“å›¾ç‰‡ ==========â€¨å•†å“ID: C25217200â€¨é¢œè‰²æ•°é‡: 3â€¨â€¨[æ­¥éª¤5] ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æŒ‰é’®â€¨  âœ… ä¸Šä¼ å›¾ç‰‡æŒ‰é’®å·²ç‚¹å‡»â€¨â€¨[æ­¥éª¤6] è·å–å›¾ç‰‡ä¸Šä¼ iframeâ€¨  ç­‰å¾…iframeåŠ è½½...â€¨  âœ… iframeåŠ è½½å®Œæˆâ€¨  æ‰“å¼€æ–‡ä»¶å¤¹é€‰æ‹©æ¡†â€¨â€¨[æ­¥éª¤7] è¾“å…¥å•†å“ID: C25217200â€¨  âœ… å•†å“IDå·²è¾“å…¥â€¨â€¨[æ­¥éª¤8] ç‚¹å‡»ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ–‡ä»¶å¤¹â€¨  âœ… å·²è¿›å…¥æ–‡ä»¶å¤¹â€¨â€¨[æ­¥éª¤9] ç”Ÿæˆæ–‡ä»¶ååˆ—è¡¨â€¨  å°†ä¸Šä¼ : C25217200_1-01.jpg, C25217200_1-02.jpg, C25217200_2-01.jpg, C25217200_2-02.jpg, C25217200_3-01.jpgâ€¨â€¨[æ­¥éª¤10] å¼€å§‹å¾ªç¯ä¸Šä¼ å›¾ç‰‡â€¨â€¨  â†’ ä¸Šä¼ ç¬¬1/5å¼ : C25217200_1-01.jpgâ€¨    å°è¯•æœç´¢: C25217200_1-01.jpgâ€¨    âœ… æˆåŠŸï¼ˆä½¿ç”¨åŸæ–‡ä»¶ï¼‰â€¨â€¨  â†’ ä¸Šä¼ ç¬¬2/5å¼ : C25217200_1-02.jpgâ€¨    å°è¯•æœç´¢: C25217200_1-02.jpgâ€¨    âœ… æˆåŠŸï¼ˆä½¿ç”¨åŸæ–‡ä»¶ï¼‰â€¨â€¨  â†’ ä¸Šä¼ ç¬¬3/5å¼ : C25217200_2-01.jpgâ€¨    å°è¯•æœç´¢: C25217200_2-01.jpgâ€¨    âš ï¸  æœªæ‰¾åˆ° C25217200_2-01.jpgâ€¨    å°è¯•æœç´¢: C25217200_2-02.jpgâ€¨    âœ… æˆåŠŸï¼ˆä½¿ç”¨é™çº§æ–¹æ¡ˆ1ï¼‰â€¨â€¨  â†’ ä¸Šä¼ ç¬¬4/5å¼ : C25217200_2-02.jpgâ€¨    å°è¯•æœç´¢: C25217200_2-02.jpgâ€¨    âœ… æˆåŠŸï¼ˆä½¿ç”¨åŸæ–‡ä»¶ï¼‰â€¨â€¨  â†’ ä¸Šä¼ ç¬¬5/5å¼ : C25217200_3-01.jpgâ€¨    å°è¯•æœç´¢: C25217200_3-01.jpgâ€¨    âœ… æˆåŠŸï¼ˆä½¿ç”¨åŸæ–‡ä»¶ï¼‰â€¨â€¨  ğŸ“Š ä¸Šä¼ ç»Ÿè®¡: æˆåŠŸ5/5å¼ â€¨â€¨[æ­¥éª¤11] ç­‰å¾…ä¸Šä¼ å¤„ç†å®Œæˆâ€¨â€¨â€¨[æ­¥éª¤12] âœ… ä¸Šä¼ å®Œæˆâ€¨â€¨========== å•†å“å›¾ç‰‡ä¸Šä¼ å®Œæˆ ==========â€¨
5ã€å®è´æ ‡é¢˜-å•†å“åˆ†ç±»
Plain Textâ€¨// åº”è¯¥åœ¨æ–‡ä»¶å¼€å¤´æ·»åŠ  import { determine_clothing_type } from './classify-clothing'; â€¨typescriptâ€¨import { Page } from '@playwright/test';â€¨â€¨/**â€¨ * å¡«å†™æ·˜å®å•†å“æ ‡é¢˜å’Œé€‰æ‹©æœè£…åˆ†ç±»â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ * @param productData - ä»é£ä¹¦è·å–çš„å•†å“æ•°æ®â€¨ */â€¨async function fillTitleAndCategory(â€¨  page1: Page,â€¨  productData: {â€¨    title: string;           // å•†å“æ ‡é¢˜â€¨    productName?: string;    // äº§å“åç§°ï¼ˆç”¨äºåˆ†ç±»åˆ¤æ–­ï¼‰â€¨    description?: string;    // æè¿°â€¨    category?: string;       // ç±»åˆ«â€¨    productUrl?: string;     // äº§å“URLâ€¨  }â€¨): Promise<void> {â€¨  â€¨  console.log('\n========== å¡«å†™å•†å“æ ‡é¢˜å’Œåˆ†ç±» ==========');â€¨  â€¨  try {â€¨    // ==================== ç¬¬ä¸€éƒ¨åˆ†ï¼šå¡«å†™å•†å“æ ‡é¢˜ ====================â€¨    console.log('\n[æ­¥éª¤1] å¡«å†™å•†å“æ ‡é¢˜');â€¨    console.log(`  æ ‡é¢˜å†…å®¹: ${productData.title}`);â€¨    â€¨    // 1.1 å®šä½æ ‡é¢˜è¾“å…¥æ¡†â€¨    const titleInput = page1.getByRole('textbox', { â€¨      name: 'æœ€å¤šå…è®¸è¾“å…¥30ä¸ªæ±‰å­—ï¼ˆ60å­—ç¬¦ï¼‰' â€¨    });â€¨    â€¨    // 1.2 ç‚¹å‡»è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹â€¨    await titleInput.click();â€¨    await page1.waitForTimeout(300);â€¨    â€¨    // 1.3 æ¸…ç©ºå¹¶å¡«å…¥æ ‡é¢˜â€¨    await titleInput.clear();â€¨    await titleInput.fill(productData.title);â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log('  âœ… æ ‡é¢˜å¡«å†™å®Œæˆ');â€¨    â€¨    // ==================== ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ¤æ–­æœè£…åˆ†ç±» ====================â€¨    console.log('\n[æ­¥éª¤2] åˆ†ææœè£…åˆ†ç±»');â€¨    â€¨    // 2.1 ä½¿ç”¨åˆ†ç±»åˆ¤æ–­å‡½æ•°ï¼ˆéœ€è¦å…ˆå¯¼å…¥ determine_clothing_typeï¼‰â€¨    const detailedType = determine_clothing_type(productData);â€¨    console.log(`  ç»†åˆ†ç±»å‹: ${detailedType}`);â€¨    â€¨    // 2.2 æ˜ å°„åˆ°æ·˜å®ç±»ç›®â€¨    const taobaoCategory = mapToTaobaoCategory(detailedType);â€¨    console.log(`  æ·˜å®ç±»ç›®: ${taobaoCategory}`);â€¨    â€¨    // ==================== ç¬¬ä¸‰éƒ¨åˆ†ï¼šé€‰æ‹©æœè£…åˆ†ç±» ====================â€¨    console.log('\n[æ­¥éª¤3] é€‰æ‹©æœè£…åˆ†ç±»');â€¨    â€¨    // 3.1 ç‚¹å‡»åˆ†ç±»ä¸‹æ‹‰æ¡†ï¼ˆå½“å‰æ˜¾ç¤ºçš„åˆ†ç±»å€¼ï¼‰â€¨    console.log('  3.1 ç‚¹å‡»ä¸‹æ‹‰æ¡†');â€¨    await page1.locator('span').filter({ â€¨      hasText: /POLO|Tæ¤|å…¶ä»–|å«è¡£|åœºè®­æœ|å¤–å¥—|å¥—è£…|æ¯”èµ›æœ|çŸ­è¢–|çŸ­è£™|çŸ­è£¤|ç´§èº«è¡£è£¤|èƒŒå¿ƒ|è…°å¸¦|è¢œå­|è®­ç»ƒæœ|è¿è¡£è£™|é•¿è¢–|é•¿è£¤|é©¬ç”²/ â€¨    }).nth(2).click();â€¨    â€¨    // 3.2 ç­‰å¾…ä¸‹æ‹‰æ¡†å®Œå…¨å±•å¼€â€¨    await page1.waitForTimeout(800);â€¨    console.log('  3.2 ä¸‹æ‹‰æ¡†å·²å±•å¼€');â€¨    â€¨    // 3.3 ç¡®ä¿æœç´¢æ¡†å¯è§â€¨    await page1.waitForSelector('.options-search > .next-input > input', { â€¨      state: 'visible',â€¨      timeout: 5000 â€¨    });â€¨    â€¨    // 3.4 ç‚¹å‡»æœç´¢æ¡†â€¨    console.log(`  3.3 åœ¨æœç´¢æ¡†è¾“å…¥: ${taobaoCategory}`);â€¨    await page1.locator('.options-search > .next-input > input').click();â€¨    await page1.waitForTimeout(300);â€¨    â€¨    // 3.5 æ¸…ç©ºæœç´¢æ¡†â€¨    await page1.locator('.next-input.next-focus > input').clear();â€¨    await page1.waitForTimeout(200);â€¨    â€¨    // 3.6 å¡«å…¥æ·˜å®åˆ†ç±»â€¨    await page1.locator('.next-input.next-focus > input').fill(taobaoCategory);â€¨    await page1.waitForTimeout(500);â€¨    â€¨    // 3.7 ç­‰å¾…æœç´¢ç»“æœåŠ è½½â€¨    console.log('  3.4 ç­‰å¾…æœç´¢ç»“æœ');â€¨    await page1.waitForTimeout(800);â€¨    â€¨    // 3.8 ç‚¹å‡»åŒ¹é…çš„åˆ†ç±»é€‰é¡¹â€¨    console.log(`  3.5 é€‰æ‹©åˆ†ç±»: ${taobaoCategory}`);â€¨    await page1.getByTitle(taobaoCategory).click();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log('  âœ… åˆ†ç±»é€‰æ‹©å®Œæˆ');â€¨    â€¨    console.log('\n========== æ ‡é¢˜å’Œåˆ†ç±»å¡«å†™å®Œæˆ ==========\n');â€¨    â€¨  } catch (error) {â€¨    console.error('\nâŒ å¡«å†™å¤±è´¥:', error);â€¨    throw error;â€¨  }â€¨}â€¨â€¨// ==================== æ˜ å°„å‡½æ•° ====================â€¨â€¨function mapToTaobaoCategory(detailedType: string): string {â€¨  const categoryMapping: { [key: string]: string } = {â€¨    'Poloè¡«': 'POLO',â€¨    'Tæ¤': 'Tæ¤',â€¨    'çŸ­è¢–': 'çŸ­è¢–',â€¨    'é•¿è¢–ä¸Šè¡£': 'é•¿è¢–',â€¨    'æ¯›è¡£': 'é•¿è¢–',â€¨    'è¡¬è¡«': 'é•¿è¢–',â€¨    'å«è¡£': 'å«è¡£',â€¨    'å¤¹å…‹': 'å¤–å¥—',â€¨    'é£è¡£': 'å¤–å¥—',â€¨    'ç¾½ç»’æœ': 'å¤–å¥—',â€¨    'é›¨è¡£': 'å¤–å¥—',â€¨    'é©¬ç”²': 'é©¬ç”²',â€¨    'èƒŒå¿ƒä¸Šè¡£': 'èƒŒå¿ƒ',â€¨    'æ‰“åº•è¡£': 'ç´§èº«è¡£è£¤',â€¨    'è¿åŠ¨ä¸Šè¡£': 'è®­ç»ƒæœ',â€¨    'çŸ­è£¤': 'çŸ­è£¤',â€¨    'é•¿è£¤': 'é•¿è£¤',â€¨    'é›¨è£¤': 'é•¿è£¤',â€¨    'è£™å­': 'çŸ­è£™',â€¨    'è¢œå­': 'è¢œå­',â€¨    'é«˜ç­’è¢œ': 'è¢œå­',â€¨    'é•¿è¢œ': 'è¢œå­',â€¨    'çŸ­è¢œ': 'è¢œå­',â€¨    'è…°å¸¦': 'è…°å¸¦',â€¨    'æ‰‹å¥—': 'å…¶ä»–',â€¨    'é¸­èˆŒå¸½': 'å…¶ä»–',â€¨    'å¸½å­': 'å…¶ä»–',â€¨    'æ¯›å·¾': 'å…¶ä»–',â€¨    'å›´å·¾': 'å…¶ä»–',â€¨    'æŠ¤è‡‚å¥—': 'å…¶ä»–',â€¨    'é«˜å°”å¤«é‹': 'å…¶ä»–',â€¨    'é’‰é‹': 'å…¶ä»–',â€¨    'è½¯é’‰é‹': 'å…¶ä»–',â€¨    'æ— é’‰é‹': 'å…¶ä»–',â€¨    'é‹ç±»': 'å…¶ä»–',â€¨    'ä¸Šè¡£': 'å…¶ä»–',â€¨    'ä¸‹è£…': 'å…¶ä»–',â€¨    'é…ä»¶': 'å…¶ä»–',â€¨  };â€¨  â€¨  return categoryMapping[detailedType] || 'å…¶ä»–';â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹1ï¼šPoloè¡«â€¨ */â€¨async function example1(page1: Page) {â€¨  const productFromFeishu = {â€¨    title: 'Callaway ç”·å£«é«˜å°”å¤«Poloè¡« é€Ÿå¹²é€æ°”',â€¨    productName: 'ãƒãƒ­ã‚·ãƒ£ãƒ„ ãƒ¡ãƒ³ã‚º',â€¨    description: 'golf polo shirt',â€¨    productUrl: 'https://shop.callawaygolf.jp/mens/tops/polo'â€¨  };â€¨  â€¨  await fillTitleAndCategory(page1, productFromFeishu);â€¨  // è¾“å‡º:â€¨  // æ ‡é¢˜å†…å®¹: Callaway ç”·å£«é«˜å°”å¤«Poloè¡« é€Ÿå¹²é€æ°”â€¨  // ç»†åˆ†ç±»å‹: Poloè¡«â€¨  // æ·˜å®ç±»ç›®: POLOâ€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹2ï¼šå¤¹å…‹â€¨ */â€¨async function example2(page1: Page) {â€¨  const productFromFeishu = {â€¨    title: 'Callaway é˜²é£å¤¹å…‹ ç”·å¥³é€šç”¨æ¬¾',â€¨    productName: 'ã‚¸ãƒ£ã‚±ãƒƒãƒˆ',â€¨    description: 'windbreaker jacket',â€¨    productUrl: 'https://shop.callawaygolf.jp/mens/outerwear/jacket'â€¨  };â€¨  â€¨  await fillTitleAndCategory(page1, productFromFeishu);â€¨  // è¾“å‡º:â€¨  // æ ‡é¢˜å†…å®¹: Callaway é˜²é£å¤¹å…‹ ç”·å¥³é€šç”¨æ¬¾â€¨  // ç»†åˆ†ç±»å‹: å¤¹å…‹â€¨  // æ·˜å®ç±»ç›®: å¤–å¥—â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹3ï¼šçŸ­è£¤â€¨ */â€¨async function example3(page1: Page) {â€¨  const productFromFeishu = {â€¨    title: 'Callaway é«˜å°”å¤«çŸ­è£¤ å¤å­£æ¸…å‡‰æ¬¾',â€¨    productName: 'ã‚·ãƒ§ãƒ¼ãƒˆãƒ‘ãƒ³ãƒ„',â€¨    description: 'golf shorts',â€¨    productUrl: 'https://shop.callawaygolf.jp/mens/bottoms/shorts'â€¨  };â€¨  â€¨  await fillTitleAndCategory(page1, productFromFeishu);â€¨  // è¾“å‡º:â€¨  // æ ‡é¢˜å†…å®¹: Callaway é«˜å°”å¤«çŸ­è£¤ å¤å­£æ¸…å‡‰æ¬¾â€¨  // ç»†åˆ†ç±»å‹: çŸ­è£¤â€¨  // æ·˜å®ç±»ç›®: çŸ­è£¤â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { fillTitleAndCategory, mapToTaobaoCategory };â€¨ä½¿ç”¨æ–¹æ³•â€¨typescriptâ€¨import { test } from '@playwright/test';â€¨import { fillTitleAndCategory } from './fill-product-form';â€¨â€¨test('å¡«å†™æ·˜å®å•†å“ä¿¡æ¯', async ({ page }) => {â€¨  // ... å‰é¢çš„ç™»å½•ã€æ‰“å¼€å‘å¸ƒé¡µé¢ç­‰æ“ä½œ ...â€¨  â€¨  // ä»é£ä¹¦è·å–å•†å“æ•°æ®â€¨  const productData = {â€¨    title: 'Callaway ç”·å£«Poloè¡« é€Ÿå¹²é€æ°”',â€¨    productName: 'ãƒãƒ­ã‚·ãƒ£ãƒ„ ãƒ¡ãƒ³ã‚º',â€¨    description: 'golf polo shirt',â€¨    productUrl: 'https://shop.callawaygolf.jp/mens/tops/polo'â€¨  };â€¨  â€¨  // ä¸€é”®å¡«å†™æ ‡é¢˜å’Œåˆ†ç±»â€¨  await fillTitleAndCategory(page, productData);â€¨  â€¨  // ... åç»­æ“ä½œ ...â€¨});â€¨```â€¨â€¨## å…³é”®ç»†èŠ‚è¯´æ˜â€¨â€¨| æ­¥éª¤ | æ“ä½œ | ç­‰å¾…æ—¶é—´ | è¯´æ˜ |â€¨|-----|------|---------|------|â€¨| 1.2 | ç‚¹å‡»æ ‡é¢˜è¾“å…¥æ¡† | 300ms | è·å¾—ç„¦ç‚¹ |â€¨| 1.3 | æ¸…ç©ºå¹¶å¡«å…¥æ ‡é¢˜ | 500ms | ç¡®ä¿è¾“å…¥å®Œæˆ |â€¨| 3.1 | ç‚¹å‡»åˆ†ç±»ä¸‹æ‹‰æ¡† | 800ms | ç­‰å¾…ä¸‹æ‹‰å±•å¼€ |â€¨| 3.3 | ç­‰å¾…æœç´¢æ¡†å¯è§ | æœ€å¤š5000ms | ç¡®ä¿å…ƒç´ åŠ è½½ |â€¨| 3.4 | ç‚¹å‡»æœç´¢æ¡† | 300ms | è·å¾—ç„¦ç‚¹ |â€¨| 3.5 | æ¸…ç©ºæœç´¢æ¡† | 200ms | æ¸…é™¤æ—§å†…å®¹ |â€¨| 3.6 | å¡«å…¥åˆ†ç±»åç§° | 500ms | ç¡®ä¿è¾“å…¥å®Œæˆ |â€¨| 3.7 | ç­‰å¾…æœç´¢ç»“æœ | 800ms | ç­‰å¾…åŒ¹é…é¡¹å‡ºç° |â€¨| 3.8 | ç‚¹å‡»é€‰æ‹© | 500ms | ç¡®è®¤é€‰æ‹© |â€¨â€¨## æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹â€¨```â€¨========== å¡«å†™å•†å“æ ‡é¢˜å’Œåˆ†ç±» ==========â€¨â€¨[æ­¥éª¤1] å¡«å†™å•†å“æ ‡é¢˜â€¨  æ ‡é¢˜å†…å®¹: Callaway ç”·å£«é«˜å°”å¤«Poloè¡« é€Ÿå¹²é€æ°”â€¨  âœ… æ ‡é¢˜å¡«å†™å®Œæˆâ€¨â€¨[æ­¥éª¤2] åˆ†ææœè£…åˆ†ç±»â€¨  ç»†åˆ†ç±»å‹: Poloè¡«â€¨  æ·˜å®ç±»ç›®: POLOâ€¨â€¨[æ­¥éª¤3] é€‰æ‹©æœè£…åˆ†ç±»â€¨  3.1 ç‚¹å‡»ä¸‹æ‹‰æ¡†â€¨  3.2 ä¸‹æ‹‰æ¡†å·²å±•å¼€â€¨  3.3 åœ¨æœç´¢æ¡†è¾“å…¥: POLOâ€¨  3.4 ç­‰å¾…æœç´¢ç»“æœâ€¨  3.5 é€‰æ‹©åˆ†ç±»: POLOâ€¨  âœ… åˆ†ç±»é€‰æ‹©å®Œæˆâ€¨â€¨========== æ ‡é¢˜å’Œåˆ†ç±»å¡«å†™å®Œæˆ ==========
6ã€å“ç‰Œä¸Šä¼ 
Pythonâ€¨import { Page } from '@playwright/test';â€¨â€¨/**â€¨ * é€‰æ‹©å•†å“å“ç‰Œâ€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ * @param brandName - å“ç‰Œåç§°ï¼ˆä»é£ä¹¦è·å–ï¼Œå¦‚"å¡æ‹‰å¨"ï¼‰â€¨ */â€¨async function selectBrand(page1: Page, brandName: string): Promise<void> {â€¨  â€¨  console.log('\n========== é€‰æ‹©å•†å“å“ç‰Œ ==========');â€¨  console.log(`å“ç‰Œåç§°: ${brandName}`);â€¨  â€¨  try {â€¨    // æ­¥éª¤1ï¼šç‚¹å‡»å“ç‰Œè¾“å…¥æ¡†ï¼ˆæ‰“å¼€ä¸‹æ‹‰èœå•ï¼‰â€¨    console.log('\n[æ­¥éª¤1] ç‚¹å‡»å“ç‰Œè¾“å…¥æ¡†');â€¨    await page1.locator('#struct-p-20000').getByRole('combobox', { name: 'è¯·è¾“å…¥' }).click();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    // æ­¥éª¤2ï¼šç‚¹å‡»æœç´¢æ¡†è·å¾—ç„¦ç‚¹â€¨    console.log('[æ­¥éª¤2] ç‚¹å‡»æœç´¢æ¡†');â€¨    await page1.locator('.options-search > .next-input > input').click();â€¨    await page1.waitForTimeout(300);â€¨    â€¨    // æ­¥éª¤3ï¼šæ¸…ç©ºå¹¶è¾“å…¥å“ç‰Œåâ€¨    console.log(`[æ­¥éª¤3] è¾“å…¥å“ç‰Œå: ${brandName}`);â€¨    await page1.locator('.next-input.next-focus > input').clear();â€¨    await page1.locator('.next-input.next-focus > input').fill(brandName);â€¨    await page1.waitForTimeout(500);â€¨    â€¨    // æ­¥éª¤4ï¼šç­‰å¾…æœç´¢ç»“æœåŠ è½½â€¨    console.log('[æ­¥éª¤4] ç­‰å¾…æœç´¢ç»“æœ');â€¨    await page1.waitForTimeout(800);â€¨    â€¨    // æ­¥éª¤5ï¼šç‚¹å‡»åŒ¹é…çš„å“ç‰Œé€‰é¡¹â€¨    // ä½¿ç”¨æ­£åˆ™åŒ¹é…ï¼Œæ”¯æŒ "Callaway/å¡æ‹‰å¨" æˆ– "å¡æ‹‰å¨" ç­‰æ ¼å¼â€¨    console.log(`[æ­¥éª¤5] é€‰æ‹©å“ç‰Œ`);â€¨    await page1.getByTitle(new RegExp(brandName, 'i')).first().click();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log('âœ… å“ç‰Œé€‰æ‹©å®Œæˆ\n');â€¨    â€¨  } catch (error) {â€¨    console.error(`âŒ å“ç‰Œé€‰æ‹©å¤±è´¥: ${error}`);â€¨    throw error;â€¨  }â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹1ï¼šé€‰æ‹©å¡æ‹‰å¨å“ç‰Œâ€¨ */â€¨async function example1(page1: Page) {â€¨  await selectBrand(page1, 'å¡æ‹‰å¨');â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹2ï¼šé€‰æ‹©Nikeå“ç‰Œâ€¨ */â€¨async function example2(page1: Page) {â€¨  await selectBrand(page1, 'Nike');â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹3ï¼šä»é£ä¹¦æ•°æ®é€‰æ‹©å“ç‰Œâ€¨ */â€¨async function example3(page1: Page) {â€¨  const productFromFeishu = {â€¨    brand: 'å¡æ‹‰å¨'  // ä»é£ä¹¦è·å–çš„å“ç‰Œåâ€¨  };â€¨  â€¨  await selectBrand(page1, productFromFeishu.brand);â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { selectBrand };â€¨ä½¿ç”¨æ–¹æ³•â€¨typescriptâ€¨import { test } from '@playwright/test';â€¨import { selectBrand } from './select-brand';â€¨â€¨test('é€‰æ‹©å“ç‰Œ', async ({ page }) => {â€¨  // ... å‰é¢çš„æ“ä½œ ...â€¨  â€¨  // ä»é£ä¹¦è·å–å“ç‰Œåâ€¨  const brandName = 'å¡æ‹‰å¨';â€¨  â€¨  // é€‰æ‹©å“ç‰Œâ€¨  await selectBrand(page, brandName);â€¨  â€¨  // ... åç»­æ“ä½œ ...â€¨});â€¨```â€¨â€¨## æ“ä½œæ­¥éª¤è¯´æ˜â€¨â€¨| æ­¥éª¤ | å…ƒç´ å®šä½ | ç­‰å¾…æ—¶é—´ | è¯´æ˜ |â€¨|-----|---------|---------|------|â€¨| 1 | `#struct-p-20000` + `getByRole('combobox', { name: 'è¯·è¾“å…¥' })` | 500ms | ç‚¹å‡»å“ç‰Œè¾“å…¥æ¡†ï¼Œæ‰“å¼€ä¸‹æ‹‰èœå• |â€¨| 2 | `.options-search > .next-input > input` | 300ms | ç‚¹å‡»æœç´¢æ¡†ï¼Œè·å¾—ç„¦ç‚¹ |â€¨| 3 | `.next-input.next-focus > input` | 500ms | æ¸…ç©ºå¹¶è¾“å…¥å“ç‰Œå |â€¨| 4 | - | 800ms | ç­‰å¾…æœç´¢ç»“æœåŠ è½½ |â€¨| 5 | `getByTitle(RegExp)` | 500ms | ç‚¹å‡»åŒ¹é…çš„å“ç‰Œé€‰é¡¹ |â€¨â€¨## æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹â€¨```â€¨========== é€‰æ‹©å•†å“å“ç‰Œ ==========â€¨å“ç‰Œåç§°: å¡æ‹‰å¨â€¨â€¨[æ­¥éª¤1] ç‚¹å‡»å“ç‰Œè¾“å…¥æ¡†â€¨[æ­¥éª¤2] ç‚¹å‡»æœç´¢æ¡†â€¨[æ­¥éª¤3] è¾“å…¥å“ç‰Œå: å¡æ‹‰å¨â€¨[æ­¥éª¤4] ç­‰å¾…æœç´¢ç»“æœâ€¨[æ­¥éª¤5] é€‰æ‹©å“ç‰Œâ€¨âœ… å“ç‰Œé€‰æ‹©å®Œæˆ
7ã€è´§å·ã€é€‚ç”¨å¯¹è±¡


JavaScriptâ€¨è¿™é‡Œçš„åŒºåŸŸ å’Œåˆšæ‰ä¸ä¸€æ ·ï¼Œæˆ‘æŠŠä»–æ•´ä¸ªåŒºåŸŸæˆªä¸‹æ¥ï¼Œåƒæ˜¯å›¾ç‰‡è¿™ä¸ªæˆ‘æŠ“äº†ä¸€ä¸ªå…ƒç´ ã€‚ç„¶åä¸‹æ‹‰æ¡†åœ¨ä»–é‡Œé¢ï¼Œâ€¨æˆ‘ä»¬åˆ†åˆ«è¦å¤„ç†è´§å·é‡è¦ å’Œé€‚ç”¨æ€§åˆ«è¿™ä¸¤ä¸ªã€‚â€¨è´§å·å¯¹åº”éœ€è¦æ‰¾é£ä¹¦å¤šç»´è¡¨æ ¼ä¸Šçš„å•†å“id å¡«å…¥è¿›å»å³å¯ã€‚  await page1.locator('input[name="p-13021751"]').click();å…ƒç´ æ˜¯è¿™ä¸ªâ€¨é€‚ç”¨æ€§åˆ«å¯¹åº”éœ€è¦æ‰¾é£ä¹¦å¤šç»´è¡¨æ ¼ä¸Šçš„æ€§åˆ«å¡«å…¥è¿›å»å³å¯ã€‚  åªéœ€è¦åŒºåˆ†ç”·å¥³å³å¯ï¼Œæˆ‘å·²ç»è´´å‡ºæ¥äº† å°±ä¸‹é¢ä¸¤ä¸ªå…ƒç´ 2é€‰1 ç­‰ä¸‹æ‹‰æ¡†å‡ºæ¥ç‚¹å‡»å°±è¡Œã€‚ await page1.getByTitle('ç”·').nth(2).click();â€¨  await page1.getByTitle('å¥³', { exact: true }).click();â€¨â€¨import { Page } from '@playwright/test';â€¨â€¨/**â€¨ * å¡«å†™å•†å“è´§å·â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ * @param productId - å•†å“IDï¼ˆä»é£ä¹¦è·å–ï¼‰â€¨ */â€¨async function fillProductNumber(page1: Page, productId: string): Promise<void> {â€¨  â€¨  console.log('\n========== å¡«å†™å•†å“è´§å· ==========');â€¨  console.log(`å•†å“ID: ${productId}`);â€¨  â€¨  try {â€¨    // æ­¥éª¤1ï¼šç‚¹å‡»è´§å·åŒºåŸŸâ€¨    console.log('[æ­¥éª¤1] ç‚¹å‡»è´§å·åŒºåŸŸ');â€¨    await page1.locator('#sell-field-p-13021751').click();â€¨    await page1.waitForTimeout(300);â€¨    â€¨    // æ­¥éª¤2ï¼šç‚¹å‡»"è´§å·é‡è¦"æ ‡ç­¾ï¼ˆå¯é€‰ï¼Œç”¨äºå®šä½ï¼‰â€¨    console.log('[æ­¥éª¤2] å®šä½è´§å·è¾“å…¥æ¡†');â€¨    await page1.getByText('è´§å·é‡è¦').click();â€¨    await page1.waitForTimeout(300);â€¨    â€¨    // æ­¥éª¤3ï¼šç‚¹å‡»å¹¶å¡«å…¥è´§å·â€¨    console.log(`[æ­¥éª¤3] å¡«å…¥è´§å·: ${productId}`);â€¨    const productNumberInput = page1.locator('input[name="p-13021751"]');â€¨    await productNumberInput.click();â€¨    await page1.waitForTimeout(200);â€¨    await productNumberInput.clear();â€¨    await productNumberInput.fill(productId);â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log('âœ… è´§å·å¡«å†™å®Œæˆ\n');â€¨    â€¨  } catch (error) {â€¨    console.error(`âŒ è´§å·å¡«å†™å¤±è´¥: ${error}`);â€¨    throw error;â€¨  }â€¨}â€¨â€¨/**â€¨ * é€‰æ‹©é€‚ç”¨æ€§åˆ«â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ * @param gender - æ€§åˆ«ï¼ˆä»é£ä¹¦è·å–ï¼Œå€¼ä¸º"ç”·"æˆ–"å¥³"ï¼‰â€¨ */â€¨async function selectGender(page1: Page, gender: string): Promise<void> {â€¨  â€¨  console.log('\n========== é€‰æ‹©é€‚ç”¨æ€§åˆ« ==========');â€¨  console.log(`æ€§åˆ«: ${gender}`);â€¨  â€¨  try {â€¨    // æ­¥éª¤1ï¼šç‚¹å‡»æ€§åˆ«åŒºåŸŸï¼ˆæ‰“å¼€ä¸‹æ‹‰æ¡†ï¼‰â€¨    console.log('[æ­¥éª¤1] ç‚¹å‡»æ€§åˆ«åŒºåŸŸ');â€¨    await page1.locator('#sell-field-p-122216608').click();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    // æ­¥éª¤2ï¼šæ ¹æ®æ€§åˆ«é€‰æ‹©å¯¹åº”é€‰é¡¹â€¨    console.log(`[æ­¥éª¤2] é€‰æ‹©æ€§åˆ«: ${gender}`);â€¨    â€¨    if (gender === 'ç”·') {â€¨      await page1.getByTitle('ç”·').nth(2).click();â€¨    } else if (gender === 'å¥³') {â€¨      await page1.getByTitle('å¥³', { exact: true }).click();â€¨    } else {â€¨      throw new Error(`ä¸æ”¯æŒçš„æ€§åˆ«å€¼: ${gender}ï¼Œåªæ”¯æŒ"ç”·"æˆ–"å¥³"`);â€¨    }â€¨    â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log('âœ… æ€§åˆ«é€‰æ‹©å®Œæˆ\n');â€¨    â€¨  } catch (error) {â€¨    console.error(`âŒ æ€§åˆ«é€‰æ‹©å¤±è´¥: ${error}`);â€¨    throw error;â€¨  }â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹1ï¼šå¡«å†™ç”·è£…å•†å“ä¿¡æ¯â€¨ */â€¨async function example1(page1: Page) {â€¨  const productFromFeishu = {â€¨    productId: 'C25217200',  // å•†å“IDâ€¨    gender: 'ç”·'              // æ€§åˆ«â€¨  };â€¨  â€¨  // å¡«å†™è´§å·â€¨  await fillProductNumber(page1, productFromFeishu.productId);â€¨  â€¨  // é€‰æ‹©æ€§åˆ«â€¨  await selectGender(page1, productFromFeishu.gender);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹2ï¼šå¡«å†™å¥³è£…å•†å“ä¿¡æ¯â€¨ */â€¨async function example2(page1: Page) {â€¨  const productFromFeishu = {â€¨    productId: 'C25218300',â€¨    gender: 'å¥³'â€¨  };â€¨  â€¨  await fillProductNumber(page1, productFromFeishu.productId);â€¨  await selectGender(page1, productFromFeishu.gender);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹3ï¼šå®Œæ•´ä½¿ç”¨â€¨ */â€¨async function example3(page1: Page) {â€¨  // ä»é£ä¹¦è·å–æ•°æ®â€¨  const productId = 'C25217200';â€¨  const gender = 'ç”·';â€¨  â€¨  // åˆ†åˆ«è°ƒç”¨â€¨  await fillProductNumber(page1, productId);â€¨  await selectGender(page1, gender);â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { fillProductNumber, selectGender };});â€¨â€¨ä½¿ç”¨æ–¹æ³•â€¨typescriptâ€¨import { test } from '@playwright/test';â€¨import { fillProductNumber, selectGender } from './product-details';â€¨â€¨test('å¡«å†™è´§å·å’Œæ€§åˆ«', async ({ page }) => {â€¨  // ... å‰é¢çš„æ“ä½œ ...â€¨  â€¨  // ä»é£ä¹¦è·å–æ•°æ®â€¨  const productData = {â€¨    productId: 'C25217200',â€¨    gender: 'ç”·'â€¨  };â€¨  â€¨  // å¡«å†™è´§å·â€¨  await fillProductNumber(page, productData.productId);â€¨  â€¨  // é€‰æ‹©æ€§åˆ«â€¨  await selectGender(page, productData.gender);â€¨  â€¨  // ... åç»­æ“ä½œ ...â€¨});â€¨```â€¨â€¨## æ“ä½œæ­¥éª¤è¯´æ˜â€¨â€¨### è´§å·å¡«å†™â€¨â€¨| æ­¥éª¤ | å…ƒç´ å®šä½ | ç­‰å¾…æ—¶é—´ | è¯´æ˜ |â€¨|-----|---------|---------|------|â€¨| 1 | `#sell-field-p-13021751` | 300ms | ç‚¹å‡»è´§å·åŒºåŸŸ |â€¨| 2 | `getByText('è´§å·é‡è¦')` | 300ms | å®šä½æ ‡ç­¾ |â€¨| 3 | `input[name="p-13021751"]` | 500ms | æ¸…ç©ºå¹¶å¡«å…¥å•†å“ID |â€¨â€¨### æ€§åˆ«é€‰æ‹©â€¨â€¨| æ­¥éª¤ | å…ƒç´ å®šä½ | ç­‰å¾…æ—¶é—´ | è¯´æ˜ |â€¨|-----|---------|---------|------|â€¨| 1 | `#sell-field-p-122216608` | 500ms | ç‚¹å‡»æ€§åˆ«åŒºåŸŸï¼Œæ‰“å¼€ä¸‹æ‹‰æ¡† |â€¨| 2 | `getByTitle('ç”·').nth(2)` æˆ– `getByTitle('å¥³')` | 500ms | æ ¹æ®æ€§åˆ«å€¼é€‰æ‹©å¯¹åº”é€‰é¡¹ |â€¨â€¨## æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹â€¨```â€¨========== å¡«å†™å•†å“è´§å· ==========â€¨å•†å“ID: C25217200â€¨[æ­¥éª¤1] ç‚¹å‡»è´§å·åŒºåŸŸâ€¨[æ­¥éª¤2] å®šä½è´§å·è¾“å…¥æ¡†â€¨[æ­¥éª¤3] å¡«å…¥è´§å·: C25217200â€¨âœ… è´§å·å¡«å†™å®Œæˆâ€¨â€¨========== é€‰æ‹©é€‚ç”¨æ€§åˆ« ==========â€¨æ€§åˆ«: ç”·â€¨[æ­¥éª¤1] ç‚¹å‡»æ€§åˆ«åŒºåŸŸâ€¨[æ­¥éª¤2] é€‰æ‹©æ€§åˆ«: ç”·â€¨âœ… æ€§åˆ«é€‰æ‹©å®Œæˆ
8ã€é¢œè‰²å¡«å†™
Pythonâ€¨import { Page } from '@playwright/test';â€¨â€¨/**â€¨ * å¡«å†™å•†å“é¢œè‰²åˆ†ç±»â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ * @param colors - é¢œè‰²æ•°ç»„ï¼ˆä»é£ä¹¦å¯¹åº”å•†å“idçš„é¢œè‰² è·å–ï¼Œå¦‚ ['è“è‰²', 'é»‘è‰²', 'ç°è‰²', 'çº¢è‰²']ï¼‰â€¨ */â€¨async function fillColors(page1: Page, colors: string[]): Promise<void> {â€¨  â€¨  console.log('\n========== å¡«å†™é¢œè‰²åˆ†ç±» ==========');â€¨  console.log(`é¢œè‰²åˆ—è¡¨: ${colors.join(', ')}`);â€¨  console.log(`é¢œè‰²æ•°é‡: ${colors.length}`);â€¨  â€¨  try {â€¨    // æ­¥éª¤1ï¼šç‚¹å‡»é¢œè‰²åŒºåŸŸâ€¨    console.log('\n[æ­¥éª¤1] ç‚¹å‡»é¢œè‰²åŒºåŸŸ');â€¨    await page1.getByText(/é¢œè‰²åˆ†ç±»\(\d+\)é‡è¦æ’åº/).click();â€¨    await page1.waitForTimeout(800);â€¨    â€¨    // æ­¥éª¤2ï¼šæ£€æŸ¥å½“å‰æœ‰å‡ ä¸ªé¢œè‰²è¾“å…¥æ¡†â€¨    console.log('[æ­¥éª¤2] æ£€æŸ¥å½“å‰è¾“å…¥æ¡†æ•°é‡');â€¨    const currentInputs = await page1.getByRole('textbox', { name: 'ä¸»è‰²(å¿…é€‰)' }).count();â€¨    console.log(`  å½“å‰è¾“å…¥æ¡†æ•°é‡: ${currentInputs}`);â€¨    console.log(`  éœ€è¦çš„é¢œè‰²æ•°é‡: ${colors.length}`);â€¨    â€¨    // æ­¥éª¤3ï¼šè°ƒæ•´è¾“å…¥æ¡†æ•°é‡â€¨    if (currentInputs > colors.length) {â€¨      // éœ€è¦åˆ é™¤å¤šä½™çš„è¾“å…¥æ¡†â€¨      console.log(`[æ­¥éª¤3] åˆ é™¤å¤šä½™çš„è¾“å…¥æ¡† (éœ€è¦åˆ é™¤ ${currentInputs - colors.length} ä¸ª)`);â€¨      await deleteExtraInputs(page1, currentInputs, colors.length);â€¨    } else if (currentInputs < colors.length) {â€¨      // éœ€è¦æ·»åŠ è¾“å…¥æ¡†â€¨      console.log(`[æ­¥éª¤3] æ·»åŠ è¾“å…¥æ¡† (éœ€è¦æ·»åŠ  ${colors.length - currentInputs} ä¸ª)`);â€¨      await addMoreInputs(page1, currentInputs, colors.length);â€¨    } else {â€¨      console.log('[æ­¥éª¤3] è¾“å…¥æ¡†æ•°é‡æ­£å¥½åŒ¹é…ï¼Œæ— éœ€è°ƒæ•´');â€¨    }â€¨    â€¨    // æ­¥éª¤4ï¼šæŒ‰é¡ºåºå¡«å…¥é¢œè‰²â€¨    console.log('\n[æ­¥éª¤4] æŒ‰é¡ºåºå¡«å…¥é¢œè‰²');â€¨    for (let i = 0; i < colors.length; i++) {â€¨      const color = colors[i];â€¨      console.log(`  å¡«å…¥ç¬¬${i + 1}ä¸ªé¢œè‰²: ${color}`);â€¨      â€¨      const input = page1.getByRole('textbox', { name: 'ä¸»è‰²(å¿…é€‰)' }).nth(i);â€¨      await input.click();â€¨      await page1.waitForTimeout(200);â€¨      await input.clear();â€¨      await input.fill(color);â€¨      await page1.waitForTimeout(300);â€¨    }â€¨    â€¨    console.log('\nâœ… é¢œè‰²åˆ†ç±»å¡«å†™å®Œæˆ\n');â€¨    â€¨  } catch (error) {â€¨    console.error(`âŒ é¢œè‰²å¡«å†™å¤±è´¥: ${error}`);â€¨    throw error;â€¨  }â€¨}â€¨â€¨/**â€¨ * åˆ é™¤å¤šä½™çš„é¢œè‰²è¾“å…¥æ¡†â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ * @param currentCount - å½“å‰è¾“å…¥æ¡†æ•°é‡â€¨ * @param targetCount - ç›®æ ‡è¾“å…¥æ¡†æ•°é‡â€¨ */â€¨async function deleteExtraInputs(â€¨  page1: Page, â€¨  currentCount: number, â€¨  targetCount: numberâ€¨): Promise<void> {â€¨  â€¨  const deleteCount = currentCount - targetCount;â€¨  â€¨  // ä»åå¾€å‰åˆ é™¤ï¼ˆä»æœ€åä¸€ä¸ªå¼€å§‹åˆ ï¼‰â€¨  for (let i = 0; i < deleteCount; i++) {â€¨    const indexToDelete = currentCount - i;â€¨    console.log(`  åˆ é™¤ç¬¬${indexToDelete}ä¸ªè¾“å…¥æ¡†`);â€¨    â€¨    if (indexToDelete === 1) {â€¨      // ç¬¬ä¸€ä¸ªåˆ é™¤æŒ‰é’®â€¨      await page1.getByRole('button').filter({ hasText: /^$/ }).nth(5).click();â€¨    } else {â€¨      // å…¶ä»–åˆ é™¤æŒ‰é’®â€¨      await page1.locator(â€¨        `div:nth-child(${indexToDelete}) > .sell-component-common-sale-props-option-item > .sell-color-item-wrap > .next-btn`â€¨      ).first().click();â€¨    }â€¨    â€¨    await page1.waitForTimeout(500);â€¨  }â€¨}â€¨â€¨/**â€¨ * æ·»åŠ æ›´å¤šé¢œè‰²è¾“å…¥æ¡†â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ * @param currentCount - å½“å‰è¾“å…¥æ¡†æ•°é‡â€¨ * @param targetCount - ç›®æ ‡è¾“å…¥æ¡†æ•°é‡â€¨ */â€¨async function addMoreInputs(â€¨  page1: Page, â€¨  currentCount: number, â€¨  targetCount: numberâ€¨): Promise<void> {â€¨  â€¨  const addCount = targetCount - currentCount;â€¨  â€¨  for (let i = 0; i < addCount; i++) {â€¨    console.log(`  æ·»åŠ ç¬¬${currentCount + i + 1}ä¸ªè¾“å…¥æ¡†`);â€¨    â€¨    // åœ¨æ·»åŠ ä¹‹å‰ï¼Œå…ˆå¡«å…¥å½“å‰æœ€åä¸€ä¸ªè¾“å…¥æ¡†ï¼ˆå¿…é¡»å¡«å…¥æ‰èƒ½æ·»åŠ ï¼‰â€¨    const lastInput = page1.getByRole('textbox', { name: 'ä¸»è‰²(å¿…é€‰)' }).nth(currentCount + i - 1);â€¨    const isLastInputFilled = await lastInput.inputValue();â€¨    â€¨    if (!isLastInputFilled) {â€¨      console.log(`  æç¤º: éœ€è¦å…ˆå¡«å…¥ç¬¬${currentCount + i}ä¸ªè¾“å…¥æ¡†æ‰èƒ½æ·»åŠ `);â€¨      await lastInput.click();â€¨      await page1.waitForTimeout(200);â€¨      await lastInput.fill('ä¸´æ—¶é¢œè‰²');  // å¡«å…¥ä¸´æ—¶å€¼â€¨      await page1.waitForTimeout(300);â€¨    }â€¨    â€¨    // ç‚¹å‡»æ·»åŠ æŒ‰é’®â€¨    await page1.getByRole('button', { name: '' }).first().click();â€¨    await page1.waitForTimeout(800);â€¨    â€¨    // æœ‰æ—¶å€™ä¼šå‡ºç°é¢å¤–çš„ç¡®è®¤å…ƒç´ â€¨    try {â€¨      const extraElement = page1.locator('.sell-color-item-container > div:nth-child(3)').first();â€¨      if (await extraElement.isVisible({ timeout: 1000 })) {â€¨        await extraElement.click();â€¨        await page1.waitForTimeout(300);â€¨      }â€¨    } catch (e) {â€¨      // å…ƒç´ ä¸å­˜åœ¨ï¼Œå¿½ç•¥â€¨    }â€¨  }â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹1ï¼š4ä¸ªé¢œè‰²â€¨ */â€¨async function example1(page1: Page) {â€¨  const colorsFromFeishu = ['è“è‰²', 'é»‘è‰²', 'ç°è‰²', 'çº¢è‰²'];â€¨  await fillColors(page1, colorsFromFeishu);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹2ï¼š2ä¸ªé¢œè‰²â€¨ */â€¨async function example2(page1: Page) {â€¨  const colorsFromFeishu = ['ç™½è‰²', 'é»‘è‰²'];â€¨  await fillColors(page1, colorsFromFeishu);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹3ï¼š6ä¸ªé¢œè‰²â€¨ */â€¨async function example3(page1: Page) {â€¨  const colorsFromFeishu = ['è“è‰²', 'é»‘è‰²', 'ç°è‰²', 'çº¢è‰²', 'ç™½è‰²', 'ç»¿è‰²'];â€¨  await fillColors(page1, colorsFromFeishu);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹4ï¼šä»é£ä¹¦è·å–é¢œè‰²å­—ç¬¦ä¸²å¹¶å¤„ç†â€¨ */â€¨async function example4(page1: Page) {â€¨  // é£ä¹¦è·å–çš„é¢œè‰²å­—ç¬¦ä¸²ï¼ˆå¤šè¡Œï¼‰â€¨  const colorString = `è“è‰²â€¨é»‘è‰²â€¨ç°è‰²â€¨çº¢è‰²`;â€¨  â€¨  // åˆ†å‰²æˆæ•°ç»„â€¨  const colors = colorString.trim().split('\n').map(c => c.trim()).filter(c => c);â€¨  â€¨  await fillColors(page1, colors);â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { fillColors };â€¨ä½¿ç”¨æ–¹æ³•â€¨import { test } from '@playwright/test';â€¨import { fillColors } from './fill-colors';â€¨â€¨test('å¡«å†™é¢œè‰²åˆ†ç±»', async ({ page }) => {â€¨  // ... å‰é¢çš„æ“ä½œ ...â€¨  â€¨  // ä»é£ä¹¦è·å–é¢œè‰²ï¼ˆå¯èƒ½æ˜¯å¤šè¡Œå­—ç¬¦ä¸²ï¼‰â€¨  const colorStringFromFeishu = `è“è‰²â€¨é»‘è‰²â€¨ç°è‰²â€¨çº¢è‰²`;â€¨  â€¨  // è½¬æ¢æˆæ•°ç»„â€¨  const colors = colorStringFromFeishu.trim().split('\n').map(c => c.trim()).filter(c => c);â€¨  â€¨  // å¡«å†™é¢œè‰²â€¨  await fillColors(page, colors);â€¨  â€¨  // ... åç»­æ“ä½œ ...â€¨});â€¨â€¨æ ¸å¿ƒé€»è¾‘è¯´æ˜â€¨1. æ£€æŸ¥è¾“å…¥æ¡†æ•°é‡â€¨typescriptâ€¨const currentInputs = await page1.getByRole('textbox', { name: 'ä¸»è‰²(å¿…é€‰)' }).count();â€¨2. ä¸‰ç§æƒ…å†µå¤„ç†â€¨æƒ…å†µæ“ä½œâ€¨è¾“å…¥æ¡†æ•°é‡ > é¢œè‰²æ•°é‡åˆ é™¤å¤šä½™çš„â€¨è¾“å…¥æ¡†æ•°é‡ < é¢œè‰²æ•°é‡æ·»åŠ ä¸è¶³çš„â€¨è¾“å…¥æ¡†æ•°é‡ = é¢œè‰²æ•°é‡ç›´æ¥å¡«å…¥â€¨3. åˆ é™¤æŒ‰é’®å®šä½â€¨ä½ç½®å…ƒç´ å®šä½â€¨ç¬¬1ä¸ªgetByRole('button').filter({ hasText: /^$/ }).nth(5)â€¨ç¬¬2ä¸ªdiv:nth-child(2) > ... > .next-btnâ€¨ç¬¬3ä¸ªdiv:nth-child(3) > ... > .next-btnâ€¨ç¬¬Nä¸ªdiv:nth-child(N) > ... > .next-btnâ€¨4. æ·»åŠ é€»è¾‘â€¨typescriptâ€¨1. å…ˆå¡«å…¥å½“å‰æœ€åä¸€ä¸ªè¾“å…¥æ¡†ï¼ˆå¿…é¡»æœ‰å€¼æ‰èƒ½æ·»åŠ ï¼‰â€¨2. ç‚¹å‡»æ·»åŠ æŒ‰é’®: getByRole('button', { name: '' }).first()â€¨3. æ£€æŸ¥æ˜¯å¦å‡ºç°é¢å¤–çš„ç¡®è®¤å…ƒç´ å¹¶ç‚¹å‡»â€¨4. ç­‰å¾…æ–°è¾“å…¥æ¡†å‡ºç°â€¨```â€¨â€¨## æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹â€¨```â€¨========== å¡«å†™é¢œè‰²åˆ†ç±» ==========â€¨é¢œè‰²åˆ—è¡¨: è“è‰², é»‘è‰², ç°è‰², çº¢è‰²â€¨é¢œè‰²æ•°é‡: 4â€¨â€¨[æ­¥éª¤1] ç‚¹å‡»é¢œè‰²åŒºåŸŸâ€¨â€¨[æ­¥éª¤2] æ£€æŸ¥å½“å‰è¾“å…¥æ¡†æ•°é‡â€¨  å½“å‰è¾“å…¥æ¡†æ•°é‡: 2â€¨  éœ€è¦çš„é¢œè‰²æ•°é‡: 4â€¨â€¨[æ­¥éª¤3] æ·»åŠ è¾“å…¥æ¡† (éœ€è¦æ·»åŠ  2 ä¸ª)â€¨  æ·»åŠ ç¬¬3ä¸ªè¾“å…¥æ¡†â€¨  æ·»åŠ ç¬¬4ä¸ªè¾“å…¥æ¡†â€¨â€¨[æ­¥éª¤4] æŒ‰é¡ºåºå¡«å…¥é¢œè‰²â€¨  å¡«å…¥ç¬¬1ä¸ªé¢œè‰²: è“è‰²â€¨  å¡«å…¥ç¬¬2ä¸ªé¢œè‰²: é»‘è‰²â€¨  å¡«å…¥ç¬¬3ä¸ªé¢œè‰²: ç°è‰²â€¨  å¡«å…¥ç¬¬4ä¸ªé¢œè‰²: çº¢è‰²â€¨â€¨âœ… é¢œè‰²åˆ†ç±»å¡«å†™å®Œæˆ
9ã€å°ºç 
JavaScriptâ€¨typescriptâ€¨import { Page } from '@playwright/test';â€¨â€¨/**â€¨ * å¡«å†™å•†å“å°ºç â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ * @param sizes - å°ºç æ•°ç»„ï¼ˆä»é£ä¹¦è·å–ï¼Œå¦‚ ['S', 'M', 'L', 'XL']ï¼‰â€¨ */â€¨async function fillSizes(page1: Page, sizes: string[]): Promise<void> {â€¨  â€¨  console.log('\n========== å¡«å†™å°ºç åˆ†ç±» ==========');â€¨  console.log(`å°ºç åˆ—è¡¨: ${sizes.join(', ')}`);â€¨  console.log(`å°ºç æ•°é‡: ${sizes.length}`);â€¨  â€¨  try {â€¨    // æ­¥éª¤1ï¼šç‚¹å‡»å°ºç åŒºåŸŸâ€¨    console.log('\n[æ­¥éª¤1] ç‚¹å‡»å°ºç åŒºåŸŸ');â€¨    await page1.getByText(/å°ºç \(\d+\)é‡è¦æ’åº/).click();â€¨    await page1.waitForTimeout(500);â€¨    await page1.getByText(/å°ºç \(\d+\)é‡è¦/).click();â€¨    await page1.waitForTimeout(800);â€¨    â€¨    // æ­¥éª¤2ï¼šæ£€æŸ¥å½“å‰å°ºç è¾“å…¥æ¡†æ•°é‡â€¨    console.log('[æ­¥éª¤2] æ£€æŸ¥å½“å‰å°ºç è¾“å…¥æ¡†');â€¨    const currentInputs = await getSizeInputsCount(page1);â€¨    console.log(`  å½“å‰è¾“å…¥æ¡†æ•°é‡: ${currentInputs}`);â€¨    console.log(`  éœ€è¦çš„å°ºç æ•°é‡: ${sizes.length}`);â€¨    â€¨    // æ­¥éª¤3ï¼šæ£€æŸ¥æ˜¯å¦å¯ä»¥è·³è¿‡ï¼ˆæ•°é‡å’Œå€¼éƒ½åŒ¹é…ï¼‰â€¨    if (currentInputs === sizes.length) {â€¨      console.log('[æ­¥éª¤3] æ£€æŸ¥è¾“å…¥æ¡†çš„å€¼æ˜¯å¦åŒ¹é…');â€¨      const allMatch = await checkIfSizesMatch(page1, sizes);â€¨      â€¨      if (allMatch) {â€¨        console.log('âœ… å°ºç å·²æ­£ç¡®å¡«å†™ï¼Œè·³è¿‡æ­¤æ­¥éª¤\n');â€¨        return;â€¨      } else {â€¨        console.log('  è¾“å…¥æ¡†å€¼ä¸åŒ¹é…ï¼Œéœ€è¦é‡æ–°å¡«å†™');â€¨      }â€¨    }â€¨    â€¨    // æ­¥éª¤4ï¼šè°ƒæ•´è¾“å…¥æ¡†æ•°é‡â€¨    console.log('[æ­¥éª¤4] è°ƒæ•´è¾“å…¥æ¡†æ•°é‡');â€¨    if (currentInputs > sizes.length) {â€¨      console.log(`  åˆ é™¤å¤šä½™çš„è¾“å…¥æ¡† (éœ€è¦åˆ é™¤ ${currentInputs - sizes.length} ä¸ª)`);â€¨      await deleteSizeInputs(page1, currentInputs, sizes.length);â€¨    } else if (currentInputs < sizes.length) {â€¨      console.log(`  æ·»åŠ è¾“å…¥æ¡† (éœ€è¦æ·»åŠ  ${sizes.length - currentInputs} ä¸ª)`);â€¨      await addSizeInputs(page1, currentInputs, sizes.length);â€¨    }â€¨    â€¨    // æ­¥éª¤5ï¼šæŒ‰é¡ºåºå¡«å…¥å°ºç â€¨    console.log('\n[æ­¥éª¤5] æŒ‰é¡ºåºå¡«å…¥å°ºç ');â€¨    for (let i = 0; i < sizes.length; i++) {â€¨      const size = sizes[i];â€¨      console.log(`  å¡«å…¥ç¬¬${i + 1}ä¸ªå°ºç : ${size}`);â€¨      â€¨      await fillSingleSize(page1, i, size);â€¨    }â€¨    â€¨    console.log('\nâœ… å°ºç åˆ†ç±»å¡«å†™å®Œæˆ\n');â€¨    â€¨  } catch (error) {â€¨    console.error(`âŒ å°ºç å¡«å†™å¤±è´¥: ${error}`);â€¨    throw error;â€¨  }â€¨}â€¨â€¨/**â€¨ * è·å–å½“å‰å°ºç è¾“å…¥æ¡†æ•°é‡â€¨ */â€¨async function getSizeInputsCount(page1: Page): Promise<number> {â€¨  try {â€¨    // å°è¯•è·å–ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†â€¨    const firstInput = page1.locator(â€¨      '.next-select.next-select-auto-complete.next-size-medium.sell-o-combobox.sell-combobox-sale-props-item > .next-input > input'â€¨    );â€¨    const firstExists = await firstInput.count();â€¨    â€¨    if (firstExists === 0) {â€¨      return 0;â€¨    }â€¨    â€¨    // è·å–å…¶ä»–è¾“å…¥æ¡†â€¨    const otherInputs = page1.locator(â€¨      '.sell-component-common-sale-props-option-item > .sell-color-item-wrap > .next-select > .next-input > input'â€¨    );â€¨    const otherCount = await otherInputs.count();â€¨    â€¨    return 1 + otherCount;â€¨  } catch (e) {â€¨    return 0;â€¨  }â€¨}â€¨â€¨/**â€¨ * æ£€æŸ¥å°ºç è¾“å…¥æ¡†çš„å€¼æ˜¯å¦ä¸ç›®æ ‡å°ºç åŒ¹é…â€¨ */â€¨async function checkIfSizesMatch(page1: Page, targetSizes: string[]): Promise<boolean> {â€¨  try {â€¨    for (let i = 0; i < targetSizes.length; i++) {â€¨      const input = await getSizeInput(page1, i);â€¨      const currentValue = await input.inputValue();â€¨      â€¨      // è½¬æ¢ä¸ºå¤§å†™è¿›è¡Œæ¯”è¾ƒâ€¨      if (currentValue.toUpperCase() !== targetSizes[i].toUpperCase()) {â€¨        console.log(`    ç¬¬${i + 1}ä¸ªä¸åŒ¹é…: å½“å‰=${currentValue}, ç›®æ ‡=${targetSizes[i]}`);â€¨        return false;â€¨      }â€¨    }â€¨    â€¨    console.log('    æ‰€æœ‰å°ºç å€¼éƒ½åŒ¹é…');â€¨    return true;â€¨  } catch (e) {â€¨    return false;â€¨  }â€¨}â€¨â€¨/**â€¨ * è·å–æŒ‡å®šä½ç½®çš„å°ºç è¾“å…¥æ¡†â€¨ */â€¨async function getSizeInput(page1: Page, index: number) {â€¨  if (index === 0) {â€¨    // ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†â€¨    return page1.locator(â€¨      '.next-select.next-select-auto-complete.next-size-medium.sell-o-combobox.sell-combobox-sale-props-item > .next-input > input'â€¨    ).first();â€¨  } else {â€¨    // ç¬¬Nä¸ªè¾“å…¥æ¡†â€¨    return page1.locator(â€¨      `div:nth-child(${index + 1}) > .sell-component-common-sale-props-option-item > .sell-color-item-wrap > .next-select > .next-input > input`â€¨    );â€¨  }â€¨}â€¨â€¨/**â€¨ * åˆ é™¤å¤šä½™çš„å°ºç è¾“å…¥æ¡†â€¨ */â€¨async function deleteSizeInputs(â€¨  page1: Page, â€¨  currentCount: number, â€¨  targetCount: numberâ€¨): Promise<void> {â€¨  â€¨  const deleteCount = currentCount - targetCount;â€¨  â€¨  // ä»åå¾€å‰åˆ é™¤â€¨  for (let i = 0; i < deleteCount; i++) {â€¨    const indexToDelete = currentCount - i;â€¨    console.log(`    åˆ é™¤ç¬¬${indexToDelete}ä¸ªè¾“å…¥æ¡†`);â€¨    â€¨    // åˆ é™¤æŒ‰é’®å®šä½â€¨    const deleteButton = page1.locator(â€¨      `div:nth-child(${indexToDelete}) > .sell-component-common-sale-props-option-item > .sell-color-item-wrap > .next-btn`â€¨    );â€¨    â€¨    await deleteButton.click();â€¨    await page1.waitForTimeout(500);â€¨  }â€¨}â€¨â€¨/**â€¨ * æ·»åŠ æ›´å¤šå°ºç è¾“å…¥æ¡†â€¨ */â€¨async function addSizeInputs(â€¨  page1: Page, â€¨  currentCount: number, â€¨  targetCount: numberâ€¨): Promise<void> {â€¨  â€¨  const addCount = targetCount - currentCount;â€¨  â€¨  for (let i = 0; i < addCount; i++) {â€¨    console.log(`    æ·»åŠ ç¬¬${currentCount + i + 1}ä¸ªè¾“å…¥æ¡†`);â€¨    â€¨    // åœ¨æ·»åŠ ä¹‹å‰ï¼Œå…ˆå¡«å…¥å½“å‰æœ€åä¸€ä¸ªè¾“å…¥æ¡†ï¼ˆå¿…é¡»å¡«å…¥æ‰èƒ½æ·»åŠ ï¼‰â€¨    const lastInput = await getSizeInput(page1, currentCount + i - 1);â€¨    const isLastInputFilled = await lastInput.inputValue();â€¨    â€¨    if (!isLastInputFilled) {â€¨      console.log(`      æç¤º: éœ€è¦å…ˆå¡«å…¥ç¬¬${currentCount + i}ä¸ªè¾“å…¥æ¡†æ‰èƒ½æ·»åŠ `);â€¨      await fillSingleSize(page1, currentCount + i - 1, 'S');  // å¡«å…¥ä¸´æ—¶å€¼â€¨    }â€¨    â€¨    // ç‚¹å‡»æ·»åŠ æŒ‰é’®â€¨    await page1.getByRole('button', { name: '' }).nth(1).click();â€¨    await page1.waitForTimeout(800);â€¨  }â€¨}â€¨â€¨/**â€¨ * å¡«å…¥å•ä¸ªå°ºç â€¨ */â€¨async function fillSingleSize(page1: Page, index: number, size: string): Promise<void> {â€¨  â€¨  // 1. ç‚¹å‡»è¾“å…¥æ¡†â€¨  const input = await getSizeInput(page1, index);â€¨  await input.click();â€¨  await page1.waitForTimeout(500);â€¨  â€¨  // 2. ç‚¹å‡»æœç´¢æ¡†â€¨  await page1.locator('.options-search > .next-input > input').click();â€¨  await page1.waitForTimeout(300);â€¨  â€¨  // 3. æ¸…ç©ºå¹¶è¾“å…¥å°ºç â€¨  await page1.locator('.next-input.next-focus > input').clear();â€¨  await page1.locator('.next-input.next-focus > input').fill(size.toLowerCase());â€¨  await page1.waitForTimeout(500);â€¨  â€¨  // 4. ç‚¹å‡»åŒ¹é…çš„å°ºç é€‰é¡¹â€¨  // ä½¿ç”¨æ­£åˆ™åŒ¹é…ï¼Œæ”¯æŒ "S", "S (xxx)" ç­‰æ ¼å¼â€¨  try {â€¨    // å…ˆå°è¯•ç²¾ç¡®åŒ¹é…â€¨    await page1.getByTitle(size.toUpperCase(), { exact: true }).click({ timeout: 2000 });â€¨  } catch (e) {â€¨    // å¦‚æœç²¾ç¡®åŒ¹é…å¤±è´¥ï¼Œä½¿ç”¨æ¨¡ç³ŠåŒ¹é…â€¨    await page1.getByTitle(new RegExp(`^${size.toUpperCase()}`, 'i')).first().click();â€¨  }â€¨  â€¨  await page1.waitForTimeout(500);â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹1ï¼š4ä¸ªå°ºç â€¨ */â€¨async function example1(page1: Page) {â€¨  const sizesFromFeishu = ['S', 'M', 'L', 'XL'];â€¨  await fillSizes(page1, sizesFromFeishu);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹2ï¼š2ä¸ªå°ºç â€¨ */â€¨async function example2(page1: Page) {â€¨  const sizesFromFeishu = ['M', 'L'];â€¨  await fillSizes(page1, sizesFromFeishu);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹3ï¼š6ä¸ªå°ºç â€¨ */â€¨async function example3(page1: Page) {â€¨  const sizesFromFeishu = ['S', 'M', 'L', 'XL', 'XXL', 'XXXL'];â€¨  await fillSizes(page1, sizesFromFeishu);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹4ï¼šä»é£ä¹¦è·å–å°ºç å­—ç¬¦ä¸²å¹¶å¤„ç†â€¨ */â€¨async function example4(page1: Page) {â€¨  // é£ä¹¦è·å–çš„å°ºç å­—ç¬¦ä¸²ï¼ˆå¤šè¡Œï¼‰â€¨  const sizeString = `Sâ€¨Mâ€¨Lâ€¨XL`;â€¨  â€¨  // åˆ†å‰²æˆæ•°ç»„â€¨  const sizes = sizeString.trim().split('\n').map(s => s.trim()).filter(s => s);â€¨  â€¨  await fillSizes(page1, sizes);â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { fillSizes };â€¨ä½¿ç”¨æ–¹æ³•â€¨typescriptâ€¨import { test } from '@playwright/test';â€¨import { fillSizes } from './fill-sizes';â€¨â€¨test('å¡«å†™å°ºç ', async ({ page }) => {â€¨  // ... å‰é¢çš„æ“ä½œ ...â€¨  â€¨  // ä»é£ä¹¦è·å–å°ºç ï¼ˆå¯èƒ½æ˜¯å¤šè¡Œå­—ç¬¦ä¸²ï¼‰â€¨  const sizeStringFromFeishu = `Sâ€¨Mâ€¨Lâ€¨XL`;â€¨  â€¨  // è½¬æ¢æˆæ•°ç»„â€¨  const sizes = sizeStringFromFeishu.trim().split('\n').map(s => s.trim()).filter(s => s);â€¨  â€¨  // å¡«å†™å°ºç â€¨  await fillSizes(page, sizes);â€¨  â€¨  // ... åç»­æ“ä½œ ...â€¨});â€¨æ ¸å¿ƒé€»è¾‘è¯´æ˜â€¨1. æ£€æŸ¥æ˜¯å¦å¯è·³è¿‡â€¨typescriptâ€¨if (æ•°é‡åŒ¹é… && æ‰€æœ‰å€¼éƒ½åŒ¹é…) {â€¨  è·³è¿‡â€¨} else {â€¨  é‡æ–°å¡«å†™â€¨}â€¨2. è¾“å…¥æ¡†å®šä½è§„åˆ™â€¨ä½ç½®å®šä½å™¨â€¨ç¬¬1ä¸ª.next-select...sell-combobox-sale-props-item > .next-input > input (first)â€¨ç¬¬2ä¸ªdiv:nth-child(2) > ... > .next-select > .next-input > inputâ€¨ç¬¬Nä¸ªdiv:nth-child(N) > ... > .next-select > .next-input > inputâ€¨3. åˆ é™¤æŒ‰é’®å®šä½â€¨typescriptâ€¨`div:nth-child(${N}) > .sell-component-common-sale-props-option-item > .sell-color-item-wrap > .next-btn`â€¨4. å¡«å…¥å•ä¸ªå°ºç æµç¨‹â€¨typescriptâ€¨1. ç‚¹å‡»è¾“å…¥æ¡†â€¨2. ç‚¹å‡»æœç´¢æ¡†â€¨3. æ¸…ç©ºå¹¶è¾“å…¥å°ºç ï¼ˆå°å†™ï¼‰â€¨4. ç‚¹å‡»åŒ¹é…é¡¹ï¼ˆå…ˆç²¾ç¡®åŒ¹é…ï¼Œå¤±è´¥åˆ™æ¨¡ç³ŠåŒ¹é…ï¼‰â€¨```â€¨â€¨## æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹â€¨```â€¨========== å¡«å†™å°ºç åˆ†ç±» ==========â€¨å°ºç åˆ—è¡¨: S, M, L, XLâ€¨å°ºç æ•°é‡: 4â€¨â€¨[æ­¥éª¤1] ç‚¹å‡»å°ºç åŒºåŸŸâ€¨â€¨[æ­¥éª¤2] æ£€æŸ¥å½“å‰å°ºç è¾“å…¥æ¡†â€¨  å½“å‰è¾“å…¥æ¡†æ•°é‡: 4â€¨  éœ€è¦çš„å°ºç æ•°é‡: 4â€¨â€¨[æ­¥éª¤3] æ£€æŸ¥è¾“å…¥æ¡†çš„å€¼æ˜¯å¦åŒ¹é…â€¨    æ‰€æœ‰å°ºç å€¼éƒ½åŒ¹é…â€¨âœ… å°ºç å·²æ­£ç¡®å¡«å†™,è·³è¿‡æ­¤æ­¥éª¤â€¨```â€¨â€¨æˆ–è€…éœ€è¦ä¿®æ”¹æ—¶ï¼šâ€¨```â€¨========== å¡«å†™å°ºç åˆ†ç±» ==========â€¨å°ºç åˆ—è¡¨: S, M, L, XLâ€¨å°ºç æ•°é‡: 4â€¨â€¨[æ­¥éª¤1] ç‚¹å‡»å°ºç åŒºåŸŸâ€¨â€¨[æ­¥éª¤2] æ£€æŸ¥å½“å‰å°ºç è¾“å…¥æ¡†â€¨  å½“å‰è¾“å…¥æ¡†æ•°é‡: 2â€¨  éœ€è¦çš„å°ºç æ•°é‡: 4â€¨â€¨[æ­¥éª¤4] è°ƒæ•´è¾“å…¥æ¡†æ•°é‡â€¨  æ·»åŠ è¾“å…¥æ¡† (éœ€è¦æ·»åŠ  2 ä¸ª)â€¨    æ·»åŠ ç¬¬3ä¸ªè¾“å…¥æ¡†â€¨    æ·»åŠ ç¬¬4ä¸ªè¾“å…¥æ¡†â€¨â€¨[æ­¥éª¤5] æŒ‰é¡ºåºå¡«å…¥å°ºç â€¨  å¡«å…¥ç¬¬1ä¸ªå°ºç : Sâ€¨  å¡«å…¥ç¬¬2ä¸ªå°ºç : Mâ€¨  å¡«å…¥ç¬¬3ä¸ªå°ºç : Lâ€¨  å¡«å…¥ç¬¬4ä¸ªå°ºç : XLâ€¨â€¨âœ… å°ºç åˆ†ç±»å¡«å†™å®Œæˆ
10ã€ä»·æ ¼å’Œå•†å“id
Pythonâ€¨typescriptâ€¨import { Page } from '@playwright/test';â€¨â€¨/**â€¨ * å¡«å†™å•†å“ä»·æ ¼ã€æ•°é‡å’Œå•†å®¶ç¼–ç â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ * @param productData - å•†å“æ•°æ®â€¨ * @param productData.price - ä»·æ ¼ï¼ˆä»é£ä¹¦è·å–ï¼Œçº¯æ•°å­—ï¼‰â€¨ * @param productData.productId - å•†å“IDï¼ˆä»é£ä¹¦è·å–ï¼Œä½œä¸ºå•†å®¶ç¼–ç ï¼‰â€¨ */â€¨async function fillPriceAndStock(â€¨  page1: Page,â€¨  productData: {â€¨    price: string | number;â€¨    productId: string;â€¨  }â€¨): Promise<void> {â€¨  â€¨  console.log('\n========== å¡«å†™ä»·æ ¼ã€æ•°é‡å’Œå•†å®¶ç¼–ç  ==========');â€¨  console.log(`ä»·æ ¼: ${productData.price}`);â€¨  console.log(`æ•°é‡: 3 (å›ºå®š)`);â€¨  console.log(`å•†å®¶ç¼–ç : ${productData.productId}`);â€¨  â€¨  try {â€¨    // ==================== ç¬¬ä¸€éƒ¨åˆ†ï¼šå¡«å†™ä»·æ ¼ ====================â€¨    console.log('\n[æ­¥éª¤1] å¡«å†™ä»·æ ¼');â€¨    â€¨    const priceInput = page1.getByRole('textbox', { name: 'ä»·æ ¼' });â€¨    await priceInput.click();â€¨    await page1.waitForTimeout(300);â€¨    await priceInput.clear();â€¨    await priceInput.fill(String(productData.price));â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log(`  âœ… ä»·æ ¼å·²å¡«å†™: ${productData.price}`);â€¨    â€¨    // ==================== ç¬¬äºŒéƒ¨åˆ†ï¼šå¡«å†™æ•°é‡ ====================â€¨    console.log('\n[æ­¥éª¤2] å¡«å†™æ•°é‡');â€¨    â€¨    const quantityInput = page1.getByRole('textbox', { name: 'æ•°é‡' });â€¨    await quantityInput.click();â€¨    await page1.waitForTimeout(300);â€¨    await quantityInput.clear();â€¨    await quantityInput.fill('3');â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log('  âœ… æ•°é‡å·²å¡«å†™: 3');â€¨    â€¨    // ==================== ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ‰¹é‡å¡«å†™ ====================â€¨    console.log('\n[æ­¥éª¤3] ç‚¹å‡»æ‰¹é‡å¡«å†™');â€¨    â€¨    await page1.getByRole('button', { name: 'æ‰¹é‡å¡«å†™' }).click();â€¨    await page1.waitForTimeout(1000);â€¨    â€¨    console.log('  âœ… ä»·æ ¼å’Œæ•°é‡å·²æ‰¹é‡åº”ç”¨åˆ°æ‰€æœ‰SKU');â€¨    â€¨    // ==================== ç¬¬å››éƒ¨åˆ†ï¼šå¡«å†™å•†å®¶ç¼–ç  ====================â€¨    console.log('\n[æ­¥éª¤4] å¡«å†™å•†å®¶ç¼–ç ');â€¨    â€¨    // 4.1 ç‚¹å‡»å•†å®¶ç¼–ç åŒºåŸŸâ€¨    await page1.getByText(/å•†å®¶ç¼–ç \d+\//).click();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    // 4.2 å®šä½è¾“å…¥æ¡†å¹¶å¡«å…¥å•†å“IDâ€¨    const merchantCodeInput = page1.locator('.next-input.next-focus > input');â€¨    await merchantCodeInput.click();â€¨    await page1.waitForTimeout(300);â€¨    await merchantCodeInput.clear();â€¨    await merchantCodeInput.fill(productData.productId);â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log(`  âœ… å•†å®¶ç¼–ç å·²å¡«å†™: ${productData.productId}`);â€¨    â€¨    console.log('\n========== ä»·æ ¼ã€æ•°é‡å’Œå•†å®¶ç¼–ç å¡«å†™å®Œæˆ ==========\n');â€¨    â€¨  } catch (error) {â€¨    console.error(`âŒ å¡«å†™å¤±è´¥: ${error}`);â€¨    throw error;â€¨  }â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹1ï¼šåŸºæœ¬ä½¿ç”¨â€¨ */â€¨async function example1(page1: Page) {â€¨  const productData = {â€¨    price: '12415',â€¨    productId: 'C25217200'â€¨  };â€¨  â€¨  await fillPriceAndStock(page1, productData);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹2ï¼šä»·æ ¼ä¸ºæ•°å­—ç±»å‹â€¨ */â€¨async function example2(page1: Page) {â€¨  const productData = {â€¨    price: 12415,  // æ•°å­—ç±»å‹ä¹Ÿæ”¯æŒâ€¨    productId: 'C25217200'â€¨  };â€¨  â€¨  await fillPriceAndStock(page1, productData);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹3ï¼šä»é£ä¹¦è·å–æ•°æ®â€¨ */â€¨async function example3(page1: Page) {â€¨  // ä»é£ä¹¦è·å–çš„æ•°æ®â€¨  const productFromFeishu = {â€¨    productId: 'C25217200',â€¨    price: '15800'  // é£ä¹¦ä»·æ ¼åˆ—â€¨  };â€¨  â€¨  await fillPriceAndStock(page1, {â€¨    price: productFromFeishu.price,â€¨    productId: productFromFeishu.productIdâ€¨  });â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { fillPriceAndStock };â€¨ä½¿ç”¨æ–¹æ³•â€¨typescriptâ€¨import { test } from '@playwright/test';â€¨import { fillPriceAndStock } from './fill-price-stock';â€¨â€¨test('å¡«å†™ä»·æ ¼å’Œåº“å­˜', async ({ page }) => {â€¨  // ... å‰é¢çš„æ“ä½œ ...â€¨  â€¨  // ä»é£ä¹¦è·å–æ•°æ®â€¨  const productData = {â€¨    productId: 'C25217200',  // å•†å“IDåˆ—â€¨    price: '15800'           // ä»·æ ¼åˆ—â€¨  };â€¨  â€¨  // å¡«å†™ä»·æ ¼ã€æ•°é‡ã€å•†å®¶ç¼–ç â€¨  await fillPriceAndStock(page, productData);â€¨  â€¨  // ... åç»­æ“ä½œ ...â€¨});â€¨```â€¨â€¨## æ“ä½œæ­¥éª¤è¯´æ˜â€¨â€¨| æ­¥éª¤ | æ“ä½œ | å…ƒç´ å®šä½ | ç­‰å¾…æ—¶é—´ | è¯´æ˜ |â€¨|-----|------|---------|---------|------|â€¨| 1 | å¡«å†™ä»·æ ¼ | `getByRole('textbox', { name: 'ä»·æ ¼' })` | 500ms | ä»é£ä¹¦è·å–ä»·æ ¼å€¼ |â€¨| 2 | å¡«å†™æ•°é‡ | `getByRole('textbox', { name: 'æ•°é‡' })` | 500ms | å›ºå®šå¡«å†™"3" |â€¨| 3 | æ‰¹é‡å¡«å†™ | `getByRole('button', { name: 'æ‰¹é‡å¡«å†™' })` | 1000ms | åº”ç”¨åˆ°æ‰€æœ‰SKUç»„åˆ |â€¨| 4.1 | ç‚¹å‡»å•†å®¶ç¼–ç åŒºåŸŸ | `getByText(/å•†å®¶ç¼–ç \d+\//)` | 500ms | ä½¿ç”¨æ­£åˆ™åŒ¹é… |â€¨| 4.2 | å¡«å…¥å•†å“ID | `locator('.next-input.next-focus > input')` | 500ms | ä½œä¸ºå•†å®¶ç¼–ç  |â€¨â€¨## æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹â€¨```â€¨========== å¡«å†™ä»·æ ¼ã€æ•°é‡å’Œå•†å®¶ç¼–ç  ==========â€¨ä»·æ ¼: 15800â€¨æ•°é‡: 3 (å›ºå®š)â€¨å•†å®¶ç¼–ç : C25217200â€¨â€¨[æ­¥éª¤1] å¡«å†™ä»·æ ¼â€¨  âœ… ä»·æ ¼å·²å¡«å†™: 15800â€¨â€¨[æ­¥éª¤2] å¡«å†™æ•°é‡â€¨  âœ… æ•°é‡å·²å¡«å†™: 3â€¨â€¨[æ­¥éª¤3] ç‚¹å‡»æ‰¹é‡å¡«å†™â€¨  âœ… ä»·æ ¼å’Œæ•°é‡å·²æ‰¹é‡åº”ç”¨åˆ°æ‰€æœ‰SKUâ€¨â€¨[æ­¥éª¤4] å¡«å†™å•†å®¶ç¼–ç â€¨  âœ… å•†å®¶ç¼–ç å·²å¡«å†™: C25217200â€¨â€¨========== ä»·æ ¼ã€æ•°é‡å’Œå•†å®¶ç¼–ç å¡«å†™å®Œæˆ ==========â€¨æ³¨æ„äº‹é¡¹â€¨ä»·æ ¼åªèƒ½æ˜¯æ•°å­—ï¼Œå‡½æ•°ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²â€¨æ•°é‡å›ºå®šä¸º3ï¼Œä¸éœ€è¦ä»é£ä¹¦è·å–â€¨æ‰¹é‡å¡«å†™ä¼šåº”ç”¨åˆ°æ‰€æœ‰é¢œè‰²xå°ºç ç»„åˆâ€¨å•†å®¶ç¼–ç ä½¿ç”¨å•†å“IDï¼Œä»é£ä¹¦çš„å•†å“IDåˆ—è·å–
11ã€3:4ä¸»å›¾
JavaScriptâ€¨typescriptâ€¨import { Page } from '@playwright/test';â€¨â€¨/**â€¨ * è£å‰ª3:4ä¸»å›¾â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ */â€¨async function cropThreeToFourImage(page1: Page): Promise<void> {â€¨  â€¨  console.log('\n========== è£å‰ª3:4ä¸»å›¾ ==========');â€¨  â€¨  try {â€¨    // æ­¥éª¤1ï¼šæ»šåŠ¨åˆ°3:4ä¸»å›¾åŒºåŸŸï¼ˆå¯é€‰ï¼Œç¡®ä¿æŒ‰é’®å¯è§ï¼‰â€¨    console.log('[æ­¥éª¤1] å®šä½3:4ä¸»å›¾åŒºåŸŸ');â€¨    await page1.getByText('3:4ä¸»å›¾å›¾ç‰‡è¦æ±‚ï¼šå®½é«˜æ¯”ä¸º3:4ï¼Œæ¨èå°ºå¯¸').scrollIntoViewIfNeeded();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    // æ­¥éª¤2ï¼šç‚¹å‡»"ä»1:1ä¸»å›¾è£å‰ª"æŒ‰é’®â€¨    console.log('[æ­¥éª¤2] ç‚¹å‡»è£å‰ªæŒ‰é’®');â€¨    await page1.getByRole('button', { name: 'ä»1:1ä¸»å›¾è£å‰ª' }).click();â€¨    â€¨    // æ­¥éª¤3ï¼šç­‰å¾…è£å‰ªå®Œæˆâ€¨    console.log('[æ­¥éª¤3] ç­‰å¾…è£å‰ªå®Œæˆ');â€¨    await page1.waitForTimeout(2000);â€¨    â€¨    console.log('âœ… 3:4ä¸»å›¾è£å‰ªå®Œæˆ\n');â€¨    â€¨  } catch (error) {â€¨    console.error(`âŒ è£å‰ªå¤±è´¥: ${error}`);â€¨    throw error;â€¨  }â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹ï¼šè£å‰ª3:4ä¸»å›¾â€¨ */â€¨async function example(page1: Page) {â€¨  await cropThreeToFourImage(page1);â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { cropThreeToFourImage };â€¨ä½¿ç”¨æ–¹æ³•â€¨typescriptâ€¨import { test } from '@playwright/test';â€¨import { cropThreeToFourImage } from './crop-image';â€¨â€¨test('è£å‰ª3:4ä¸»å›¾', async ({ page }) => {â€¨  // ... å‰é¢çš„æ“ä½œ ...â€¨  â€¨  // è£å‰ª3:4ä¸»å›¾â€¨  await cropThreeToFourImage(page);â€¨  â€¨  // ... åç»­æ“ä½œ ...â€¨});â€¨```â€¨â€¨## æ“ä½œæ­¥éª¤è¯´æ˜â€¨â€¨| æ­¥éª¤ | æ“ä½œ | ç­‰å¾…æ—¶é—´ | è¯´æ˜ |â€¨|-----|------|---------|------|â€¨| 1 | æ»šåŠ¨åˆ°3:4ä¸»å›¾åŒºåŸŸ | 500ms | ç¡®ä¿æŒ‰é’®å¯è§ |â€¨| 2 | ç‚¹å‡»"ä»1:1ä¸»å›¾è£å‰ª" | - | å¼€å§‹è£å‰ª |â€¨| 3 | ç­‰å¾… | 2000ms | è£å‰ªå¤„ç†å®Œæˆ |â€¨â€¨## æ§åˆ¶å°è¾“å‡ºâ€¨```â€¨========== è£å‰ª3:4ä¸»å›¾ ==========â€¨[æ­¥éª¤1] å®šä½3:4ä¸»å›¾åŒºåŸŸâ€¨[æ­¥éª¤2] ç‚¹å‡»è£å‰ªæŒ‰é’®â€¨[æ­¥éª¤3] ç­‰å¾…è£å‰ªå®Œæˆâ€¨âœ… 3:4ä¸»å›¾è£å‰ªå®Œæˆ
12ã€æ¨¡ç‰ˆå¤„ç†(æˆ‘å†™çš„ï¼‰
Pythonâ€¨æˆ‘ä»¬é¦–å…ˆæ‰¾åˆ°æ¨¡ç‰ˆçš„ä½ç½®â€¨  await page1.locator('.rich-text-editor-ecskZR > p:nth-child(13) > img:nth-child(7)').click();â€¨ è¿™é‡Œçš„å…ƒç´ è™½ç„¶æ˜¯ç‚¹å‡»çš„æ“ä½œï¼Œä½†æ˜¯æˆ‘æ˜¯åªæ˜¯æƒ³é€šè¿‡è¿™ä¸ªå®šä½ä¸ªä½ç½®ã€‚åªè¦æŠŠé¼ æ ‡æ”¾åœ¨è¿™ä¸ªä½ç½®ä»–å°±æœ‰ä¸‹æ‹‰æ¡†çš„å‡ºç°ã€‚â€¨ æ¥ç€æˆ‘ä»¬å»ç‚¹å‡»ä¸‹æ‹‰æ¡†é‡Œçš„åˆ é™¤æŒ‰é’®â€¨ await page1.locator('div').filter({ hasText: /^åˆ é™¤$/ }).click();  è¿™ä¸ªæ˜¯çœŸç‚¹å‡»â€¨ ä¹‹åç‚¹å‡»æ¨¡ç‰ˆæŒ‰é’®ï¼Œè¿™é‡Œçš„åŠ¨ä½œä¹Ÿæ˜¯ç‚¹å‡»ï¼Œæˆ–è€…æŠŠé¼ æ ‡æ”¾åœ¨ä¸Šé¢ä¹Ÿå¯ä»¥å‡ºä¸‹æ‹‰æ¡†ï¼Œç›®çš„å°±æ˜¯æ‰¾å¯»ä¸‹æ‹‰æ¡†â€¨  await page1.locator('#panel_edit').getByText('æ¨¡æ¿', { exact: true }).click();â€¨  ç„¶åç‚¹å‡»  await page1.getByText('å¡-LL=').click();è¿™ä¸ªå…ƒç´ ï¼Œè¿™ä¸ªå…ƒç´ æš‚æ—¶ä¸å˜ã€‚â€¨  â€¨  ä¹‹åæˆ‘ä»¬éœ€è¦ç‚¹å‡»æ¨¡ç‰ˆ  ä¹Ÿå°±æ˜¯è¿™ä¸ªå…ƒç´ ï¼Œè¿™é‡Œæ˜¯ç‚¹å‡»ã€‚await page1.locator('p:nth-child(12) > img').click();â€¨  æ¥ç€ä¼šå¼¹å‡ºä¸€ä¸ªæ–°çš„å°çª—å£ï¼Œurlä¸å˜ã€‚â€¨  â€¨  è¿›å…¥æ–°çš„çª—å£ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ç‚¹å‡»await page1.getByLabel('ç¼–è¾‘æ¨¡å—').getByRole('paragraph').filter({ hasText: 'æ³¨ï¼šSS=XSï¼ŒLL=XLï¼Œ3L=XXLï¼Œ4L=XXXL' }).click();è¿™ä¸ªå…ƒç´ â€¨  ä¹‹åæˆ‘ç”¨é”®ç›˜è¾“å…¥äº†å¾ˆå¤šå³ç®­å¤´ï¼Œå› ä¸ºåˆšæ‰ç”¨å®šä½åªèƒ½å®šä½åˆ°è¿™é‡Œä¸­é—´çš„ä½ç½®ï¼Œå¦‚æœä½ èƒ½ä¸‹æŒ‡ä»¤ç‚¹å‡»è¿™ä¸ªå…ƒç´ æœ€å³è¾¹ä¹Ÿè¡Œï¼Œç„¶åç”¨æ¨¡æ‹Ÿé”®ç›˜ç‚¹å‡»å›è½¦ã€‚â€¨  â€¨  è¿™é‡Œè®©æˆ‘ä»¬éœ€è¦å…ˆè°ƒç”¨ä¸€ä¸ªå†…å®¹è¾“å…¥ï¼Œé‚£å°±æ˜¯é£ä¹¦é‡Œçš„å•†å“idå¯¹åº”çš„è¯¦æƒ…é¡µæ–‡å­—ï¼Œæˆ‘ä»¬è·å–åˆ°å†…å®¹ä¹‹åï¼Œå¯ä»¥å¤åˆ¶é»è´´ï¼Œç›´æ¥å¡«å…¥åˆšæ‰å›è½¦åçš„ä½ç½®â€¨  ä¹‹åæˆ‘ä»¬éœ€è¦æŠŠå›¾ç‰‡æ·»åŠ è¿›å»ã€‚â€¨    å…ˆç‚¹å‡»è¿™ä¸ªå›¾æ ‡await page1.getByRole('button', { name: 'å›¾åƒ' }).click();â€¨    ç„¶åç‚¹å‡»  è¿™ä¸ªå…ƒç´ è¾“å…¥å•†å“ID  await page1.locator('iframe').nth(5).contentFrame().getByRole('combobox', { name: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°' }).click();â€¨  await page1.locator('iframe').nth(5).contentFrame().getByRole('combobox', { name: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°' }).fill('124');â€¨  è¿™é‡Œçš„124å°±æ˜¯æˆ‘æ¨¡æ‹Ÿè¾“å…¥çš„å•†å“IDâ€¨  è¾“å…¥å®ŒID ä¹‹åå°±å‡ºç°äº†æ–‡ä»¶å¤¹ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦ç‚¹å‡»æ–‡ä»¶å¤¹ä¹Ÿå°±æ˜¯ä¸‹é¢çš„å…ƒç´ ã€‚â€¨â€¨    await page1.locator('iframe').nth(5).contentFrame().locator('.next-menu-item-inner').first().click();â€¨  ç‚¹å‡»å®Œæˆå æˆ‘ä»¬ ç‚¹å‡»è¿™ä¸ªæŒ‰é’®-é€‰æ‹©æ–‡ä»¶åå‡åºâ€¨   await page1.locator('iframe').nth(5).contentFrame().getByRole('button').first().click();â€¨  await page1.locator('iframe').nth(5).contentFrame().getByRole('option', { name: 'æ–‡ä»¶åå‡åº' }).click();â€¨  â€¨  æ¥ç€æˆ‘ä»¬éœ€è¦æŒ‰ç…§é¡ºåºæŒ¨ä¸ªç‚¹å‡»å›¾ç‰‡ å°±åƒä¸‹é¢çš„è¿™ä¸ªä»£ç ã€‚â€¨  æœ€å¤šç‚¹å‡»22ä¸‹ï¼Œå¦‚æœä¸å¤Ÿ22å°±æœ‰å‡ ä¸ªè¿™ä¸ªdiv:nth-childå€¼å°±ç‚¹å‡»å¤šå°‘ä¸‹ã€‚æœ€å¤š22â€¨  ç„¶åç‚¹å‡»ç¡®å®šâ€¨  await page1.locator('iframe').nth(5).contentFrame().locator('.PicList_hoverBK__zH1fy').first().click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(2) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(3) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(4) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(5) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(6) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(7) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(8) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(9) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(10) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(11) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(12) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(13) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(14) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(15) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(16) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(17) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(18) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(19) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(20) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(21) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(22) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().getByRole('button', { name: 'ç¡®å®šï¼ˆ22ï¼‰' }).click();â€¨ â€¨ å°±å…³é—­äº†æ–°å¼€çš„è¿™ä¸ªå°çª—å£ã€‚ä¸‹é¢æ˜¯æµç¨‹ç¤ºæ„ã€‚â€¨ â€¨import { test, expect } from '@playwright/test';â€¨â€¨test('test', async ({ page }) => {â€¨  await page1.locator('.rich-text-editor-ecskZR > p:nth-child(13) > img:nth-child(7)').click();â€¨  await page1.locator('div').filter({ hasText: /^åˆ é™¤$/ }).click();â€¨  await page1.locator('#panel_edit').getByText('æ¨¡æ¿', { exact: true }).click();â€¨  await page1.getByText('å¡-LL=').click();â€¨  await page1.locator('p:nth-child(12) > img').click();â€¨  await page1.getByLabel('ç¼–è¾‘æ¨¡å—').getByRole('paragraph').filter({ hasText: 'æ³¨ï¼šSS=XSï¼ŒLL=XLï¼Œ3L=XXLï¼Œ4L=XXXL' }).click();â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('textbox', { name: 'æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨, group17622410445620' }).press('ArrowRight');â€¨  await page1.getByRole('button', { name: 'å›¾åƒ' }).click();â€¨  await page1.locator('iframe').nth(5).contentFrame().getByRole('combobox', { name: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°' }).click();â€¨  await page1.locator('iframe').nth(5).contentFrame().getByRole('combobox', { name: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°' }).fill('124');â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('.next-menu-item-inner').first().click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('.PicList_hoverBK__zH1fy').first().click();â€¨  await page1.locator('iframe').nth(5).contentFrame().getByRole('button').first().click();â€¨  await page1.locator('iframe').nth(5).contentFrame().getByRole('option', { name: 'æ–‡ä»¶åå‡åº' }).click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('.PicList_hoverBK__zH1fy').first().click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(2) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(3) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(4) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(5) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(6) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(7) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(8) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(9) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(10) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(11) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(12) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(13) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(14) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(15) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(16) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(17) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(18) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(19) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(20) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(21) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().locator('div:nth-child(22) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy').click();â€¨  await page1.locator('iframe').nth(5).contentFrame().getByRole('button', { name: 'ç¡®å®šï¼ˆ22ï¼‰' }).click();â€¨  await page1.getByRole('button', { name: 'ç¡®å®š' }).click();â€¨â€¨});â€¨â€¨â€¨
12ã€æ¨¡ç‰ˆå¤„ç†
JavaScriptâ€¨typescriptâ€¨import { Page } from '@playwright/test';â€¨â€¨/**â€¨ * å¡«å†™å•†å“è¯¦æƒ…é¡µï¼ˆåˆ é™¤æ—§æ¨¡æ¿ã€æ·»åŠ æ–°æ¨¡æ¿ã€å¡«å…¥æ–‡å­—ã€æ·»åŠ å›¾ç‰‡ï¼‰â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡â€¨ * @param productData - å•†å“æ•°æ®â€¨ * @param productData.productId - å•†å“IDï¼ˆç”¨äºå®šä½å›¾ç‰‡æ–‡ä»¶å¤¹ï¼‰â€¨ * @param productData.detailText - è¯¦æƒ…é¡µæ–‡å­—ï¼ˆä»é£ä¹¦è·å–ï¼‰â€¨ */â€¨async function fillProductDetail(â€¨  page1: Page,â€¨  productData: {â€¨    productId: string;â€¨    detailText: string;â€¨  }â€¨): Promise<void> {â€¨  â€¨  console.log('\n========== å¡«å†™å•†å“è¯¦æƒ…é¡µ ==========');â€¨  console.log(`å•†å“ID: ${productData.productId}`);â€¨  console.log(`è¯¦æƒ…æ–‡å­—é•¿åº¦: ${productData.detailText.length}å­—`);â€¨  â€¨  try {â€¨    // ==================== ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ é™¤æ—§æ¨¡æ¿ ====================â€¨    console.log('\n[Part 1] åˆ é™¤æ—§æ¨¡æ¿å†…å®¹');â€¨    â€¨    // 1.1 å®šä½æ—§æ¨¡æ¿ä½ç½®ï¼ˆhoverä¼šå‡ºç°ä¸‹æ‹‰æ¡†ï¼‰â€¨    await page1.locator('.rich-text-editor-ecskZR > p:nth-child(13) > img:nth-child(7)').hover();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    // 1.2 ç‚¹å‡»åˆ é™¤æŒ‰é’®â€¨    await page1.locator('div').filter({ hasText: /^åˆ é™¤$/ }).click();â€¨    await page1.waitForTimeout(800);â€¨    â€¨    console.log('  âœ… æ—§æ¨¡æ¿å·²åˆ é™¤');â€¨    â€¨    // ==================== ç¬¬äºŒéƒ¨åˆ†ï¼šæ·»åŠ æ–°æ¨¡æ¿ ====================â€¨    console.log('\n[Part 2] æ·»åŠ æ–°æ¨¡æ¿');â€¨    â€¨    // 2.1 ç‚¹å‡»æ¨¡æ¿æŒ‰é’®ï¼ˆhoverä¼šå‡ºç°ä¸‹æ‹‰æ¡†ï¼‰â€¨    await page1.locator('#panel_edit').getByText('æ¨¡æ¿', { exact: true }).hover();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    // 2.2 é€‰æ‹©æ¨¡æ¿"å¡-LL="ï¼ˆå›ºå®šæ¨¡æ¿åï¼‰â€¨    await page1.getByText('å¡-LL=').click();â€¨    await page1.waitForTimeout(1000);â€¨    â€¨    console.log('  âœ… æ–°æ¨¡æ¿å·²æ·»åŠ ');â€¨    â€¨    // ==================== ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ‰“å¼€æ¨¡æ¿ç¼–è¾‘çª—å£ ====================â€¨    console.log('\n[Part 3] æ‰“å¼€æ¨¡æ¿ç¼–è¾‘çª—å£');â€¨    â€¨    await page1.locator('p:nth-child(12) > img').click();â€¨    await page1.waitForTimeout(1500);â€¨    â€¨    console.log('  âœ… ç¼–è¾‘çª—å£å·²æ‰“å¼€');â€¨    â€¨    // ==================== ç¬¬å››éƒ¨åˆ†ï¼šç§»åŠ¨å…‰æ ‡åˆ°æœ€å³è¾¹å¹¶å›è½¦ ====================â€¨    console.log('\n[Part 4] å®šä½å…‰æ ‡ä½ç½®');â€¨    â€¨    // 4.1 ç‚¹å‡»æŒ‡å®šæ®µè½â€¨    await page1.getByLabel('ç¼–è¾‘æ¨¡å—').getByRole('paragraph').filter({ â€¨      hasText: 'æ³¨ï¼šSS=XSï¼ŒLL=XLï¼Œ3L=XXLï¼Œ4L=XXXL' â€¨    }).click();â€¨    await page1.waitForTimeout(300);â€¨    â€¨    // 4.2 ç§»åŠ¨åˆ°æœ€å³è¾¹ï¼ˆå°è¯•ç”¨Endé”®ï¼‰â€¨    const editor = page1.getByRole('textbox', { name: /æ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨/ });â€¨    â€¨    try {â€¨      // æ–¹å¼Aï¼šç›´æ¥æŒ‰Endé”®â€¨      console.log('  å°è¯•ä½¿ç”¨Endé”®ç§»åŠ¨åˆ°æœ€å³è¾¹');â€¨      await editor.press('End');â€¨      await page1.waitForTimeout(300);â€¨    } catch (e) {â€¨      // æ–¹å¼Bï¼šå¤šæ¬¡æŒ‰å³ç®­å¤´ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰â€¨      console.log('  Endé”®å¤±è´¥ï¼Œä½¿ç”¨å³ç®­å¤´é”®');â€¨      for (let i = 0; i < 50; i++) {â€¨        await editor.press('ArrowRight');â€¨      }â€¨      await page1.waitForTimeout(300);â€¨    }â€¨    â€¨    // 4.3 å›è½¦â€¨    await editor.press('Enter');â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log('  âœ… å…‰æ ‡å·²å°±ä½');â€¨    â€¨    // ==================== ç¬¬äº”éƒ¨åˆ†ï¼šå¡«å…¥è¯¦æƒ…é¡µæ–‡å­— ====================â€¨    console.log('\n[Part 5] å¡«å…¥è¯¦æƒ…é¡µæ–‡å­—');â€¨    â€¨    // ä½¿ç”¨typeé€å­—è¾“å…¥ï¼ˆæ›´ç¨³å®šï¼‰â€¨    await editor.type(productData.detailText, { delay: 10 });â€¨    await page1.waitForTimeout(800);â€¨    â€¨    console.log(`  âœ… å·²è¾“å…¥${productData.detailText.length}å­—`);â€¨    â€¨    // ==================== ç¬¬å…­éƒ¨åˆ†ï¼šæ·»åŠ å›¾ç‰‡ ====================â€¨    console.log('\n[Part 6] æ·»åŠ å›¾ç‰‡');â€¨    â€¨    // 6.1 ç‚¹å‡»å›¾åƒæŒ‰é’®â€¨    await page1.getByRole('button', { name: 'å›¾åƒ' }).click();â€¨    await page1.waitForTimeout(1000);â€¨    â€¨    // 6.2 è·å–iframeâ€¨    const imageFrame = page1.locator('iframe').nth(5).contentFrame();â€¨    â€¨    // 6.3 è¾“å…¥å•†å“IDæ‰¾åˆ°æ–‡ä»¶å¤¹â€¨    console.log(`  è¾“å…¥å•†å“ID: ${productData.productId}`);â€¨    await imageFrame.getByRole('combobox', { name: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°' }).click();â€¨    await imageFrame.getByRole('combobox', { name: 'è¯·è¾“å…¥æ–‡ä»¶å¤¹åç§°' }).fill(productData.productId);â€¨    await page1.waitForTimeout(1000);â€¨    â€¨    // 6.4 ç‚¹å‡»æ–‡ä»¶å¤¹â€¨    await imageFrame.locator('.next-menu-item-inner').first().click();â€¨    await page1.waitForTimeout(1500);â€¨    â€¨    // 6.5 é€‰æ‹©æ’åºæ–¹å¼ï¼šæ–‡ä»¶åå‡åºâ€¨    console.log('  è®¾ç½®æ–‡ä»¶åå‡åº');â€¨    await imageFrame.getByRole('button').first().click();â€¨    await page1.waitForTimeout(300);â€¨    await imageFrame.getByRole('option', { name: 'æ–‡ä»¶åå‡åº' }).click();â€¨    await page1.waitForTimeout(1000);â€¨    â€¨    // 6.6 æ£€æŸ¥å›¾ç‰‡æ•°é‡â€¨    const imageCount = await imageFrame.locator('.PicList_hoverBK__zH1fy').count();â€¨    const actualCount = Math.min(imageCount, 22); // æœ€å¤š22å¼ â€¨    console.log(`  æ£€æµ‹åˆ°${imageCount}å¼ å›¾ç‰‡ï¼Œå°†é€‰æ‹©å‰${actualCount}å¼ `);â€¨    â€¨    // 6.7 å¾ªç¯ç‚¹å‡»å›¾ç‰‡â€¨    for (let i = 1; i <= actualCount; i++) {â€¨      if (i === 1) {â€¨        // ç¬¬ä¸€å¼ å›¾ç‰‡â€¨        await imageFrame.locator('.PicList_hoverBK__zH1fy').first().click();â€¨      } else {â€¨        // ç¬¬Nå¼ å›¾ç‰‡â€¨        await imageFrame.locator(â€¨          `div:nth-child(${i}) > .PicList_pic_background__pGTdV > label > .PicList_hoverBK__zH1fy`â€¨        ).click();â€¨      }â€¨      â€¨      await page1.waitForTimeout(200);â€¨      â€¨      if (i % 5 === 0) {â€¨        console.log(`    å·²é€‰æ‹©${i}å¼ `);â€¨      }â€¨    }â€¨    â€¨    console.log(`  âœ… å·²é€‰æ‹©${actualCount}å¼ å›¾ç‰‡`);â€¨    â€¨    // 6.8 ç‚¹å‡»ç¡®å®šï¼ˆiframeå†…ï¼‰â€¨    await imageFrame.getByRole('button', { name: new RegExp(`ç¡®å®š\\(${actualCount}\\)`) }).click();â€¨    await page1.waitForTimeout(1500);â€¨    â€¨    console.log('  âœ… å›¾ç‰‡å·²æ·»åŠ åˆ°è¯¦æƒ…é¡µ');â€¨    â€¨    // ==================== ç¬¬ä¸ƒéƒ¨åˆ†ï¼šå…³é—­ç¼–è¾‘çª—å£ ====================â€¨    console.log('\n[Part 7] ä¿å­˜å¹¶å…³é—­ç¼–è¾‘çª—å£');â€¨    â€¨    // ç‚¹å‡»ä¸»é¡µé¢çš„ç¡®å®šæŒ‰é’®â€¨    await page1.getByRole('button', { name: 'ç¡®å®š' }).click();â€¨    await page1.waitForTimeout(1000);â€¨    â€¨    console.log('  âœ… ç¼–è¾‘çª—å£å·²å…³é—­');â€¨    â€¨    console.log('\n========== å•†å“è¯¦æƒ…é¡µå¡«å†™å®Œæˆ ==========\n');â€¨    â€¨  } catch (error) {â€¨    console.error(`âŒ è¯¦æƒ…é¡µå¡«å†™å¤±è´¥: ${error}`);â€¨    throw error;â€¨  }â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹1ï¼šå¡«å†™å•†å“è¯¦æƒ…é¡µâ€¨ */â€¨async function example1(page1: Page) {â€¨  const productData = {â€¨    productId: 'C25217200',â€¨    detailText: `ã€äº§å“ç‰¹ç‚¹ã€‘â€¨- é«˜å°”å¤«ä¸“ä¸šè®¾è®¡â€¨- é€Ÿå¹²é€æ°”é¢æ–™â€¨- å››å‘å¼¹åŠ›èˆ’é€‚â€¨- UPF50+é˜²æ™’â€¨â€¨ã€å°ºç è¯´æ˜ã€‘â€¨S=å°å· M=ä¸­å· L=å¤§å· XL=åŠ å¤§å·â€¨å»ºè®®æ ¹æ®å¹³æ—¶ç©¿ç€å°ºç é€‰æ‹©`â€¨  };â€¨  â€¨  await fillProductDetail(page1, productData);â€¨}â€¨â€¨/**â€¨ * ç¤ºä¾‹2ï¼šä»é£ä¹¦è·å–æ•°æ®â€¨ */â€¨async function example2(page1: Page) {â€¨  // ä»é£ä¹¦è·å–çš„æ•°æ®â€¨  const productFromFeishu = {â€¨    productId: 'C25217200',â€¨    detailText: 'è¿™é‡Œæ˜¯ä»é£ä¹¦"è¯¦æƒ…é¡µæ–‡å­—"å­—æ®µè·å–çš„å†…å®¹...'â€¨  };â€¨  â€¨  await fillProductDetail(page1, productFromFeishu);â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { fillProductDetail };â€¨ä½¿ç”¨æ–¹æ³•â€¨typescriptâ€¨import { test } from '@playwright/test';â€¨import { fillProductDetail } from './fill-product-detail';â€¨â€¨test('å¡«å†™å•†å“è¯¦æƒ…é¡µ', async ({ page }) => {â€¨  // ... å‰é¢çš„æ“ä½œ ...â€¨  â€¨  // ä»é£ä¹¦è·å–æ•°æ®â€¨  const productData = {â€¨    productId: 'C25217200',â€¨    detailText: 'ä»é£ä¹¦è·å–çš„è¯¦æƒ…é¡µæ–‡å­—å†…å®¹...'â€¨  };â€¨  â€¨  // å¡«å†™è¯¦æƒ…é¡µâ€¨  await fillProductDetail(page, productData);â€¨  â€¨  // ... åç»­æ“ä½œ ...â€¨});â€¨æ ¸å¿ƒæµç¨‹è¯´æ˜â€¨1. åˆ é™¤æ—§æ¨¡æ¿â€¨typescriptâ€¨hoveræ¨¡æ¿ä½ç½® â†’ ç‚¹å‡»åˆ é™¤æŒ‰é’®â€¨2. æ·»åŠ æ–°æ¨¡æ¿â€¨typescriptâ€¨hoveræ¨¡æ¿èœå• â†’ ç‚¹å‡»"å¡-LL="æ¨¡æ¿â€¨3. ç¼–è¾‘å†…å®¹â€¨typescriptâ€¨ç‚¹å‡»æ¨¡æ¿æ‰“å¼€ç¼–è¾‘çª—å£ â†’ å®šä½æ®µè½ â†’ Endé”®åˆ°æœ€å³è¾¹ â†’ å›è½¦ â†’ è¾“å…¥æ–‡å­—â€¨4. æ·»åŠ å›¾ç‰‡ï¼ˆè‡ªåŠ¨åˆ¤æ–­æ•°é‡ï¼‰â€¨typescriptâ€¨æ£€æŸ¥å›¾ç‰‡æ•°é‡ â†’ æœ€å¤šé€‰22å¼  â†’ å¾ªç¯ç‚¹å‡» â†’ ç¡®å®šâ€¨5. å…³é—­çª—å£â€¨typescriptâ€¨iframeå†…ç¡®å®š â†’ ä¸»é¡µé¢ç¡®å®šâ€¨```â€¨â€¨## æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹â€¨```â€¨========== å¡«å†™å•†å“è¯¦æƒ…é¡µ ==========â€¨å•†å“ID: C25217200â€¨è¯¦æƒ…æ–‡å­—é•¿åº¦: 156å­—â€¨â€¨[Part 1] åˆ é™¤æ—§æ¨¡æ¿å†…å®¹â€¨  âœ… æ—§æ¨¡æ¿å·²åˆ é™¤â€¨â€¨[Part 2] æ·»åŠ æ–°æ¨¡æ¿â€¨  âœ… æ–°æ¨¡æ¿å·²æ·»åŠ â€¨â€¨[Part 3] æ‰“å¼€æ¨¡æ¿ç¼–è¾‘çª—å£â€¨  âœ… ç¼–è¾‘çª—å£å·²æ‰“å¼€â€¨â€¨[Part 4] å®šä½å…‰æ ‡ä½ç½®â€¨  å°è¯•ä½¿ç”¨Endé”®ç§»åŠ¨åˆ°æœ€å³è¾¹â€¨  âœ… å…‰æ ‡å·²å°±ä½â€¨â€¨[Part 5] å¡«å…¥è¯¦æƒ…é¡µæ–‡å­—â€¨  âœ… å·²è¾“å…¥156å­—â€¨â€¨[Part 6] æ·»åŠ å›¾ç‰‡â€¨  è¾“å…¥å•†å“ID: C25217200â€¨  è®¾ç½®æ–‡ä»¶åå‡åºâ€¨  æ£€æµ‹åˆ°28å¼ å›¾ç‰‡ï¼Œå°†é€‰æ‹©å‰22å¼ â€¨    å·²é€‰æ‹©5å¼ â€¨    å·²é€‰æ‹©10å¼ â€¨    å·²é€‰æ‹©15å¼ â€¨    å·²é€‰æ‹©20å¼ â€¨  âœ… å·²é€‰æ‹©22å¼ å›¾ç‰‡â€¨  âœ… å›¾ç‰‡å·²æ·»åŠ åˆ°è¯¦æƒ…é¡µâ€¨â€¨[Part 7] ä¿å­˜å¹¶å…³é—­ç¼–è¾‘çª—å£â€¨  âœ… ç¼–è¾‘çª—å£å·²å…³é—­â€¨â€¨========== å•†å“è¯¦æƒ…é¡µå¡«å†™å®Œæˆ ==========â€¨å…³é”®ç‰¹æ€§â€¨âœ… è‡ªåŠ¨åˆ é™¤æ—§æ¨¡æ¿â€¨ âœ… æ·»åŠ å›ºå®šæ¨¡æ¿"å¡-LL="â€¨ âœ… Endé”®å®šä½ï¼ˆå¸¦å¤‡ç”¨æ–¹æ¡ˆï¼‰â€¨ âœ… é€å­—è¾“å…¥è¯¦æƒ…æ–‡å­—â€¨ âœ… è‡ªåŠ¨æ£€æµ‹å›¾ç‰‡æ•°é‡ï¼ˆæœ€å¤š22å¼ ï¼‰â€¨ âœ… ä¸¤æ¬¡ç¡®å®šå…³é—­çª—å£
13ã€æœ€åä¸€æ­¥
Pythonâ€¨typescriptâ€¨import { Page } from '@playwright/test';â€¨â€¨/**â€¨ * æäº¤å•†å“å¹¶è¿”å›ç®¡ç†é¡µé¢â€¨ * @param page1 - Playwrighté¡µé¢å¯¹è±¡ï¼ˆå‘å¸ƒå•†å“çš„é¡µé¢ï¼‰â€¨ */â€¨async function submitProductAndReturn(page1: Page): Promise<void> {â€¨  â€¨  console.log('\n========== æäº¤å•†å“ ==========');â€¨  â€¨  try {â€¨    // ==================== ç¬¬ä¸€éƒ¨åˆ†ï¼šæ”¾å…¥ä»“åº“ ====================â€¨    console.log('\n[æ­¥éª¤1] é€‰æ‹©æ”¾å…¥ä»“åº“');â€¨    â€¨    await page1.getByRole('radio', { name: 'æ”¾å…¥ä»“åº“' }).check();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log('  âœ… å·²é€‰æ‹©æ”¾å…¥ä»“åº“');â€¨    â€¨    // ==================== ç¬¬äºŒéƒ¨åˆ†ï¼šå¯ç”¨é¢„æ£€ ====================â€¨    console.log('\n[æ­¥éª¤2] å¯ç”¨é¢„æ£€');â€¨    â€¨    await page1.locator('#sell-field-ysbCheckTask label').filter({ hasText: 'å¯ç”¨' }).click();â€¨    await page1.waitForTimeout(500);â€¨    â€¨    console.log('  âœ… é¢„æ£€å·²å¯ç”¨');â€¨    â€¨    // ==================== ç¬¬ä¸‰éƒ¨åˆ†ï¼šåˆ é™¤å¤šä½™æ ‡ç­¾ï¼ˆå¦‚æœæœ‰ï¼‰ ====================â€¨    console.log('\n[æ­¥éª¤3] æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ é™¤æ ‡ç­¾');â€¨    â€¨    try {â€¨      const deleteBtn = page1.getByRole('button', { name: 'ç”·å£« ç¾½ç»’æœ/æ£‰æœ åˆ é™¤' }).getByLabel('åˆ é™¤');â€¨      const isVisible = await deleteBtn.isVisible({ timeout: 2000 });â€¨      â€¨      if (isVisible) {â€¨        await deleteBtn.click();â€¨        await page1.waitForTimeout(500);â€¨        console.log('  âœ… å·²åˆ é™¤æ ‡ç­¾');â€¨      } else {â€¨        console.log('  â­ï¸  æ— éœ€åˆ é™¤æ ‡ç­¾');â€¨      }â€¨    } catch (e) {â€¨      console.log('  â­ï¸  æœªæ‰¾åˆ°åˆ é™¤æŒ‰é’®ï¼Œè·³è¿‡');â€¨    }â€¨    â€¨    // ==================== ç¬¬å››éƒ¨åˆ†ï¼šæäº¤å•†å“ ====================â€¨    console.log('\n[æ­¥éª¤4] æäº¤å•†å“ä¿¡æ¯');â€¨    â€¨    await page1.getByRole('button', { name: 'æäº¤å®è´ä¿¡æ¯' }).click();â€¨    await page1.waitForTimeout(2000);â€¨    â€¨    console.log('  âœ… å·²ç‚¹å‡»æäº¤æŒ‰é’®');â€¨    â€¨    // ==================== ç¬¬äº”éƒ¨åˆ†ï¼šç­‰å¾…è·³è½¬å¹¶æ£€æŸ¥ç»“æœ ====================â€¨    console.log('\n[æ­¥éª¤5] ç­‰å¾…æäº¤ç»“æœ');â€¨    â€¨    // ç­‰å¾…é¡µé¢è·³è½¬ï¼ˆåœ¨å½“å‰æ ‡ç­¾é¡µï¼‰â€¨    await page1.waitForLoadState('networkidle', { timeout: 30000 });â€¨    await page1.waitForTimeout(2000);â€¨    â€¨    // æ£€æŸ¥æ˜¯å¦æäº¤æˆåŠŸâ€¨    try {â€¨      const successText = page1.getByText('å•†å“æäº¤æˆåŠŸ');â€¨      const isSuccess = await successText.isVisible({ timeout: 5000 });â€¨      â€¨      if (isSuccess) {â€¨        console.log('  âœ… å•†å“æäº¤æˆåŠŸï¼');â€¨        â€¨        // å…³é—­å½“å‰ç»“æœé¡µï¼ˆè¿”å›ä¸Šä¸€é¡µæˆ–å¯¼èˆªåˆ°ç®¡ç†é¡µï¼‰â€¨        console.log('\n[æ­¥éª¤6] å…³é—­ç»“æœé¡µ');â€¨        await page1.goBack();â€¨        await page1.waitForTimeout(1000);â€¨      } else {â€¨        console.log('  âš ï¸  æœªæ£€æµ‹åˆ°æˆåŠŸæç¤º');â€¨      }â€¨    } catch (e) {â€¨      console.log('  âš ï¸  æœªæ£€æµ‹åˆ°æˆåŠŸæç¤ºï¼Œç»§ç»­æ‰§è¡Œ');â€¨    }â€¨    â€¨    // ==================== ç¬¬å…­éƒ¨åˆ†ï¼šç¡®ä¿å›åˆ°ç®¡ç†é¡µé¢ ====================â€¨    console.log('\n[æ­¥éª¤7] ç¡®ä¿å›åˆ°å•†å“ç®¡ç†é¡µé¢');â€¨    â€¨    const targetUrl = 'https://myseller.taobao.com/home.htm/SellManage/all?current=1&pageSize=20';â€¨    const currentUrl = page1.url();â€¨    â€¨    if (!currentUrl.includes('myseller.taobao.com/home.htm/SellManage')) {â€¨      console.log('  å½“å‰ä¸åœ¨ç®¡ç†é¡µé¢ï¼Œæ­£åœ¨å¯¼èˆª...');â€¨      await page1.goto(targetUrl);â€¨      await page1.waitForLoadState('networkidle');â€¨      await page1.waitForTimeout(1500);â€¨      console.log('  âœ… å·²å¯¼èˆªåˆ°ç®¡ç†é¡µé¢');â€¨    } else {â€¨      console.log('  âœ… å·²åœ¨ç®¡ç†é¡µé¢');â€¨    }â€¨    â€¨    console.log('\n========== å•†å“æäº¤å®Œæˆ ==========\n');â€¨    â€¨  } catch (error) {â€¨    console.error(`âŒ æäº¤å¤±è´¥: ${error}`);â€¨    throw error;â€¨  }â€¨}â€¨â€¨// ==================== ä½¿ç”¨ç¤ºä¾‹ ====================â€¨â€¨/**â€¨ * ç¤ºä¾‹ï¼šå®Œæ•´çš„å•†å“å‘å¸ƒæµç¨‹â€¨ */â€¨async function completePublishFlow(page: Page, page1: Page) {â€¨  // ... å‰é¢å¡«å†™äº†æ ‡é¢˜ã€åˆ†ç±»ã€å“ç‰Œã€é¢œè‰²ã€å°ºç ç­‰ ...â€¨  â€¨  // æœ€åæäº¤å•†å“â€¨  await submitProductAndReturn(page1);â€¨  â€¨  // æ­¤æ—¶åº”è¯¥å›åˆ°äº†å•†å“ç®¡ç†é¡µé¢â€¨  console.log('å¯ä»¥ç»§ç»­å‘å¸ƒä¸‹ä¸€ä¸ªå•†å“äº†');â€¨}â€¨â€¨// ==================== å¯¼å‡º ====================â€¨export { submitProductAndReturn };â€¨ä½¿ç”¨æ–¹æ³•â€¨typescriptâ€¨import { test } from '@playwright/test';â€¨import { submitProductAndReturn } from './submit-product';â€¨â€¨test('æäº¤å•†å“', async ({ page }) => {â€¨  // ... å‰é¢çš„æ‰€æœ‰å¡«å†™æ“ä½œ ...â€¨  â€¨  // æœ€åæäº¤â€¨  await submitProductAndReturn(page);â€¨  â€¨  // ç°åœ¨åœ¨å•†å“ç®¡ç†é¡µé¢ï¼Œå¯ä»¥ç»§ç»­ä¸‹ä¸€ä¸ªå•†å“â€¨});â€¨```â€¨â€¨## æ“ä½œæµç¨‹è¯´æ˜â€¨â€¨| æ­¥éª¤ | æ“ä½œ | å…ƒç´ å®šä½ | è¯´æ˜ |â€¨|-----|------|---------|------|â€¨| 1 | é€‰æ‹©æ”¾å…¥ä»“åº“ | `getByRole('radio', { name: 'æ”¾å…¥ä»“åº“' })` | å•é€‰æŒ‰é’® |â€¨| 2 | å¯ç”¨é¢„æ£€ | `#sell-field-ysbCheckTask label` + filter | ç‚¹å‡»å¯ç”¨æ ‡ç­¾ |â€¨| 3 | åˆ é™¤æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰ | `getByRole('button', { name: 'ç”·å£« ç¾½ç»’æœ/æ£‰æœ åˆ é™¤' })` | æœ‰å°±åˆ ï¼Œæ²¡æœ‰è·³è¿‡ |â€¨| 4 | æäº¤å•†å“ | `getByRole('button', { name: 'æäº¤å®è´ä¿¡æ¯' })` | ç‚¹å‡»æäº¤ |â€¨| 5 | ç­‰å¾…ç»“æœ | `getByText('å•†å“æäº¤æˆåŠŸ')` | æ£€æŸ¥æ˜¯å¦æˆåŠŸ |â€¨| 6 | å…³é—­ç»“æœé¡µ | `page1.goBack()` | è¿”å›ä¸Šä¸€é¡µ |â€¨| 7 | å›åˆ°ç®¡ç†é¡µ | æ£€æŸ¥URLå¹¶å¯¼èˆª | ç¡®ä¿åœ¨ç®¡ç†é¡µé¢ |â€¨â€¨## æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹â€¨```â€¨========== æäº¤å•†å“ ==========â€¨â€¨[æ­¥éª¤1] é€‰æ‹©æ”¾å…¥ä»“åº“â€¨  âœ… å·²é€‰æ‹©æ”¾å…¥ä»“åº“â€¨â€¨[æ­¥éª¤2] å¯ç”¨é¢„æ£€â€¨  âœ… é¢„æ£€å·²å¯ç”¨â€¨â€¨[æ­¥éª¤3] æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ é™¤æ ‡ç­¾â€¨  âœ… å·²åˆ é™¤æ ‡ç­¾â€¨â€¨[æ­¥éª¤4] æäº¤å•†å“ä¿¡æ¯â€¨  âœ… å·²ç‚¹å‡»æäº¤æŒ‰é’®â€¨â€¨[æ­¥éª¤5] ç­‰å¾…æäº¤ç»“æœâ€¨  âœ… å•†å“æäº¤æˆåŠŸï¼â€¨â€¨[æ­¥éª¤6] å…³é—­ç»“æœé¡µâ€¨â€¨[æ­¥éª¤7] ç¡®ä¿å›åˆ°å•†å“ç®¡ç†é¡µé¢â€¨  âœ… å·²åœ¨ç®¡ç†é¡µé¢â€¨â€¨========== å•†å“æäº¤å®Œæˆ ==========â€¨å…³é”®ç‰¹æ€§â€¨âœ… è‡ªåŠ¨åˆ¤æ–­åˆ é™¤æŒ‰é’®æ˜¯å¦å­˜åœ¨â€¨ âœ… ç­‰å¾…æäº¤ç»“æœï¼ˆæœ€å¤š30ç§’ï¼‰â€¨ âœ… æ£€æŸ¥æ˜¯å¦æ˜¾ç¤º"å•†å“æäº¤æˆåŠŸ"â€¨ âœ… è‡ªåŠ¨è¿”å›ä¸Šä¸€é¡µâ€¨ âœ… ç¡®ä¿æœ€ç»ˆåœ¨ç®¡ç†é¡µé¢â€¨ âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†â€¨å®Œæ•´æ¸…æ™°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼
